window.ASC.Files.Share=(function(){var k=false;var o;var p;var A=[];var l;var m;var B=null;var z;var C={r:"",rw:""};var b=null;var j=function(){if(k===false){k=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetSharedInfo,q);serviceManager.bind(ASC.Files.TemplateManager.events.SetAceObject,t);serviceManager.bind(ASC.Files.TemplateManager.events.UnSubscribeMe,u);serviceManager.bind(ASC.Files.TemplateManager.events.GetShortenLink,r);serviceManager.bind(ASC.Files.TemplateManager.events.MarkAsRead,s);B=new SharingSettingsManager(undefined,null);B.OnSave=y}};var e=function(H){if(H=="owner"){return ASC.Files.FilesJSResources.AceStatusEnum_Owner}H=parseInt(H);switch(H){case ASC.Files.Constants.AceStatusEnum.Read:return ASC.Files.FilesJSResources.AceStatusEnum_Read;case ASC.Files.Constants.AceStatusEnum.ReadWrite:return ASC.Files.FilesJSResources.AceStatusEnum_ReadWrite;case ASC.Files.Constants.AceStatusEnum.Restrict:return ASC.Files.FilesJSResources.AceStatusEnum_Restrict;default:return""}};var G=function(){if(ASC.Files.Share.clip){ASC.Files.Share.clip.destroy()}if(jq("#shareLink_copy:visible").length==0){return}var H=jq("#shareLink").val();ASC.Files.Share.clip=new ZeroClipboard.Client();ASC.Files.Share.clip.setText(H);ASC.Files.Share.clip.glue("shareLink_copy","shareLink_copy",{zIndex:670,left:jq("#shareLink_copy").offset().left-jq("#studio_sharingSettingsDialog").offset().left+"px",top:jq("#shareLink_copy").offset().top-jq("#studio_sharingSettingsDialog").offset().top+"px"});ASC.Files.Share.clip.addEventListener("onComplete",function(I,J){jq("#shareLink, #shareLink_copy").yellowFade()})};var h=function(){jq("#shareLink, #getShortenLink").hide();jq("#studio_sharingSettingsDialog").removeClass("showLink");if(jq.browser.mobile){return}jq("#switchDisplayLink").unbind("click").click(D).text(ASC.Files.FilesJSResources.ShowShareLink)};var D=function(){jq("#shareLink").show();jq("#getShortenLink").hide();var H=parseInt(jq("#shareLinkSelect").val());switch(H){case ASC.Files.Constants.AceStatusEnum.Read:if(C.r==""){jq("#getShortenLink").show()}break;case ASC.Files.Constants.AceStatusEnum.ReadWrite:if(C.rw==""){jq("#getShortenLink").show()}break}jq("#studio_sharingSettingsDialog").addClass("showLink");if(jq.browser.mobile){return}jq("#switchDisplayLink").unbind("click").click(h).text(ASC.Files.FilesJSResources.HideShareLink)};var i=function(){jq("#shareRemoveMessage, #shareMessage").hide();jq("#shareAddMessage").show()};var E=function(){jq("#shareAddMessage").hide();jq("#shareRemoveMessage, #shareMessage").show();jq("#shareMessageSend").attr("checked","checked")};var a=function(){var I=ASC.Files.UI.parseItemId(o).entryId;var J=ASC.Files.Common.getSitePath()+ASC.Files.Utility.GetFileViewUrl(I)+"&"+encodeURI(z);if(ASC.Files.Utility.CanWebView(p)){J=ASC.Files.Common.getSitePath()+ASC.Files.Constants.ShareLinkRead+"?"+encodeURI(z)}var H=parseInt(jq("#shareLinkSelect").val());switch(H){case ASC.Files.Constants.AceStatusEnum.Restrict:J="";h();jq("#shareLinkPanel").hide();break;case ASC.Files.Constants.AceStatusEnum.Read:if(C.r!=""){J=C.r}if(jq("#shareLink:visible").length!=0||jq.browser.mobile){D()}jq("#shareLinkPanel").show();break;case ASC.Files.Constants.AceStatusEnum.ReadWrite:if(ASC.Files.Utility.CanWebEdit(p,true)){J=ASC.Files.Common.getSitePath()+ASC.Files.Constants.ShareLinkReadWrite+"?"+encodeURI(z)}if(C.rw!=""){J=C.rw}if(jq("#shareLink:visible").length!=0||jq.browser.mobile){D()}jq("#shareLinkPanel").show();break}jq("#shareLink").val(J);G();m=H};var d=function(J,I){J=parseInt(J)||0;var H=ASC.Files.FilesJSResources.NewInShare.format(J);jq("#files_breadCrumbsNew").text("").hide();jq(".new_inshare[data-id='"+I+"']").text("").hide();jq("#topNavigationNewInShare").text("").hide();if(J>0){jq("#files_breadCrumbsNew").text(H).show();jq(".new_inshare[data-id='"+I+"']").text(H).show();jq("#topNavigationNewInShare").text(J).show()}};var v=function(J,I){var K=ASC.Files.UI.getEntryObject(J,I).find("div.is_new");if(K.length==0){return}K.remove();var L=jq(".new_inshare[data-id='"+ASC.Files.Folders.currentFolderId+"']");var H=parseInt(L.text().replace(/\D/g,""))-1;if(H!=NaN){ASC.Files.Share.displayCountNew(H,ASC.Files.Folders.currentFolderId)}};var w=function(H){jq("#studio_sharingSettingsDialog").addClass("withLink");if(jq("#studio_sharingSettingsDialog #shareLinkItem").length==0){jq("#shareLinkItem").prependTo("#studio_sharingSettingsDialog .containerBodyBlock");if(jq.browser.mobile){jq("#shareLink_copy, #switchDisplayLink").remove();jq("#shareLink").attr("readonly","false").attr("readonly","").removeAttr("readonly")}else{jq("#shareLinkPanel").on("mousedown","#shareLink",function(){jq(this).select();return false})}jq("#shareLinkPanel").on("keypress","#shareLink",function(){return false});jq("#shareLinkPanel").on("click","#getShortenLink",g);jq("#sharingSettingsItems").on("scroll",G)}jq("#shareLinkItem .sharingItem").remove();jq("#shareLinkPanel").before(jq("#sharingListTemplate").tmpl(H));if(!jq.browser.mobile){h();G()}var I=jq("#sharing_item_"+ASC.Files.Constants.ShareLinkId);I.removeClass("tintMedium borderBase");I.find("select").attr("id","shareLinkSelect").bind("change",a);jq("#shareLinkSelect").tlcombobox();if(!ASC.Files.Utility.CanWebEdit(p,true)){I.find("select option[value='"+ASC.Files.Constants.AceStatusEnum.ReadWrite+"']").remove();I.find("ul li[data-value='"+ASC.Files.Constants.AceStatusEnum.ReadWrite+"']").remove()}C={r:"",rw:""};a()};var x=function(){if(jq("#studio_sharingSettingsDialog #shareMessagePanel").length==0){jq("#shareMessagePanel").insertAfter("#studio_sharingSettingsDialog .addToSharingLinks");jq("#shareAddMessage").click(function(){E();return false});jq("#shareRemoveMessage").click(function(){i();return false});jq("#shareMessageSend").bind("change",function(){if(!jq("#shareMessageSend").is(":checked")){i()}})}i()};var F=function(J,H){if(ASC.Files.Folders.folderContainer!="forme"){return}var K=new Array();var N="";var M="";var L="<label title='{0}'><input type='checkbox' entryType='{1}' entryId='{2}' checked='checked'>{0}</label>";if(J&&H){K.push({entryType:J,entryId:H});var I=ASC.Files.UI.getEntryTitle(J,H);if(J=="file"){M+=L.format(I,J,H)}else{N+=L.format(I,J,H)}}else{jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):has(div.checkbox input:checked)").each(function(){var O=ASC.Files.UI.getObjectData(this);var R=O.entryType;var P=O.entryId;K.push({entryType:R,entryId:P});var Q=O.title;if(R=="file"){M+=L.format(Q,R,P)}else{N+=L.format(Q,R,P)}})}if(K.length==0){return}jq("#confirmUnsubscribeList dd.confirmRemoveFiles").html(M);jq("#confirmUnsubscribeList dd.confirmRemoveFolders").html(N);jq("#confirmUnsubscribeList .confirmRemoveFolders, #confirmUnsubscribeList .confirmRemoveFiles").show();if(N==""){jq("#confirmUnsubscribeList .confirmRemoveFolders").hide()}if(M==""){jq("#confirmUnsubscribeList .confirmRemoveFiles").hide()}ASC.Files.Common.blockUI(jq("#files_confirm_unsubscribe"),420,0,-150);PopupKeyUpActionProvider.EnterAction='jq("#unsubscribeConfirmBtn").click();'};var f=function(I,H,J){if(ASC.Files.Folders){if(ASC.Files.Folders.folderContainer!="my"&&(ASC.Files.Folders.folderContainer!="corporate"||!ASC.Files.Constants.USER_ADMIN)){return}}o=I+"_"+H;p=J;serviceManager.request("get","json",ASC.Files.TemplateManager.events.GetSharedInfo,{showLoading:true},"sharedinfo?objectId="+encodeURIComponent(o))};var y=function(J){var M=J.items;var H="";for(var O=0;O<M.length;O++){var K=M[O];var I=true;for(var P=0;P<A.length&&I;P++){var L=A[P];if(L.id===K.id){if(L.selectedAction.id==K.selectedAction.id){I=false}else{break}}}if(I){var Q={id:K.id,is_group:K.isGroup,ace_status:K.selectedAction.id};H+=serviceManager.jsonToXml({entry:Q})}}for(var P=0;P<A.length;P++){var L=A[P];var I=true;for(var O=0;O<M.length;O++){var K=M[O];if(L.id===K.id){I=false;break}}if(I){var Q={id:L.id,is_group:L.isGroup,ace_status:ASC.Files.Constants.AceStatusEnum.None};H+=serviceManager.jsonToXml({entry:Q})}}if(l!=m){var Q={id:ASC.Files.Constants.ShareLinkId,is_group:true,ace_status:m};H+=serviceManager.jsonToXml({entry:Q})}if(H==""){return}var N=serviceManager.jsonToXml({ace_wrapperList:H});var S=jq("#shareMessageSend").is(":checked")==true;var R=S?jq("#shareMessage:visible").val()||"":"";serviceManager.request("post","json",ASC.Files.TemplateManager.events.SetAceObject,{showLoading:true},N,"setaceobject?objectId="+encodeURIComponent(o)+"&notify="+S+"&message="+encodeURIComponent(R.trim()));if(ASC.Files.UI.documentTitleFix){ASC.Files.UI.documentTitleFix()}};var c=function(){if(jq("#files_confirm_unsubscribe:visible").length==0){return}PopupKeyUpActionProvider.CloseDialog();var N=jq("#confirmUnsubscribeList input:checked");if(N.length==0){return}var H={};H.entry=new Array();var M=new Array();for(var L=0;L<N.length;L++){var K=jq(N[L]).attr("entryType");var I=jq(N[L]).attr("entryId");var J=ASC.Files.UI.getEntryObject(K,I);ASC.Files.UI.blockObject(J,true,ASC.Files.FilesJSResources.DescriptRemove);H.entry.push(K+"_"+I);M.push({entryId:I,entryType:K})}serviceManager.request("post","json",ASC.Files.TemplateManager.events.UnSubscribeMe,{showLoading:true,list:M},{stringList:H},"removeace")};var g=function(){var H=ASC.Files.UI.parseItemId(o).entryId;var I=jq("#shareLink").val();serviceManager.request("get","json",ASC.Files.TemplateManager.events.GetShortenLink,{},"shorten?fileId="+encodeURIComponent(H)+"&longUrl="+encodeURIComponent(I)+"&"+z);jq("#getShortenLink").hide()};var n=function(J){var K;var H={};H.entry=new Array();if(typeof J=="undefined"){jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):has(div.checkbox input:checked)").each(function(){K=ASC.Files.UI.getObjectData(this);if(K.entryObject.find("div.is_new").length>0){H.entry.push(K.entryType+"_"+K.entryId)}})}else{var I=ASC.Files.Common.fixEvent(J);K=ASC.Files.UI.getObjectData(I.srcElement||I.target);H.entry.push(K.entryType+"_"+K.entryId)}if(H.entry.length==0){return false}serviceManager.request("post","json",ASC.Files.TemplateManager.events.MarkAsRead,{list:H.entry},{stringList:H},"markasread");return false};var q=function(K,N,J,I){if(typeof J!="undefined"||typeof K=="undefined"){ASC.Files.UI.displayInfoPanel(I||J,true);return undefined}A=K;var P=[];var M=[];l=ASC.Files.Constants.AceStatusEnum.None;jq(K).each(function(Q){var R=K[Q];if(R.id===ASC.Files.Constants.ShareLinkId){z=R.title;l=R.ace_status;M.push({id:R.id,name:ASC.Files.FilesJSResources.ShareLinkGroupTitle,isGroup:R.is_group,canEdit:!(R.locked||R.owner),selectedAction:{id:R.ace_status,name:e(R.owner?"owner":R.ace_status),defaultAction:false}})}else{P.push({id:R.id,name:R.title,isGroup:R.is_group,canEdit:!(R.locked||R.owner),selectedAction:{id:R.ace_status,name:e(R.owner?"owner":R.ace_status),defaultAction:false}})}});var H=[{id:ASC.Files.Constants.AceStatusEnum.Read,name:e(ASC.Files.Constants.AceStatusEnum.Read),defaultAction:true},{id:ASC.Files.Constants.AceStatusEnum.ReadWrite,name:e(ASC.Files.Constants.AceStatusEnum.ReadWrite),defaultAction:false},{id:ASC.Files.Constants.AceStatusEnum.Restrict,name:e(ASC.Files.Constants.AceStatusEnum.Restrict),defaultAction:false}];var O={actions:H,items:P};A=P;m=l;B.UpdateSharingData(O);B.ShowDialog();jq("body").css("overflow","");jq("#studio_sharingSettingsDialog").removeClass("withLink showLink");if(M.length!=0){var L={actions:H,items:M};w(L)}x()};var t=function(L,M,J,H){if(typeof J!="undefined"){ASC.Files.UI.displayInfoPanel(H||J,true);return undefined}var K=ASC.Files.UI.parseItemId(o);var I=ASC.Files.UI.getEntryObject(K.entryType,K.entryId);var N=I.find(".share_action");if(L===true){N.addClass("shareBlue")}else{N.removeClass("shareBlue")}o=null};var u=function(P,R,L,H){if(typeof L!="undefined"){ASC.Files.UI.displayInfoPanel(H||L,true);return undefined}var Q=R.list;var N=0;var K=0,J=0;for(var O=0;O<Q.length;O++){if(Q[O].entryType=="file"){J++}else{N++;var M=ASC.Files.UI.getEntryObject("folder",Q[O].entryId);K+=1+(parseInt(M.find(".countFolders").html())||0);J+=parseInt(M.find(".countFiles").html())||0}ASC.Files.UI.getEntryObject(Q[O].entryType,Q[O].entryId).remove()}if(N>0){ASC.Files.Tree.resetNode(ASC.Files.Folders.currentFolderId)}ASC.Files.UI.updateFolderInfo(-K,-J);ASC.Files.UI.paintRows();var I=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent div.checkbox input").length;if(I>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,I)}else{if(I>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.EmptyScreen.displayEmptyScreen()}}}ASC.Files.Share.displayCountNew(P,ASC.Files.Folders.currentFolderId)};var r=function(K,L,J,I){if(typeof J!="undefined"){ASC.Files.UI.displayInfoPanel(I||J,true);return undefined}if(K==null||K==""){return}jq("#shareLink").val(K);var H=parseInt(jq("#shareLinkSelect").val());switch(H){case ASC.Files.Constants.AceStatusEnum.Read:C.r=K;break;case ASC.Files.Constants.AceStatusEnum.ReadWrite:C.rw=K;break}G()};var s=function(O,P,K,H){if(typeof K!="undefined"){ASC.Files.UI.displayInfoPanel(H||K,true);return undefined}var N=P.list;for(var L=0;L<N.length;L++){var M=ASC.Files.UI.parseItemId(N[L]);var J=M.entryType;var I=M.entryId;ASC.Files.Share.removeNewIcon(J,I)}ASC.Files.Share.displayCountNew(O,ASC.Files.Folders.currentFolderId);ASC.Files.Actions.showActionsViewPanel()};return{init:j,displayCountNew:d,removeNewIcon:v,markAsRead:n,getSharedInfo:f,setAceObject:y,unSubscribeMe:F,confirmUnSubscribe:c,clip:b}})();(function(a){ASC.Files.Share.init();a(function(){jq("#files_unsubscribeButton, #files_mainUnsubscribe").click(function(){if(jq(this).is("#files_mainUnsubscribe")&&!jq(this).hasClass("unlockAction")){return}ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.unSubscribeMe()});jq("#files_mainMarkRead").click(function(){ASC.Files.Share.markAsRead()});jq("#unsubscribeConfirmBtn").click(function(){ASC.Files.Share.confirmUnSubscribe()});jq("#files_mainContent").on("click","div.is_new",ASC.Files.Share.markAsRead);jq("#files_mainContent").on("click","div.share_action",function(){var b=ASC.Files.UI.getObjectData(this);var c=b.entryId;var e=b.entryType;var d=b.title;ASC.Files.Share.getSharedInfo(e,c,d);return false})})})(jQuery);window.ASC.Files.EmptyScreen=(function(){var d=false;var c=function(){if(d===false){d=true}jq.dropdownToggle({switcherSelector:"#emptyContainer .hintCreate",dropdownID:"files_hintCreatePanel",fixWinSize:false});jq.dropdownToggle({switcherSelector:"#emptyContainer .hintUpload",dropdownID:"files_hintUploadPanel",fixWinSize:false});jq.dropdownToggle({switcherSelector:"#emptyContainer .hintOpen",dropdownID:"files_hintOpenPanel",fixWinSize:false});jq.dropdownToggle({switcherSelector:"#emptyContainer .hintEdit",dropdownID:"files_hintEditPanel",fixWinSize:false})};var a=function(){var e=ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem();jq("#files_mainContent, #switchViewFolder, #mainContentHeader, #files_pageNavigatorHolder").hide();jq("#emptyContainer>div").hide();var f=ASC.Files.Filter.getFilterSettings();if(f.filter!=0||f.text!=""){jq("#emptyContainer_filter").show()}else{jq("#files_filterContainer").hide();if(e===true){jq("#emptyContainer .emptyContainer_upload, #emptyContainer .emptyContainer_create").hide()}else{jq("#emptyContainer .emptyContainer_upload, #emptyContainer .emptyContainer_create").css("display","")}jq("#emptyContainer_"+ASC.Files.Folders.folderContainer).show()}jq("#emptyContainer").show();ASC.Files.UI.toggleMainMenu()};var b=function(){jq("#emptyContainer").hide();jq("#files_filterContainer").show();jq("#files_mainContent, #switchViewFolder, #mainContentHeader").show();ASC.Files.UI.toggleMainMenu()};return{init:c,hideEmptyScreen:b,displayEmptyScreen:a}})();(function(a){ASC.Files.EmptyScreen.init();a(function(){})})(jQuery);ASC.Files.ImageViewer=(function(){var m=false;var G=false;var a;var i;var w={};var u={};var k;var y=0;var v=0;var F=15;var D=0;var r;var J={};var h={};var c={};var d=function(){LoadingBanner.loaderCss="loading_container_wrapper";LoadingBanner.displayLoading()};var g=function(){LoadingBanner.loaderCss="";LoadingBanner.hideLoading(true)};var A=function(){LoadingBanner.hideLoading(true);d();ASC.Files.UI.finishMoveTo({},{});jq("body").addClass("scroll_fix");if(jq.browser.msie&&jQuery.browser.version<=7){jq("html").addClass("scroll_fix");jq("<style type='text/css'> .studioContentClassOverride{ position: static !important; } </style>").appendTo("head");jq("#studioContent").addClass("studioContentClassOverride")}jq(document).bind("mousewheel",t);jq(document).keydown(n);jq(window).bind("resize",z);jq.blockUI({message:null,css:{left:"50%",top:"50%",opacity:"1",border:"none",padding:"0px"},overlayCSS:{backgroundColor:"Black",cursor:"default",opacity:"0.5"},allowBodyStretch:false});jq("#imageViewerToolbox, #imageViewerClose").show();jq("div.blockUI.blockOverlay").click(function(){ASC.Files.ImageViewer.closeImageViewer();return false})};var C=function(){jq("#imageViewerInfo, #imageViewerToolbox, #imageViewerContainer, #imageViewerClose, #other_actions").hide();jq("body").removeClass("scroll_fix");if(jq.browser.msie&&jQuery.browser.version<=7){jq("html").removeClass("scroll_fix");jq("#studioContent").removeClass("studioContentClassOverride")}g();jq.unblockUI()};var f=function(N,L){var M=(N=="w")?"h":"w";var K;if(typeof L=="undefined"||L==null){K=u[M]*w[N]/w[M]}else{K=(/%/.test(L))?parseInt(L)/100*w[N]:parseInt(L)}u[N]=Math.round(K)};var H=function(O,K){var Q=(w.w>w.h)?["w","h"]:["h","w"];O[Q[0]]=O.ls;O[Q[1]]=null;var P=(O.w)?["w","h"]:(O.h)?["h","w"]:[];var M={w:u.w,h:u.h};f(P[0],O[P[0]]);f(P[1],O[P[1]]);G=true;if(typeof K=="undefined"||K==null){K=function(){G=false;jq("#imageViewerInfo").hide();y=v}}if(typeof O.speed=="undefined"||O.speed==null){O.speed=250}if(O.speed!=0){var N=1;var L=function(S){var R=(u[S]-M[S])/2;if(R<0){N=-1}if(R>0){return"-="+R+"px"}else{return"+="+(-R)+"px"}};k.animate({width:u.w+"px",height:u.h+"px",left:L("w"),top:L("h")},{duration:O.speed,easing:"linear",complete:K,step:function(R,S){jq("#imageViewerInfo span").text(Math.round(y+N*F*S.pos)+"%")}})}else{k.css({width:u.w+"px",height:u.h+"px"});K()}};var j=function(){g();k[0].style.cssText="";var M=jq('<img src="'+k.attr("src")+'" style="position:absolute; top:0; left:0; visibility:hidden" />').prependTo("body");w={w:M.width(),h:M.height()};if(w.w==0&&w.h==0){w.w=k.attr("naturalWidth")||k[0].naturalWidth;w.h=k.attr("naturalHeight")||k[0].naturalHeight}var L={w:w.w/h.w,h:w.h/h.h};var K=(L.w>L.h)?"w":"h";if(L[K]>1){v=Math.round(h[K]*100/w[K])}else{v=100}v=Math.max(v,F);if(a=="open"){u={w:10,h:10};k.css({display:"block",left:c.w-u.w/2,top:c.h-u.h/2});H({ls:v+"%"})}else{H({ls:v+"%",speed:0},function(){G=false;k.css({display:"block",left:c.w-u.w/2,top:c.h-u.h/2});y=v})}M.remove();B();if(ASC.Files.Share){ASC.Files.Share.removeNewIcon("file",i[i.selectedIndex].id)}};var B=function(){if(l()){var K="{0} ({1}x{2})".format(i[i.selectedIndex].title,w.w,w.h);jq("#imageViewerToolbox div.imageInfo").text(K).attr("title",K)}else{jq("#imageViewerToolbox div.imageInfo").html("&nbsp").removeAttr("title")}};var l=function(){return !jQuery.isEmptyObject(w)};var I=function(){w={};u={};D=0;jq("#imageViewerInfo, #imageViewerContainer").hide();d();var K=i[i.selectedIndex].id;var M=i[i.selectedIndex].vetsion;k[0].onload=j;k.removeAttr("src");k.attr("src",ASC.Files.Utility.GetFileViewUrl(K,M));var L=ASC.Files.UI.getEntryObject("file",K);if(ASC.Files.UI.accessAdmin(L)){jq("#other_actions .action_delete").show()}else{jq("#other_actions .action_delete").hide()}};var p=function(K){r={x:K.pageX-k.offset().left,y:K.pageY-k.offset().top};jq(document).unbind("mouseup");jq(document).unbind("mousemove");jq(document).mouseup(s);jq(document).mousemove(q);document.ondragstart=function(){return false};document.body.onselectstart=function(){return false};k[0].ondragstart=function(){return false};jq("#imageViewerToolbox, #other_actions").hide()};var q=function(K){var L=K.pageX,M=K.pageY;if(L<0||M<0||L>jq(window).width()||M+100>jq(window).height()){return}k.css({cursor:"pointer",left:L-r.x,top:M-r.y})};var s=function(){k.css("cursor","move");jq(document).unbind("mouseup");jq(document).unbind("mousemove");k[0].ondragstart=null;document.ondragstart=null;document.body.onselectstart=null;jq("#imageViewerToolbox").show()};var t=function(M){if(G){return}var K=0;var L=ASC.Files.Common.fixEvent(M).originalEvent;if(L.wheelDelta){K=L.wheelDelta/120}else{if(L.detail){K=-L.detail/3}}if(K>0){ASC.Files.ImageViewer.zoomIn()}else{if(K<0){ASC.Files.ImageViewer.zoomOut()}}return false};var o=function(){if(G){return}var K=J.w>J.h?J.w:J.h;H({ls:K+"px"})};var n=function(L){var M=L.keyCode||L.which;var K=ASC.Files.Common.keyCode;switch(M){case K.left:ASC.Files.ImageViewer.prevImage();return false;case K.spaceBar:case K.right:ASC.Files.ImageViewer.nextImage();return false;case K.up:ASC.Files.ImageViewer.zoomIn();return false;case K.down:ASC.Files.ImageViewer.zoomOut();return false;case K.esc:ASC.Files.ImageViewer.closeImageViewer();return false;case K.deleteKey:ASC.Files.ImageViewer.deleteImage();return false;case K.home:case K.end:case K.pageDown:case K.pageUP:return false}};var E=function(){if(!jq.browser.msie){var N="rotate({0}deg)".format(D);k.css({"-moz-transform":N,"-o-transform":N,"-webkit-transform":N,transform:N})}else{var M=(D*Math.PI)/180;var K='progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand", M11 = '+Math.cos(M)+", M12 = "+(-Math.sin(M))+", M21 = "+Math.sin(M)+", M22 = "+Math.cos(M)+")";var L=k.offset();k.css({"-ms-filter":K,filter:K});var O={left:-Math.round((k.width()-u.w)/2),top:-Math.round((k.height()-u.h)/2)};k.css({left:L.left+O.left,top:L.top+O.top});u.w=k.width();u.h=k.height()}};var b=function(){J={w:jq(window).width(),h:jq(window).height()};var K=J.w/2+jq(window).scrollLeft();var L=J.h/2+jq(window).scrollTop()-jq("#imageViewerToolbox").height()/2;c={w:K,h:L};h={w:J.w,h:J.h-jq("#imageViewerToolbox").height()}};var z=function(){b();jq("#imageViewerInfo").css({left:c.w,top:c.h});jq("#imageViewerClose").css({right:10,top:jq(window).scrollTop()+15});jq("#imageViewerToolbox").css({top:J.h+jq(window).scrollTop()-jq("#imageViewerToolbox").height(),left:"0px"})};var e=function(K){if(G){return}if(i.length==0||i.selectedIndex<0){ASC.Files.ImageViewer.closeImageViewer();return}if(!K){i.selectedIndex--;if(i.selectedIndex<0){i.selectedIndex=i.length-1}a="prevImage";var L=i[i.selectedIndex].id;ASC.Controls.AnchorController.safemove(ASC.Files.ImageViewer.getPreviewUrl(L))}else{i.selectedIndex++;if(i.selectedIndex>i.length-1){i.selectedIndex=0}a="nextImage";var L=i[i.selectedIndex].id;ASC.Controls.AnchorController.safemove(ASC.Files.ImageViewer.getPreviewUrl(L))}I()};var x=function(N,O,L,K){if((typeof L!="undefined")||typeof N=="undefined"||(N.length==0)){ASC.Files.UI.displayInfoPanel(K||L,true);ASC.Files.ImageViewer.closeImageViewer();return undefined}i=N;i.selectedIndex=i.length;for(var M=0;M<i.length;M++){var P=i[M].Value.split("#");i[M].id=i[M].Key;i[M].vetsion=P[0];i[M].title=P[1];if(i[M].id==O.fileId){i.selectedIndex=M}}if(i.selectedIndex>=i.length){ASC.Files.ImageViewer.closeImageViewer();return}I()};return{init:function(K){jq(document).unbind("mousedown");jq(document).unbind("mouseup");jq(document).unbind("mousemove");ASC.Files.UI.mouseBtn=false;if(m===false){m=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetSiblingsFile,x);k=jq("#imageViewerContainer");k.dblclick(o);k.mousedown(p);jq("#imageViewerToolbox ul li img").hover(function(){var N=jq(this);var O=N.attr("src");if(O.indexOf("_hover.png")!=-1){return}var M=O.replace(".png","_hover.png");N.attr("src",M);jq("#imageViewerToolbox div.imageInfo").text(N.attr("title"))},function(){var M=jq(this);var N=M.attr("src").replace("_hover.png",".png");M.attr("src",N);B()})}A();z();a="open";var L=ASC.Files.Filter.getFilterSettings();serviceManager.request("post","json",ASC.Files.TemplateManager.events.GetSiblingsFile,{fileId:K},{orderBy:L.sorter},"folders","files","siblings?fileID="+encodeURIComponent(K)+"&filter="+L.filter+"&subjectID="+L.subject+"&search="+encodeURIComponent(L.text))},getPreviewUrl:function(K){return"#preview/{0}".format(K)},closeImageViewer:function(){if(l()){H({ls:"10px",speed:500},C)}else{k[0].onload=null;k.removeAttr("src");C()}jq(window).unbind("resize");jq(document).unbind("mousewheel");jq(document).unbind("keydown");jq(document).unbind("mousedown");jq(document).unbind("mouseup");jq(document).unbind("mousemove");ASC.Files.UI.mouseBtn=false;ASC.Files.Actions.mouseBindDocument();ASC.Files.Folders.navigationSet(ASC.Files.Folders.currentFolderId,ASC.Files.Common.isCorrectId(ASC.Files.Folders.currentFolderId))},prevImage:function(){e(false)},nextImage:function(){e(true)},rotateLeft:function(){if(G){return}D-=90;E()},rotateRight:function(){if(G){return}D+=90;E()},fullScale:function(){if(G||v==100){return}v=100;jq("#imageViewerInfo span").text(v+"%");jq("#imageViewerInfo").show();H({ls:v+"%"})},zoomIn:function(){if(G){return}v+=F;v=Math.min(v,1000);jq("#imageViewerInfo span").text(v+"%");jq("#imageViewerInfo").show();H({ls:v+"%"})},zoomOut:function(){if(G){return}v-=F;v=Math.max(v,F);jq("#imageViewerInfo span").text(v+"%");jq("#imageViewerInfo").show();H({ls:v+"%"})},deleteImage:function(){if(G){return}var L=i[i.selectedIndex].id;var M=ASC.Files.UI.getEntryObject("file",L);if(!ASC.Files.UI.accessAdmin(M)){return}var K={};K.entry=new Array();ASC.Files.UI.blockObjectById("file",L,true,ASC.Files.FilesJSResources.DescriptRemove);K.entry.push("file_"+L);serviceManager.deleteItem(ASC.Files.TemplateManager.events.DeleteItem,{list:[L],doNow:true},{stringList:K});i.splice(i.selectedIndex,1);i.selectedIndex--;ASC.Files.ImageViewer.nextImage()},downloadImage:function(){if(G){return}var K=i[i.selectedIndex].id;var L=i[i.selectedIndex].vetsion;window.open(ASC.Files.Utility.GetFileViewUrl(K,L),"new","fullscreen = 1, resizable = 1, location=1, toolbar=1")}}})();(function(a){jq.dropdownToggle({switcherSelector:"#other_actions_switch",dropdownID:"other_actions"})})(jQuery);window.ASC.Files.Import=(function(){var g=false;var j=false;var k=false;var i=function(){if(k===false){k=true;serviceManager.bind(ASC.Files.TemplateManager.events.IsZohoAuthentificated,n);serviceManager.bind(ASC.Files.TemplateManager.events.GetImportData,l);serviceManager.bind(ASC.Files.TemplateManager.events.ExecImportData,ASC.Files.EventHandler.onGetTasksStatuses);jq(document).click(function(v){jq.dropdownToggle().registerAutoHide(v,"#topImport","#importListPanel")})}};var b=function(){if(ASC.Files.Import.importStatus){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoImprotNotFinish,true);return false}return true};var p=function(v){switch(v){case"boxnet":return ASC.Files.Import.importBoxnet;case"google":return ASC.Files.Import.importGoogle;case"zoho":return ASC.Files.Import.importZoho;default:return ASC.Files.Import.showImportPanel}};var e=function(){ASC.Files.Actions.hideAllActionPanels();if(b()){OAuthCallback=ASC.Files.Import.getImportData;OAuthPopup(ASC.Files.Constants.URL_OAUTH_BOXNET)}};var f=function(){ASC.Files.Actions.hideAllActionPanels();if(b()){OAuthCallback=ASC.Files.Import.getImportData;OAuthPopup(ASC.Files.Constants.URL_OAUTH_GOOGLE)}};var h=function(){ASC.Files.Actions.hideAllActionPanels();if(b()){t()}};var r=function(){ASC.Files.Actions.hideAllActionPanels();if(ASC.Files.Import.importStatus){ASC.Files.Common.blockUI(jq("#ImportDialog"),900,540)}else{jq.dropdownToggle().toggle("#topImport img","importListPanel")}};var q=function(w,v){jq("#files_importToFolder").text(v);jq("#files_importToFolderId").val(w);ASC.Files.Actions.hideAllActionPanels()};var t=function(){jq("#files_pass").val("");jq("#files_login, #files_pass").removeAttr("disabled");jq("#ImportLoginDialog .action-block").show();jq("#ImportLoginDialog .ajax-info-block").hide();jq("#ImportLoginDialog div[id$='InfoPanel']").hide();ASC.Files.Common.blockUI(jq("#ImportLoginDialog"),400,500);PopupKeyUpActionProvider.EnterAction='jq("#files_submitLoginDialog").click();';PopupKeyUpActionProvider.CloseDialogAction='jq("#files_pass").val("");';jq("#files_login").focus()};var u=function(){var w=jq("#files_login").val().trim();var x=jq("#files_pass").val().trim();var v=jq("#ImportLoginDialog div[id$='InfoPanel']").hide();if(w==""||x==""){v.show().find("div").text(ASC.Files.FilesJSResources.ErrorMassage_FieldsIsEmpty);return}jq("#files_pass").val("");jq("#files_login, #files_pass").attr("disabled","disabled");jq("#ImportLoginDialog .action-block").hide();jq("#ImportLoginDialog .ajax-info-block").show();ASC.Files.Import.getImportData("","zoho",w,x)};var c=function(z){var v=jq("#ImportDialog input[name='checked_document']:checked");var y=jq("#ImportDialog div[id$='InfoPanel']");if(v.length==0){if(y.css("display")=="none"){y.removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0").show()}y.find("div").text(ASC.Files.FilesJSResources.EmptyListSelectedForImport);return}var w="<ArrayOfDataToImport>";Encoder.EncodeType="!entity";v.each(function(){var A=jq(this).closest("tr").find("td");w+="<DataToImport>";w+="<content_link>"+Encoder.htmlEncode(jq("<div/>").text(jq(this).val().trim()).html())+"</content_link>";w+="<title>"+Encoder.htmlEncode(jq(A[1]).text().trim())+"</title>";w+="</DataToImport>"});Encoder.EncodeType="entity";w+="</ArrayOfDataToImport>";z.tofolder=jq("#files_importToFolderId").val();z.ignoreCoincidenceFiles=jq("#ImportDialog input[name='file_conflict']:checked").val();var x=jq("#ImportDialog div.import_progress_panel");x.find(".studioFileUploaderProgressBar").width(0);x.find("span.percent").width(0);x.show();jq("#ImportDialog input:checkbox").attr("disabled","disabled");jq("#ImportDialog input[name='file_conflict']").attr("disabled","disabled");jq("#files_importToFolderBtn").css("visibility","hidden");jq("#ImportDialog .action-block").hide();jq("#ImportDialog .action-block-progress").show();y.hide();o(z,w)};var s=function(){ASC.Files.Import.isImport=true;ASC.Files.Tree.showTreePath();ASC.Files.Tree.showSelect(jq("#files_importToFolderId").val());ASC.Files.Actions.hideAllActionPanels();jq("#files_treeViewPanelSelector").addClass("without-third-party");jq.dropdownToggle().toggle("#files_importToFolderBtn","files_treeViewPanelSelector");jq("body").bind("click",ASC.Files.Tree.registerHideTree)};var a=function(x,w){ASC.Files.Import.importStatus=false;var v=jq("#files_importToFolderId").val();ASC.Files.Tree.resetNode(v);if(jq("#ImportDialog:visible").length!=0){PopupKeyUpActionProvider.CloseDialog();ASC.Files.Folders.navigationSet(v)}ASC.Files.UI.displayInfoPanel(x,w===true)};var d=function(A,z,w,y){var v={login:w,password:y,token:A};var x={source:z,showLoading:(z!="zoho"),authData:v};serviceManager.request("post","xml",(z!="zoho"?ASC.Files.TemplateManager.events.GetImportData:ASC.Files.TemplateManager.events.IsZohoAuthentificated),x,{AuthData:v},"import?source="+z)};var o=function(w,v){w.showLoading=true;serviceManager.request("post","json",ASC.Files.TemplateManager.events.ExecImportData,w,v,"import","exec?login="+(w.authData.login||"")+"&password="+(w.authData.password||"")+"&token="+(w.authData.token||"")+"&source="+w.source+"&tofolder="+w.tofolder+"&ignoreCoincidenceFiles="+w.ignoreCoincidenceFiles)};var n=function(z,y,w,v){var x=jq("#ImportLoginDialog div[id$='InfoPanel']").hide();jq("#files_pass").val("");if(typeof w!="undefined"){x.show().find("div").text(v||w);jq("#files_login, #files_pass").removeAttr("disabled");jq("#ImportLoginDialog .action-block").show();jq("#ImportLoginDialog .ajax-info-block").hide();return undefined}x.show().find("div").text(ASC.Files.FilesJSResources.ErrorMassage_AuthentificatedFalse);jq("#files_login, #files_pass").removeAttr("disabled");jq("#ImportLoginDialog .action-block").show();jq("#ImportLoginDialog .ajax-info-block").hide();l(z,y,w,v)};var l=function(D,A,w,v){PopupKeyUpActionProvider.CloseDialog();if(typeof w!="undefined"||D==null){ASC.Files.UI.displayInfoPanel(v||w,true);return undefined}if(D.getElementsByTagName("DataToImportList").length==0){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.EmptyDataToImport,true);return}var E=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getImportData);var x=ASC.Controls.XSLTManager.translate(D,E);jq("#import_data").html(x);jq("#files_startImportData").unbind("click").click(function(){ASC.Files.Import.execImportData(A);return false});var z=ASC.Files.Constants.FOLDER_ID_MY_FILES;var C=ASC.Files.Tree.getFolderTitle(z);if(ASC.Files.UI.accessibleItem()&&(!ASC.Files.ThirdParty||!ASC.Files.ThirdParty.isThirdParty())&&ASC.Files.Folders.currentFolderId!=ASC.Files.Constants.FOLDER_ID_TRASH){z=ASC.Files.Folders.currentFolderId;C="";for(var y=0;y<ASC.Files.Tree.pathParts.length;y++){if(y!=0){C+=" > "}C+=ASC.Files.Tree.pathParts[y].Value}}ASC.Files.Import.setFolderImportTo(z,C);var B;switch(A.source){case"boxnet":B=ASC.Files.FilesJSResources.ImportFromBoxNet;break;case"google":B=ASC.Files.FilesJSResources.ImportFromGoogle;break;case"zoho":B=ASC.Files.FilesJSResources.ImportFromZoho;break;default:PopupKeyUpActionProvider.CloseDialog()}jq("#ImportDialogHeader, #import_to_folderName").text(B);jq("#ImportDialog input:checkbox").removeAttr("disabled");jq("#ImportDialog input[name='file_conflict']").removeAttr("disabled");jq("#files_importToFolderBtn").css("visibility","visible");jq("#ImportDialog .action-block").show();jq("#ImportDialog .action-block-progress").hide();jq("#ImportDialog .import_progress_panel").hide();jq("#ImportDialog .studioFileUploaderProgressBar").width(0);jq("#ImportDialog span.percent").text("0");jq("#ImportDialog div[id$='InfoPanel']").hide();jq(".startHide","#ImportDialog").removeClass("startHide");PopupKeyUpActionProvider.EnterAction='jq("#files_startImportData").click();';ASC.Files.Common.blockUI(jq("#ImportDialog"),900,540)};var m=function(v,x){ASC.Files.Import.importStatus=true;try{var y=parseInt(v.progress)||0}catch(w){y=0}if(jq("#ImportDialogHeader").text().length==0){var z="";switch(v.source){case"boxnet":z=ASC.Files.FilesJSResources.ImportFromBoxNet;break;case"google":z=ASC.Files.FilesJSResources.ImportFromGoogle;break;case"zoho":z=ASC.Files.FilesJSResources.ImportFromZoho;break;default:PopupKeyUpActionProvider.CloseDialog()}jq("#ImportDialogHeader").text(z)}if(y>0){jq("#ImportDialog .studioFileUploaderProgressBar").css("width",y+"%");jq("#ImportDialog span.percent").text(y)}if(y==100){ASC.Files.Import.cancelImportData(v.error||(x===true?ASC.Files.FilesJSResources.InfoCancelImport:ASC.Files.FilesJSResources.InfoFinishImport),v.error!=null);return true}return false};return{init:i,selectEventBySource:p,importBoxnet:e,importGoogle:f,importZoho:h,showImportPanel:r,submitLoginDialog:u,getImportData:d,execImportData:c,cancelImportData:a,showImportToSelector:s,setFolderImportTo:q,isImport:j,importStatus:g,onGetImportStatus:m}})();(function(a){ASC.Files.Import.init();a(function(){jq("#ImportLoginDialog div[id$='InfoPanel']").removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0");jq("#files_important_btn, #topImport img").click(function(){ASC.Files.Import.showImportPanel()});jq("#import_from_boxnet").click(function(){ASC.Files.Import.importBoxnet();return false});jq("#import_from_google").click(function(){ASC.Files.Import.importGoogle();return false});jq("#import_from_zoho").click(function(){ASC.Files.Import.importZoho();return false});jq("#files_submitLoginDialog").click(function(){ASC.Files.Import.submitLoginDialog();return false});jq("#files_importToFolderBtn").click(function(){ASC.Files.Import.showImportToSelector();return false});jq("#files_import_minimize").click(function(){PopupKeyUpActionProvider.CloseDialog();return false});jq("#files_import_terminate").click(function(b){ASC.Files.Folders.terminateTasks(true);ASC.Files.Common.cancelBubble(b);return false});jq("#ImportDialog").on("click","input[name='all_checked_document']",function(){var b=jq(this).is(":checked");jq("#ImportDialog input[name='checked_document']").attr("checked",b)});jq("#ImportDialog").on("click","input[name='checked_document']",function(){jq("#ImportDialog input[name='all_checked_document']").attr("checked",jq("#ImportDialog input[name='checked_document']:not(:checked)").length==0)})})})(jQuery);window.ASC.Files.MainMenu=(function(){var b=false;var a=function(){if(b===false){b=true}jq.dropdownToggle({switcherSelector:"#files_newdoc_btn, #topNewFile img, #emptyContainer .emptyContainer_create",dropdownID:"files_newDocumentPanel",anchorSelector:"#topNewFile img"})};var c=function(){var d="";d+=ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.document)?"":"#files_create_document,";d+=ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.spreadsheet)?"":"#files_create_spreadsheet,";d+=ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.presentation)?"":"#files_create_presentation,";d+=ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.image)?"":"#files_create_image,";jq(d).hide()};return{init:a,updateCreateDocList:c}})();(function(a){ASC.Files.MainMenu.init();a(function(){ASC.Files.MainMenu.updateCreateDocList();if(!ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.document)){jq("#files_create_document").remove();jq("#emptyContainer .emptyContainer_create").remove()}if(!ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.spreadsheet)){jq("#files_create_spreadsheet").remove()}if(!ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.presentation)){jq("#files_create_presentation").remove()}if(!ASC.Files.Utility.CanWebEdit(ASC.Files.Constants.typeNewDoc.image)){jq("#files_create_image").remove()}if(jq("#files_newDocumentPanel ul li").length==0){jq("#files_newDocumentPanel").remove();jq("#topNewFile").closest("li").remove()}jq("#files_create_document, #files_create_spreadsheet, #files_create_presentation, #files_create_image").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.typeNewDoc=this.id.replace("files_create_","");ASC.Files.Folders.createNewDoc()})})})(jQuery);window.ASC.Files.Uploads=(function(){var isInit=false;var fileUploader=null;var totalCount=0;var init=function(){if(isInit===false){isInit=true}};var onUploadComplete=function(fileUploadResult){var result={Success:fileUploadResult.Success,Message:fileUploadResult.Message};if(result.Success){try{var file=eval("file="+fileUploadResult.Data);var stringXmlFile=serviceManager.jsonToXml({file:file});var params={fileId:file.id,show:false,isStringXml:true};var fileObj=ASC.Files.UI.getEntryObject("file",file.id);if(fileObj.length!=0){ASC.Files.EventHandler.onReplaceVersion(stringXmlFile,params)}else{ASC.Files.EventHandler.onGetFile(stringXmlFile,params)}}catch(e){}totalCount++}else{ASC.Files.UI.displayInfoPanel(result.Message,true);if(FileHtml5Uploader.EnableHtml5===false&&(ASC.Controls.FlashDetector.DetectFlashVer(8,0,0)===false||ASC.Controls.FileUploaderGlobalConfig.DisableFlash===true)){OnAllUploadComplete()}}};var OnProgress=function(data){jq("#uploads_message").text(ASC.Files.FilesJSResources.Uploading+" "+data.CurrentFile)};var OnAllUploadComplete=function(){jq("#files_uploadDialog .cancelButton").show();jq("#files_swf_button_container").hide();jq("#upload_finish").show();PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.EnterAction='jq("#files_okUpload").click();'};var showUploadedFiles=function(){var list=jq("#files_mainContent li.newFile");if(list.length>0){ASC.Files.EmptyScreen.hideEmptyScreen();list.removeClass("newFile").show().yellowFade();ASC.Files.UI.paintRows()}ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoUploadedSuccess.format(totalCount))};var showUploadPopup=function(){if(jq.browser.mobile||jq("#files_uploadDialog:visible").length!=0){return}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=showUploadPopup;ASC.Files.Folders.defaultFolderSet();return}jq("#files_upload_select").css("display","");jq("#files_swf_button_container").show();jq("#panelButtons").show();jq("#files_upload_btn_html5").show();jq("#files_uploadDlgPanelButtons").hide();jq("#upload_finish").hide();jq("#files_uploadDialog .cancelButton").show();jq("#uploadDialogContainerHeader").html('{0} "<span title="{1}">{1}</span>"'.format(ASC.Files.FilesJSResources.UploadFileTo,jq("#currentFolderTitle").val()));ASC.Files.Common.blockUI(jq("#files_uploadDialog"),600,600);ASC.Files.UI.documentTitleFix();PopupKeyUpActionProvider.EnableEsc=false;PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.UI.documentTitleFix();";PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';jq("#files_upload_fileList").html("");activateUploader("files_upload_fileList",ASC.Files.Folders.currentFolderId);jq("#asc_fileuploaderSWFContainer").removeAttr("style")};var activateUploader=function(pnlId,folderId){jq("object[id*='SWFUpload']").before('<span id="asc_fileuploaderSWFObj"></span>');totalCount=0;try{jq("object[id*='SWFUpload']").remove()}catch(e){}var btnId=jq("#files_upload_btn").attr("id")||jq("#files_swf_button_container a.files_upload_btn").attr("id");if(ASC.Files.DragDrop.isFileAPI()&&FileHtml5Uploader.EnableHtml5){jq("#files_swf_button_container").hide();jq("#files_upload_pnl").hide();btnId=jq(".files_upload_btn_html5","#files_uploadDialog").attr("id")}else{jq("#files_swf_button_container").show();jq("#files_upload_pnl").show()}if(typeof ASC!=="undefined"&&typeof ASC.Controls!=="undefined"&&typeof ASC.Controls.FileUploader!=="undefined"){fileUploader=FileHtml5Uploader.InitFileUploader({FileUploadHandler:"ASC.Web.Files.Classes.FilesUploader,ASC.Web.Files",FileSizeLimit:ASC.Files.Constants.MAX_UPLOAD_SIZE,AutoSubmit:false,ProgressTimeSpan:1000,UploadButtonID:btnId,TargetContainerID:pnlId,Data:{folderId:folderId},OnUploadComplete:onUploadComplete,OnAllUploadComplete:OnAllUploadComplete,OnProgress:OnProgress,AddFilesText:ASC.Files.FilesJSResources.ButtonAddFiles,SelectFilesText:ASC.Files.FilesJSResources.ButtonSelectFiles,DeleteLinkCSSClass:"files_deleteLinkCSSClass",LoadingImageCSSClass:"files_loadingCSSClass",CompleteCSSClass:"files_completeCSSClass",OverAllProcessBarCssClass:"files_overAllProcessBarCssClass",DragDropHolder:jq("#files_uploadDialog div.panelContent"),FilesHeaderCountHolder:jq("#files_uploadHeader"),OverAllProcessHolder:jq("#files_overallprocessHolder"),SubmitPanelAfterSelectHolder:jq("#files_uploadDlgPanelButtons"),OverallProgressText:ASC.Files.FilesJSResources.OverallProgress,FilesHeaderText:ASC.Files.FilesJSResources.UploadedOf,SelectFileText:ASC.Files.FilesJSResources.SelectFilesToUpload,DragDropText:ASC.Files.FilesJSResources.OrDragDrop,SelectedFilesText:ASC.Files.FilesJSResources.SelectedFiles})}jq("#"+btnId).unbind("mouseover")};var fileUploaderSubmit=function(){PopupKeyUpActionProvider.EnterAction="";totalCount=0;if(fileUploader!=null){if(jq("#files_upload_fileList").html()==""){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.EmptyListUpload,true);PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';return}jq("#uploads_message").text(ASC.Files.FilesJSResources.UploadProcess);jq("#panelButtons").hide();jq("#files_upload_btn_html5").hide();jq("#files_uploadDialog .cancelButton").hide();fileUploader.Submit()}};return{init:init,showUploadPopup:showUploadPopup,fileUploaderSubmit:fileUploaderSubmit,showUploadedFiles:showUploadedFiles}})();(function(a){ASC.Files.Uploads.init();a(function(){jq("#files_uploadSubmit").click(function(){ASC.Files.Uploads.fileUploaderSubmit()});jq("#topUpload a").click(function(){ASC.Files.Uploads.showUploadPopup()});jq("#emptyContainer .emptyContainer_upload").click(function(){ASC.Files.Uploads.showUploadPopup();return false});jq("#files_okUpload").click(function(){ASC.Files.Uploads.showUploadedFiles();PopupKeyUpActionProvider.CloseDialog()})})})(jQuery);window.ASC.Files.ThirdParty=(function(){var d=false;var q={BoxNet:{key:"BoxNet",customerTitle:"BoxNet",typeTitle:"BoxNet"},DropBox:{key:"DropBox",customerTitle:"DropBox",typeTitle:"DropBox"},Google:{key:"Google",customerTitle:"Google",typeTitle:"Google"}};var c=function(){if(d===false){d=true;serviceManager.bind(ASC.Files.TemplateManager.events.SaveThirdParty,g);serviceManager.bind(ASC.Files.TemplateManager.events.DeleteThirdParty,f);jq.dropdownToggle({switcherSelector:"#files_addThirdParty_btn, #topAddThirdParty img",dropdownID:"addThirdPartyPanel",anchorSelector:"#topAddThirdParty img"})}};var e=function(r){if(r==null){return ASC.Files.ThirdParty.getThirdPartyType()!=null}r=jq(r);if(!r.is("li.fileRow")){r=r.closest("li.fileRow")}return r.hasClass("thirdPartyEntry")};var b=function(s){var r=ASC.Files.UI.getObjectData(s);var t=r?r.provider_name:jq("#currentProviderType").val();switch(t){case q.BoxNet.key:return q.BoxNet;case q.DropBox.key:return q.DropBox;case q.Google.key:return q.Google;default:return null}};var i=function(s,r){jq("#thirdPartyGetToken span").show();jq("#thirdPartyGetToken a").hide();jq("#thirdPartyGetToken input:hidden").val(s)};var j=function(){n(q.BoxNet)};var m=function(){n(q.DropBox)};var o=function(){n(q.Google)};var n=function(r){jq("#ThirdPartyEditor div[id$='InfoPanel']").hide();jq("#thirdPartyTitle").val(r.customerTitle);ASC.Files.UI.checkCharacter(jq("#thirdPartyTitle"));jq("#thirdPartyPanel input").removeAttr("disabled");jq("#thirdPartyPass").val("");jq("#thirdPartyCorporate").removeAttr("checked");jq("#thirdPartyGetToken input:hidden").val("");if(r.getTokenUrl){jq("#thirdPartyNamePass").hide();jq("#thirdPartyGetToken").show();jq("#thirdPartyGetToken span").hide();jq("#thirdPartyGetToken a").show().text(ASC.Files.FilesJSResources.ThirdPartyGetToken.format(r.typeTitle)).unbind("click").click(function(){OAuthCallback=ASC.Files.ThirdParty.setToken;OAuthPopup(r.getTokenUrl);return false})}else{jq("#thirdPartyNamePass").show();jq("#thirdPartyGetToken").hide()}jq("#ThirdPartyEditor .action-block").show();jq("#ThirdPartyEditor .ajax-info-block").hide();jq("#files_submitThirdParty").unbind("click").click(function(){ASC.Files.ThirdParty.submitEditor(r);return false});if(r.id){jq("#thirdPartyName").val(r.userName);jq("#thirdPartyCorporate").attr("checked",ASC.Files.Folders.folderContainer=="corporate");jq("#thirdPartyDialogCaption").text(ASC.Files.FilesJSResources.ThirdPartyEditorCaption.format(r.typeTitle))}else{jq("#thirdPartyDialogCaption").text(ASC.Files.FilesJSResources.ThirdPartyEditorCaptionAppend.format(r.typeTitle))}ASC.Files.Common.blockUI(jq("#ThirdPartyEditor"),400,300);PopupKeyUpActionProvider.EnterAction='jq("#files_submitThirdParty").click();';PopupKeyUpActionProvider.CloseDialogAction='jq("#thirdPartyPass").val("");';jq("#thirdPartyDivTitle").removeClass(q.BoxNet.key+" "+q.DropBox.key+" "+q.Google.key);jq("#thirdPartyDivTitle").addClass(r.key);jq("#thirdPartyTitle").focus()};var p=function(w){var s=jq("#thirdPartyTitle").val().trim();s=ASC.Files.Common.replaceSpecCharacter(s);var u=jq("#thirdPartyName").val().trim();var v=jq("#thirdPartyPass").val().trim();var x=jq("#thirdPartyGetToken input:hidden").val();var r=(jq("#thirdPartyCorporate").is(":checked")===true);var t=jq("#ThirdPartyEditor div[id$='InfoPanel']");t.hide();if(w.getTokenUrl){if(s==""||x==""){t.show().find("div").text(ASC.Files.FilesJSResources.ErrorMassage_FieldsIsEmpty);return}}else{if(s==""||u==""||v==""){t.show().find("div").text(ASC.Files.FilesJSResources.ErrorMassage_FieldsIsEmpty);return}}jq("#thirdPartyPass").val("");jq("#thirdPartyPanel input").attr("disabled","disabled");jq("#ThirdPartyEditor .action-block").hide();jq("#ThirdPartyEditor .ajax-info-block").show();if(w.folderId){ASC.Files.UI.blockObjectById("folder",w.folderId,true,ASC.Files.FilesJSResources.DescriptChangeInfo)}h(w.id,w.key,s,u,v,x,r,w.folderId)};var k=function(t,s,w,r){var v=ASC.Files.ThirdParty.getThirdPartyType(t);var u={getTokenUrl:v.getTokenUrl,key:v.key,typeTitle:v.typeTitle,id:r.provider_id,userName:r.provider_username,customerTitle:w,folderId:s};n(u)};var l=function(t,s,v){var u=ASC.Files.ThirdParty.getThirdPartyType(t);var r=v;var w=u.typeTitle;jq("#thirdPartyDeleteDescr").html("<b>"+ASC.Files.FilesJSResources.ConfirmDeleteThirdParty.format(r,w)+"</b>");jq("#files_deleteThirdParty").unbind("click").click(function(){ASC.Files.UI.blockObject(t,true,ASC.Files.FilesJSResources.DescriptRemove);PopupKeyUpActionProvider.CloseDialog();ASC.Files.ThirdParty.deleteProvider(s,r);return false});ASC.Files.Common.blockUI(jq("#ThirdPartyDelete"),400,300);PopupKeyUpActionProvider.EnterAction='jq("#files_showDeleteDialog").click();'};var h=function(y,z,u,v,x,A,r,t){var w={providerId:y,providerKey:z,folderTitle:u,login:v,password:x,token:A,corporate:r,folderId:t};var s={third_party:{auth_data:{login:v,password:x,token:A},corporate:r,customer_title:u,provider_id:y,provider_name:z}};serviceManager.request("post","xml",ASC.Files.TemplateManager.events.SaveThirdParty,w,s,"thirdparty","save")};var a=function(s,r){var t={folderId:s,customerTitle:r,parentId:ASC.Files.Folders.currentFolderId};serviceManager.request("get","json",ASC.Files.TemplateManager.events.DeleteThirdParty,t,"thirdparty","delete?folderId="+encodeURIComponent(s))};var g=function(C,B,u,r){var A=jq("#ThirdPartyEditor div[id$='InfoPanel']");jq("#thirdPartyPass").val("");if(typeof u!="undefined"){A.show().find("div").text(r||u);jq("#thirdPartyPanel input").removeAttr("disabled");jq("#ThirdPartyEditor .action-block").show();jq("#ThirdPartyEditor .ajax-info-block").hide();return undefined}PopupKeyUpActionProvider.CloseDialog();var x=B.corporate?ASC.Files.Constants.FOLDER_ID_COMMON_FILES:ASC.Files.Constants.FOLDER_ID_MY_FILES;var y=B.folderTitle;var w;var v=B.folderId;var t=0;var s=0;if(x==ASC.Files.Folders.currentFolderId){var D=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItem);var z=ASC.Controls.XSLTManager.translate(C,D);ASC.Files.EmptyScreen.hideEmptyScreen();w=ASC.Files.UI.getEntryObject("folder",v);if(w){t-=1+(parseInt(w.find(".countFolders").html())||0);s-=parseInt(w.find(".countFiles").html())||0;w.replaceWith(z);w=ASC.Files.UI.getEntryObject("folder",v)}else{jq("#files_mainContent").prepend(z);w=jq("#files_mainContent li.newFolder:first")}w.yellowFade().removeClass("newFolder");ASC.Files.UI.resetSelectAll();y=ASC.Files.UI.getObjectTitle(w);t+=1+(parseInt(w.find(".countFolders").html())||0);s+=parseInt(w.find(".countFiles").html())||0}else{if(v){w=ASC.Files.UI.getEntryObject("folder",v);t=-1-(parseInt(w.find(".countFolders").html())||0);s=-parseInt(w.find(".countFiles").html())||0;w.remove()}}if(w&&w.is(":visible")){ASC.Files.UI.addRowHandlers(w)}else{ASC.Files.UI.paintRows()}ASC.Files.UI.updateFolderInfo(t,s);ASC.Files.Tree.resetNode(x);ASC.Files.UI.displayInfoPanel(B.folderId?ASC.Files.FilesJSResources.InfoChangeThirdParty.format(y):ASC.Files.FilesJSResources.InfoSaveThirdParty.format(y,B.corporate?ASC.Files.FilesJSResources.CorporateFiles:ASC.Files.FilesJSResources.MyFiles))};var f=function(z,A,v,r){if(typeof v!="undefined"){ASC.Files.UI.displayInfoPanel(r||v,true);return undefined}var B=A.parentId;var w=A.folderId;var y=A.customerTitle;var x=ASC.Files.UI.getEntryObject("folder",w);if(x!=null){var u=1+(parseInt(x.find(".countFolders").html())||0);var t=parseInt(x.find(".countFiles").html())||0;x.remove();ASC.Files.UI.updateFolderInfo(-u,-t);ASC.Files.UI.paintRows();var s=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent li.fileRow").length;if(s>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,s)}else{if(s>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.EmptyScreen.displayEmptyScreen()}}}}ASC.Files.Tree.resetNode(B);ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRemoveThirdParty.format(y))};return{init:c,thirdPartyList:q,isThirdParty:e,getThirdPartyType:b,setToken:i,showBoxNetEditor:j,showDropBoxEditor:m,showGoogleEditor:o,showChangeDialog:k,showDeleteDialog:l,submitEditor:p,deleteProvider:a}})();(function(a){ASC.Files.ThirdParty.init();a(function(){jq("#ThirdPartyEditor div[id$='InfoPanel']").removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0");ASC.Files.ThirdParty.thirdPartyList.BoxNet.customerTitle=ASC.Files.FilesJSResources.FolderTitleBoxNet;ASC.Files.ThirdParty.thirdPartyList.BoxNet.typeTitle=ASC.Files.FilesJSResources.TypeTitleBoxNet;ASC.Files.ThirdParty.thirdPartyList.DropBox.customerTitle=ASC.Files.FilesJSResources.FolderTitleDropBox;ASC.Files.ThirdParty.thirdPartyList.DropBox.typeTitle=ASC.Files.FilesJSResources.TypeTitleDropBox;ASC.Files.ThirdParty.thirdPartyList.DropBox.getTokenUrl=ASC.Files.Constants.URL_OAUTH_DROPBOX;ASC.Files.ThirdParty.thirdPartyList.Google.customerTitle=ASC.Files.FilesJSResources.FolderTitleGoogle;ASC.Files.ThirdParty.thirdPartyList.Google.typeTitle=ASC.Files.FilesJSResources.TypeTitleGoogle;ASC.Files.ThirdParty.thirdPartyList.Google.getTokenUrl=ASC.Files.Constants.URL_OAUTH_GOOGLE;jq("#add_boxnet").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.ThirdParty.showBoxNetEditor();return false});jq("#add_dropbox").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.ThirdParty.showDropBoxEditor();return false});jq("#add_google").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.ThirdParty.showGoogleEditor();return false})})})(jQuery);window.ASC.Files.Actions=(function(){var d=false;var c=function(){if(d===false){d=true;jq(document).click(function(i){jq.dropdownToggle().registerAutoHide(i,"","#files_actionsPanel");jq.dropdownToggle().registerAutoHide(i,"li.row-selected div.rowActions","#files_actionPanel")});jq.dropdownToggle({switcherSelector:"#menuActionSelectOpen",dropdownID:"files_selectorPanel",anchorSelector:"li.menuActionSelectAll"})}};var h=function(o){jq("#files_unsubscribeButton, #files_deleteButton, #files_movetoButton, #files_copytoButton").hide();jq("#mainContentHeader .unlockAction").removeClass("unlockAction");var i=jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):has(div.checkbox input:checked)").length;var l=i;var j=0;var q=ASC.Files.UI.accessAdmin();var p=(ASC.Files.ThirdParty&&!ASC.Files.ThirdParty.isThirdParty());var k=0;jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):has(div.checkbox input:checked)").each(function(){var r=jq(this);if(ASC.Files.UI.editingFile(r)||!ASC.Files.UI.accessAdmin(r)){l--}else{q=ASC.Files.UI.accessAdmin(r)}if(ASC.Files.Folders.folderContainer=="forme"&&r.find("div.is_new:visible").length>0){j++}if(ASC.Files.ThirdParty){if(!ASC.Files.ThirdParty.isThirdParty()&&ASC.Files.ThirdParty.isThirdParty(r)){k++}else{p=false}}else{p=false}});if(i>0){jq("#files_downloadButton, #files_unsubscribeButton, #files_restoreButton, #files_copytoButton").show().find("span").html(i);jq("#files_mainDownload, #files_mainUnsubscribe, #files_mainRestore, #files_mainCopy").addClass("unlockAction");if(ASC.Files.Folders.folderContainer!="forme"){jq("#files_unsubscribeButton").hide()}}if(j>0){jq("#files_mainMarkRead").addClass("unlockAction")}if(l>0){jq("#files_deleteButton, #files_movetoButton").show().find("span").html(l-k);jq("#files_mainDelete, #files_mainMove").addClass("unlockAction")}if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_deleteButton, #files_movetoButton, #files_copytoButton").hide();jq("#files_mainDelete, #files_mainMove, #files_mainCopy").removeClass("unlockAction")}if(l==1&&!q||l!=1&&!ASC.Files.UI.accessAdmin()){jq("#files_deleteButton, #files_movetoButton").hide();jq("#files_mainDelete, #files_mainMove").removeClass("unlockAction")}jq("#files_restoreButton, #files_emptyTrashButton").hide();jq("#files_mainRestore, #files_mainEmptyTrash").removeClass("unlockAction");if(ASC.Files.Folders.folderContainer=="trash"){if(i>0){jq("#files_downloadButton, #files_deleteButton, #files_restoreButton").show();jq("#files_mainDownload, #files_mainDelete, #files_mainRestore").addClass("unlockAction")}else{jq("#files_downloadButton").hide();jq("#files_mainDownload").removeClass("unlockAction")}jq("#files_emptyTrashButton").show();jq("#files_mainEmptyTrash").addClass("unlockAction")}if(p){jq("#files_deleteButton, #files_movetoButton").hide();jq("#files_mainDelete, #files_mainMove").removeClass("unlockAction")}if(typeof o!="undefined"){var n=ASC.Files.Common.fixEvent(o);var m=jq("#files_actionsPanel");m.css({position:"absolute",top:n.pageY,left:n.pageX});m.toggle()}};var g=function(q,l){var k=ASC.Files.Common.fixEvent(q);var r=jq(k.srcElement||k.target);l=l||ASC.Files.UI.getObjectData(r);var n=l.entryObject;if(n.is(".loading")){return true}var p=l.entryType;var m=l.id;ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.checkSelectAll(false);ASC.Files.UI.selectRow(n,true);ASC.Files.UI.updateMainContentHeader();var o=l.title;jq("#files_actionPanel_folders, #files_actionPanel_files").hide();if(p==="file"){jq("#files_open_files,                #files_edit_files,                #files_download_files,                #files_shareaccess_files,                #files_unsubscribe_files,                #files_versions_files,                #files_moveto_files,                #files_copyto_files,                #files_rename_files,				#files_restore_files,                #files_remove_files").css("display","");jq("#files_download_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download(p,m)});jq("#files_rename_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.rename(p,m)});jq("#files_remove_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem(p,m)});if(ASC.Files.Utility.CanWebView(o)||typeof ASC.Files.ImageViewer!="undefined"&&ASC.Files.Utility.CanImageView(o)){jq("#files_open_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();var s=n.hasClass("isNewForWebEditor");ASC.Files.Folders.clickOnFile(m,null,o,s);n.removeClass("isNewForWebEditor");return false})}else{jq("#files_open_files").hide()}var i=l.version||0;if(i<2||ASC.Files.Folders.folderContainer=="trash"||jq("#content_versions").length!=0){jq("#files_versions_files").hide()}else{jq("#files_versions_files span").html(i);jq("#files_versions_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.showVersions(n,m)})}if(ASC.Files.UI.editingFile(n)){jq("#files_edit_files,                    #files_versions_files,                    #files_moveto_files,                    #files_rename_files,                    #files_remove_files").hide()}else{if(ASC.Files.UI.editableFile(l)&&!ASC.Files.UI.editingFile(n)){jq("#files_edit_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();PopupKeyUpActionProvider.CloseDialog();ASC.Files.Actions.checkEditFile(m,o)})}else{jq("#files_edit_files").hide()}}if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_open_files,                    #files_edit_files,                    #files_shareaccess_files,                    #files_versions_files,                    #files_moveto_files,                    #files_copyto_files,                    #files_rename_files").hide();jq("#files_remove_files,#files_restore_files").css("display","")}else{jq("#files_restore_files").hide()}if(ASC.Files.Folders.folderContainer=="project"){jq("#files_shareaccess_files").hide()}if(!ASC.Files.UI.accessibleItem(n)){jq("#files_edit_files,                    #files_rename_files").hide()}if(ASC.Files.UI.accessAdmin(n)){if(jq("#files_mainContent").hasClass("withShare")){jq("#files_shareaccess_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.getSharedInfo(p,m,o)})}else{jq("#files_shareaccess_files").hide()}}else{jq("#files_moveto_files,                    #files_shareaccess_files,                    #files_remove_files").hide()}if(ASC.Files.Folders.folderContainer=="forme"){jq("#files_unsubscribe_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.unSubscribeMe(p,m)})}else{jq("#files_unsubscribe_files").hide()}if(ASC.Files.ThirdParty&&ASC.Files.ThirdParty.isThirdParty(n)){jq("#files_shareaccess_files").hide();if(!ASC.Files.ThirdParty.isThirdParty()){jq("#files_remove_files").hide()}}jq("#files_actionPanel_files").show()}else{jq("#files_open_folders,				#files_download_folders,				#files_shareAccess_folders,				#files_unsubscribe_folders,				#files_moveto_folders,				#files_copyto_folders,				#files_rename_folders,				#files_restore_folders,                #files_remove_folders,                #files_remove_thirdparty,                #files_change_thirdparty").css("display","");jq("#files_open_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.navigationSet(m)});jq("#files_download_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download(p,m)});jq("#files_rename_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.rename(p,m)});if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_open_folders,                    #files_shareAccess_folders,                    #files_moveto_folders,                    #files_copyto_folders,                    #files_rename_folders").hide()}else{jq("#files_restore_folders").hide()}if(ASC.Files.Folders.folderContainer=="project"){jq("#files_shareAccess_folders").hide()}if(!ASC.Files.UI.accessibleItem(n)){jq("#files_rename_folders,                    #files_remove_thirdparty,                    #files_change_thirdparty").hide()}if(ASC.Files.UI.accessAdmin(n)){if(jq("#files_mainContent").hasClass("withShare")&&ASC.Files.Folders.folderContainer=="corporate"){jq("#files_shareAccess_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.getSharedInfo(p,m,o)})}else{jq("#files_shareAccess_folders").hide()}jq("#files_remove_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem(p,m)});jq("#files_remove_thirdparty").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.ThirdParty.showDeleteDialog(n,m,o)});jq("#files_change_thirdparty").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.ThirdParty.showChangeDialog(n,m,o,l)})}else{jq("#files_moveto_folders,                    #files_shareAccess_folders,                    #files_remove_folders,                    #files_remove_thirdparty                    #files_change_thirdparty").hide()}if(ASC.Files.Folders.folderContainer=="forme"){jq("#files_unsubscribe_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.unSubscribeMe(p,m)})}else{jq("#files_unsubscribe_folders").hide()}if(ASC.Files.ThirdParty&&ASC.Files.ThirdParty.isThirdParty(n)){jq("#files_shareAccess_folders").hide();if(ASC.Files.ThirdParty.isThirdParty()){jq("#files_remove_thirdparty,                        #files_change_thirdparty").hide()}else{jq("#files_remove_folders,                        #files_moveto_folders").hide();if(l.error){jq("#files_open_folders,                            #files_download_folders,                            #files_copyto_folders,                            #files_rename_folders").hide()}}}else{jq("#files_remove_thirdparty,                    #files_change_thirdparty").hide()}jq("#files_actionPanel_folders").show()}var j=jq("#files_actionPanel");if(r.is("div.rowActions")){j.css({top:r.offset().top+r.outerHeight(),left:"auto",right:jq(window).width()-r.offset().left-r.width(),margin:"5px -10px 0 0"});j.find(".popup-corner").css({left:"auto",right:"12px"})}else{j.css({top:k.pageY,left:k.pageX,right:"auto",margin:"5px 0 0 -25px"});j.find(".popup-corner").css({left:"20px",right:"auto"})}j.toggle();return false};var f=function(m){ASC.Files.Actions.hideAllActionPanels();var j=ASC.Files.Common.fixEvent(m);if(typeof j=="undefined"||!j){return true}var n=jq(j.srcElement||j.target);if(n.is('[id="files_prompt_rename"]')){return true}var k=ASC.Files.UI.getObjectData(n);if(!k){return true}var l=k.entryObject;if(l.hasClass("newFolder")||l.hasClass("rowRename")){return true}if(n.is("div.entryTitle a.name")&&jq(n,l).length){return true}jq("#files_mainContent .row-over").removeClass("row-over");var i=jq("#files_mainContent .fileRow.row-selected").length;if(i>1&&l.hasClass("row-selected")){ASC.Files.Actions.showActionsViewPanel(m)}else{ASC.Files.Actions.showActionsPanel(m,k)}return false};var b=function(){jq("div.files_popup_win").hide();ASC.Files.UI.hideEntryTooltip()};var a=function(j,m,l){l=(l===true);var k=ASC.Files.UI.getEntryObject("file",j);if(!l&&k.hasClass("isNewForWebEditor")){l=true}k.removeClass("isNewForWebEditor");ASC.Files.UI.lockEditFile(k,true);ASC.Files.UI.checkEditing();if(ASC.Files.Share){ASC.Files.Share.removeNewIcon("file",j)}var n=ASC.Files.Utility.GetFileWebEditorUrl(j)+(l?"&new=true":"");var o=window.open(n,"_blank");try{o.onload=function(){if(j){ASC.Files.UI.lockEditFile(k,true);ASC.Files.UI.checkEditing()}}}catch(i){}try{o.onunload=function(){if(j){ASC.Files.UI.checkEditing()}}}catch(i){}return};var e=function(){jq(document).unbind("mousedown");jq(document).unbind("mouseup");jq(document).unbind("mousemove");jq(document).mouseup(function(){ASC.Files.UI.mouseBtn=false});jq(document).mousedown(function(i){var j=(ASC.Files.UI.beginSelecting(i)==true);ASC.Files.UI.mouseBtn=true;return j});jq("#files_mainContent").mousemove(function(i){if(ASC.Files.UI.mouseBtn==false){ASC.Files.UI.handleMove(i)}return true});ASC.Files.UI.mouseBtn=false};return{init:c,showActionsViewPanel:h,showActionsPanel:g,onContextMenu:f,checkEditFile:a,hideAllActionPanels:b,mouseBindDocument:e}})();(function(a){ASC.Files.Actions.init();a(function(){jq("#files_selectAll").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.checkSelectAll(true)});jq("#files_selectFile, #files_selectFolder, #files_selectDocument,            #files_selectPresentation, #files_selectSpreadsheet, #files_selectImage").click(function(){ASC.Files.UI.checkSelect(this.id.replace("files_select",""))});jq("#files_mainContent").attr("oncontextmenu","return ASC.Files.Actions.onContextMenu(event);");jq("#files_mainContent").on("click","div.rowActions",ASC.Files.Actions.showActionsPanel);jq("#files_mainContent").on("click","div.fileEdit.pencil",function(){var b=ASC.Files.UI.getObjectData(this);var c=b.entryId;var d=b.title;ASC.Files.Actions.checkEditFile(c,d,false);return false});ASC.Files.Actions.mouseBindDocument()})})(jQuery);var OAuthCallback=function(b,a){};var OAuthError=function(a,b){ASC.Files.UI.displayInfoPanel(a,true)};var OAuthPopup=function(e,f,b){var c;try{var d="height="+(b||600)+",width="+(f||1020)+",resizable=0,status=0,toolbar=0,menubar=0,location=1";c=window.open(e,"Authorization",d)}catch(a){c=window.open(e,"Authorization")}return c};if(typeof jq=="undefined"){var jq=jQuery.noConflict()}(function(a){a.fn.yellowFade=function(){return(this.css({backgroundColor:"#ffffcc"}).animate({backgroundColor:"#ffffff"},1500,function(){jq(this).css({backgroundColor:""})}))}})(jQuery);if(typeof ASC==="undefined"){ASC={}}if(typeof ASC.Files==="undefined"){ASC.Files=(function(){return{}})()}if(typeof ASC.Files.Constants==="undefined"){ASC.Files.Constants={REQUEST_STATUS_DELAY:2000,MAX_NAME_LENGTH:170,COUNT_ON_PAGE:30,MAX_UPLOAD_SIZE:0,anchorRegExp:{error:/^error\/(\S+)?/,imprt:/^import(\/(\w+))?/,preview:/^preview\/(\d+|[a-z]+-\d+(-.+)*)/,folder:/^(\d+|[a-z]+-\d+(-.+)*)/,anyanchor:/^(\S+)?/},typeNewDoc:{document:".docx",spreadsheet:".xlsx",presentation:".pptx",image:".svg"}}}if(typeof ASC.Files.Common==="undefined"){ASC.Files.Common=(function(){var g=function(j){if(typeof j==="undefined"){return false}if(j===null){return false}if(j===0){return false}return ASC.Files.Constants.anchorRegExp.folder.test(j)};var f=function(){var j=jq.url.attr("protocol");j+="://";j+=jq.url.attr("host");if(jq.url.attr("port")!=null){j+=":";j+=jq.url.attr("port")}return j};var b=function(j){if(!j){j=window.event}j.cancelBubble=true;if(j.stopPropagation){j.stopPropagation()}};var e=function(k){k=k||window.event;if(k.pageX==null&&k.clientX!=null){var l=document.documentElement;var j=document.body;k.pageX=k.clientX+(l&&l.scrollLeft||j&&j.scrollLeft||0)-(l.clientLeft||0);k.pageY=k.clientY+(l&&l.scrollTop||j&&j.scrollTop||0)-(l.clientTop||0)}if(!k.which&&k.button){k.which=k.button&1?1:(k.button&2?3:(k.button&4?2:0))}return k};var a=function(l,n,k,m){try{n=parseInt(n||0);k=parseInt(k||0);left=n>0?parseInt(-n/2):-200;m=parseInt(m||-k/2)+jq(window).scrollTop();jq.blockUI({message:jq(l),css:{left:"50%",top:"50%",opacity:"1",border:"none",padding:"0px",width:n>0?n+"px":"auto",height:k>0?k+"px":"auto",cursor:"default",textAlign:"left",position:"absolute","margin-left":left+"px","margin-top":m+"px","background-color":"Transparent"},overlayCSS:{backgroundColor:"#aaaaaa",cursor:"default",opacity:"0.3"},focusInput:false,baseZ:666,fadeIn:0,fadeOut:0,onBlock:function(){var o=jq(l).parents("div.blockUI:first"),p=o.removeClass("blockMsg").addClass("blockDialog").get(0),q="";if(jq.browser.msie&&jq.browser.version<9&&o.length!==0){var s=" ",q=s+p.style.cssText,t=q.toLowerCase().indexOf(s+"filter:"),r=q.indexOf(";",t);if(t!==-1){if(r!==-1){p.style.cssText=[q.substring(s.length,t),q.substring(r+1)].join("")}else{p.style.cssText=q.substring(s.length,t)}}}}})}catch(j){}};var d="@#$%&*+:;\"'<>?|/";var c=new RegExp("[@#$%&*+:;\"'<>?|\\\\/]","gim");var i=function(j){return j.trim().replace(ASC.Files.Common.characterRegExp,"_")};var h={enter:13,esc:27,spaceBar:32,pageUP:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,deleteKey:46,a:65,f:70,n:78};return{getSitePath:f,cancelBubble:b,fixEvent:e,blockUI:a,keyCode:h,characterString:d,characterRegExp:c,replaceSpecCharacter:i,isCorrectId:g}})()}jQuery.url=function(){var g={};var e={};var c={url:window.location,strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var f=function(){str=decodeURI(c.url);var k=c.parser[c.strictMode?"strict":"loose"].exec(str);var l={};var j=14;while(j--){l[c.key[j]]=k[j]||""}l[c.q.name]={};l[c.key[12]].replace(c.q.parser,function(i,m,n){if(m){l[c.q.name][m]=n}});return l};var b=function(i){if(!e.length){h()}if(i=="base"){if(e.port!==null&&e.port!==""){return e.protocol+"://"+e.host+":"+e.port+"/"}else{return e.protocol+"://"+e.host+"/"}}return(e[i]==="")?null:e[i]};var d=function(i){if(!e.length){h()}return(e.queryKey[i]===null)?null:e.queryKey[i]};var h=function(){e=f();a()};var a=function(){var i=e.path;g=[];g=e.path.length==1?{}:(i.charAt(i.length-1)=="/"?i.substring(1,i.length-1):path=i.substring(1)).split("/")};return{setMode:function(i){strictMode=i=="strict"?true:false;return this},setUrl:function(i){c.url=i===undefined?window.location:i;h();return this},segment:function(i){if(!e.length){h()}if(i===undefined){return g.length}return(g[i]===""||g[i]===undefined)?null:g[i]},attr:b,param:d}}();
/* Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
* Licensed under the MIT License (LICENSE.txt).
* Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
* Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
* Thanks to: Seamus Leahy for adding deltaX and deltaY
* Version: 3.0.4
* Requires: 1.2.2+
*/
(function(a){var c=["DOMMouseScroll","mousewheel"];a.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var d=c.length;d;){this.addEventListener(c[--d],b,false)}}else{this.onmousewheel=b}},teardown:function(){if(this.removeEventListener){for(var d=c.length;d;){this.removeEventListener(c[--d],b,false)}}else{this.onmousewheel=null}}};a.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}});function b(h){var i=h||window.event,d=[].slice.call(arguments,1),e=0,j=true,f=0,g=0;h=a.event.fix(i);h.type="mousewheel";if(h.wheelDelta){e=h.wheelDelta/120}if(h.detail){e=-h.detail/3}g=e;if(i.axis!==undefined&&i.axis===i.HORIZONTAL_AXIS){g=0;f=-1*e}if(i.wheelDeltaY!==undefined){g=i.wheelDeltaY/120}if(i.wheelDeltaX!==undefined){f=-1*i.wheelDeltaX/120}d.unshift(h,e,f,g);return a.event.handle.apply(this,d)}})(jQuery);window.ASC.Files.DragDrop=(function(){var isInit=false;var totalDragDrop=0;var countDragDrop=0;var successDragDrop=0;var checkReady=true;var fileStek=new Array();var init=function(){if(isInit===false){isInit=true;if(canDragDrop()&&isFileAPI()){jq("#files_mainContent, #emptyContainer").bind("dragover",function(event){return ASC.Files.DragDrop.over(event)}).bind("dragenter",function(){return false}).bind("dragleave",function(event){return ASC.Files.DragDrop.leave(event)}).bind("drop",function(event){return ASC.Files.DragDrop.drop(event)});blockDocumentDrop()}else{jq("#emptyContainer .emptyContainer_dragDrop").remove()}}};var canDragDrop=function(){return"draggable" in document.createElement("span")&&typeof(new XMLHttpRequest()).upload!="undefined"};var isFileAPI=function(){return typeof FileReader!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined"};var over=function(e){var dt=e.originalEvent.dataTransfer;if(!dt){return true}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){return true}if(dt.types.contains&&!dt.types.contains("Files")){return true}if(dt.types.indexOf&&dt.types.indexOf("Files")==-1){return true}if(jq.browser.webkit){dt.dropEffect="copy"}jq("#files_mainContent, #emptyContainer").addClass("selected");return false};var leave=function(){return hideHighlight()};var drop=function(e){var dt=e.originalEvent.dataTransfer;if(!dt&&!dt.files){return true}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){return true}hideHighlight();var allFiles=dt.files;var filesToUpload=new Array(0);for(var i=0;i<allFiles.length;i++){if(correctFile(allFiles[i])){filesToUpload.push(allFiles[i])}}ASC.Files.DragDrop.totalDragDrop=ASC.Files.DragDrop.totalDragDrop+filesToUpload.length;if(filesToUpload.length!=0){for(var item=0;item<filesToUpload.length;item++){ASC.Files.DragDrop.uploadFile({file:filesToUpload[item],folder:ASC.Files.Folders.currentFolderId})}}return false};var hideHighlight=function(){jq("#files_mainContent, #emptyContainer").removeClass("selected");return false};var correctFile=function(obj){var sizeF=(obj.fileSize||obj.size);if(sizeF<=0){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_EmptyFile,true);return false}if(ASC.Files.Constants.MAX_UPLOAD_SIZE<sizeF){ASC.Files.UI.displayInfoPanel(ASC.Files.Constants.MAX_UPLOAD_EXCEED,true);return false}return true};var blockDocumentDrop=function(){jq(document).bind("dragenter",function(){return false}).bind("dragleave",function(){return false}).bind("dragover",function(e){var dt=e.originalEvent.dataTransfer;if(!dt){return true}dt.dropEffect="none";return false}.bind(this))};var uploadFile=function(fileElem){if(fileStek.length==0&&checkReady==true){checkReady=false;startUpload(fileElem)}else{fileStek.push(fileElem)}};var startUploadWithDelay=function(){var file=fileStek.shift();if(file!=undefined){checkReady=false;startUpload(file)}else{onEndProgress()}};var startUpload=function(fileElem){var file=fileElem.file;var folder=fileElem.folder;try{var fileName=ASC.Files.Common.replaceSpecCharacter(file.name||file.fileName);if(jq("#drag_drop_process").length==0){jq("#files_progress_template").clone().attr("id","drag_drop_process").appendTo("#files_bottom_loader");jq("#drag_drop_process").prepend('<div title="{0}" class="terminateTasks"></div>'.format(ASC.Files.FilesJSResources.TitleCancel))}jq("#drag_drop_process .progress").css("width","0%");jq("#drag_drop_process .percent").text("0%");jq("#drag_drop_process .headerBaseMedium").html(ASC.Files.FilesJSResources.FileUploading+" "+fileName);jq("#drag_drop_process").show();var xhr=new XMLHttpRequest();xhr.upload.addEventListener("progress",function(e){ASC.Files.DragDrop.onProgress(e)},false);xhr.onprogress=function(e){ASC.Files.DragDrop.onProgress(e)}.bind(this);xhr.onload=function(e){onCompleteUpload(e)}.bind(this);var sitePath=ASC.Files.Common.getSitePath();sitePath+=ASC.Files.Constants.URL_HANDLER_UPLOAD.format(folder,encodeURIComponent(fileName));xhr.open("POST",sitePath,true);xhr.send(file)}catch(error){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_DnDError,true);onCompleteUpload()}return false};var onCompleteUpload=function(e){checkReady=true;ASC.Files.DragDrop.countDragDrop++;var successUpload=true;if(typeof e!="undefined"){var result={error:true};try{result=eval("result="+e.target.responseText)}catch(e){}if(result.error===true){var strTitle=result.message;if(strTitle&&strTitle.length>0){ASC.Files.UI.displayInfoPanel(strTitle,true);successUpload=false}}else{ASC.Files.DragDrop.successDragDrop++;var folderDnD=result.folderId;if(ASC.Files.Common.isCorrectId(folderDnD)&&folderDnD==ASC.Files.Folders.currentFolderId){var file=result.file;var stringXmlFile=serviceManager.jsonToXml({file:file});var params={fileId:file.id,show:true,isStringXml:true};var fileObj=ASC.Files.UI.getEntryObject("file",file.id);if(fileObj.length!=0){ASC.Files.EventHandler.onReplaceVersion(stringXmlFile,params)}else{ASC.Files.EventHandler.onGetFile(stringXmlFile,params)}}}}jq("#drag_drop_process .progress").css("width","100%");jq("#drag_drop_process .percent").text("100%").css("color","white");jq("#drag_drop_process .textSmallDescribe").text(ASC.Files.FilesJSResources.ProcessUploadCountFiles.format(ASC.Files.DragDrop.countDragDrop,ASC.Files.DragDrop.totalDragDrop));if(ASC.Files.DragDrop.successDragDrop>0&&successUpload){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoUploadedSuccess.format(ASC.Files.DragDrop.successDragDrop))}if(fileStek.length==0){onEndProgress()}else{if(checkReady==true){setTimeout("ASC.Files.DragDrop.startUploadWithDelay()",100)}}};var onProgress=function(e){var progress=Math.min(Math.round(e.loaded*100/e.total),100);jq("#drag_drop_process .progress").css("width",progress+"%");jq("#drag_drop_process .percent").text(progress+"%");jq("#drag_drop_process .textSmallDescribe").text(ASC.Files.FilesJSResources.ProcessUploadCountFiles.format(ASC.Files.DragDrop.countDragDrop,ASC.Files.DragDrop.totalDragDrop))};var onEndProgress=function(){ASC.Files.DragDrop.totalDragDrop=0;ASC.Files.DragDrop.countDragDrop=0;ASC.Files.DragDrop.successDragDrop=0;setTimeout('jq("#drag_drop_process").hide();',800)};var terminateTasks=function(){fileStek.clear()};return{init:init,isFileAPI:isFileAPI,leave:leave,over:over,drop:drop,totalDragDrop:totalDragDrop,countDragDrop:countDragDrop,successDragDrop:successDragDrop,uploadFile:uploadFile,startUploadWithDelay:startUploadWithDelay,onProgress:onProgress,terminateTasks:terminateTasks}})();(function(a){a(function(){ASC.Files.DragDrop.init();jq("#files_bottom_loader").on("click","#drag_drop_process .terminateTasks",function(){ASC.Files.DragDrop.terminateTasks();return false})})})(jQuery);window.ASC.Files.Editor=(function(){var r=false;var i=false;var g=null;var k=null;var y=null;var n="";var w="";var j="";var v=null;var q=function(){if(r===false){r=true}jq("body").css("overflow-y","hidden");window.onbeforeunload=ASC.Files.Editor.finishEdit;serviceManager.bind("TrackEditFile",e);serviceManager.bind("CanEditFile",c)};var p=function(){var z=document.getElementById("wrap");if(z){z.style.height=screen.availHeight+"px";window.scrollTo(0,-1);z.style.height=window.innerHeight+"px"}};var s=function(){if(ASC.Files.Editor.serverErrorMessage){h("TeamLab",ASC.Files.Editor.serverErrorMessage);return}if(b()){return}if(ASC.Files.Editor.docServiceParams&&ASC.Files.Editor.docServiceParams.mode==="edit"){ASC.Files.Editor.trackEdit()}};var a=function(){location.href=ASC.Files.Editor.docServiceParams.folderurl};var l=function(z){if(i!=z.data){document.title=ASC.Files.Editor.docServiceParams.file.title+(z.data?" *":"");i=z.data}};var m=function(){ASC.Files.Editor.finishEdit()};var u=function(z){var B=z.data;var A=ASC.Files.Constants.URL_HANDLER_SAVE.format(ASC.Files.Editor.docServiceParams.file.id,ASC.Files.Editor.docServiceParams.file.version,encodeURIComponent(B));A+=ASC.Files.Editor.fileSaveAsNew;A+=ASC.Files.Editor.ShareLink;A+="&_="+new Date().getTime();jq.ajax({type:"get",url:A,complete:d})};var t=function(){serviceManager.canEditFile("CanEditFile",{fileID:ASC.Files.Editor.docServiceParams.file.id,shareLink:ASC.Files.Editor.ShareLink})};var x=function(){clearTimeout(y);serviceManager.trackEditFile("TrackEditFile",{fileID:ASC.Files.Editor.docServiceParams.file.id,docKeyForTrack:ASC.Files.Editor.docKeyForTrack,shareLink:ASC.Files.Editor.ShareLink})};var o=function(){if(y!==null){serviceManager.trackEditFile("FinishTrackEditFile",{fileID:ASC.Files.Editor.docServiceParams.file.id,docKeyForTrack:ASC.Files.Editor.docKeyForTrack,shareLink:ASC.Files.Editor.ShareLink,finish:true,ajaxsync:true})}};var d=function(){try{var B=jq.parseJSON(arguments[0].responseText)}catch(z){B=arguments[0].responseText.split("title>")[1].split("</")[0]}if(arguments[1]=="error"||B&&B.error){var A=B.message||B;h("Save Error",A);ASC.Files.Editor.docEditor.clearCache()}else{ASC.Files.Editor.documentStateChangeEditor({data:false});ASC.Files.Editor.trackEdit()}};var e=function(A,B,z){clearTimeout(y);if(typeof z!="undefined"){h("Error",z);return}y=setTimeout(ASC.Files.Editor.trackEdit,5000)};var h=function(A,z){ASC.Files.Editor.docEditor.showError(A,z)};var b=function(){var A=/^#error\/(\S+)?/;if(A.test(location.hash)){var z=A.exec(location.hash)[1];z=decodeURIComponent(z).replace(/\+/g," ");h("TeamLab",z);return true}return false};var c=function(A,B,z){A=A===true;ASC.Files.Editor.docEditor.applyEditRights(A,z);if(A){ASC.Files.Editor.trackEdit()}};var f=function(){jq("#iframeEditor").parents().css("height","100%").removeClass("clearFix");if(ASC.Files.Editor.docServiceParams){var B={title:ASC.Files.Editor.docServiceParams.file.title,url:ASC.Files.Editor.docServiceParams.url,fileType:ASC.Files.Editor.docServiceParams.filetype,key:ASC.Files.Editor.docServiceParams.key,vkey:ASC.Files.Editor.docServiceParams.vkey,outputType:ASC.Files.Editor.docServiceParams.outputtype,info:{author:ASC.Files.Editor.docServiceParams.file.modified_by,folder:ASC.Files.Editor.docServiceParams.filepath,created:ASC.Files.Editor.docServiceParams.file.modified_on,sharingSettings:ASC.Files.Editor.docServiceParams.sharingsettings},permissions:{edit:/edit/.test(ASC.Files.Editor.docServiceParams.buttons),download:/download/.test(ASC.Files.Editor.docServiceParams.buttons)}};var z=ASC.Files.Editor.docServiceParams.recent;var A=jq(ASC.Files.Editor.docServiceParams.templates).map(function(G,H){return{name:H.Key,icon:H.Value}}).toArray();var D={mode:ASC.Files.Editor.docServiceParams.mode,canBackToFolder:(ASC.Files.Editor.docServiceParams.folderurl.length>0),canCreateNew:/create/.test(ASC.Files.Editor.docServiceParams.buttons),createUrl:ASC.Files.Constants.URL_HANDLER_CREATE,recent:z,templates:A,lang:ASC.Files.Editor.docServiceParams.lang};var F=ASC.Files.Editor.docServiceParams.type||"desktop";var C=ASC.Files.Editor.docServiceParams.documentType}var E={onReady:ASC.Files.Editor.readyEditor,onBack:ASC.Files.Editor.backEditor,onDocumentStateChange:ASC.Files.Editor.documentStateChangeEditor,onRequestEditRights:ASC.Files.Editor.requestEditRightsEditor,onSave:ASC.Files.Editor.saveEditor,onError:ASC.Files.Editor.errorEditor};ASC.Files.Editor.docEditor=new DocsAPI.DocEditor("iframeEditor",{width:"100%",height:"100%",type:F,documentType:C,document:B,editorConfig:D,events:E})};return{init:q,createFrameEditor:f,fixSize:p,docEditor:g,docServiceParams:k,fileSaveAsNew:n,ShareLink:w,docKeyForTrack:j,serverErrorMessage:v,trackEdit:x,finishEdit:o,readyEditor:s,backEditor:a,documentStateChangeEditor:l,requestEditRightsEditor:t,errorEditor:m,saveEditor:u}})();(function(a){ASC.Files.Editor.init();a(function(){ASC.Files.Editor.createFrameEditor();if(jq.browser.mobile||ASC.Files.Editor.docServiceParams&&ASC.Files.Editor.docServiceParams.type==="mobile"){window.addEventListener("load",ASC.Files.Editor.fixSize);window.addEventListener("orientationchange",ASC.Files.Editor.fixSize)}})})(jQuery);window.ASC.Files.EventHandler=(function(){var isInit=false;var timoutTasksStatuses=null;var init=function(){if(isInit===false){isInit=true;ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.anyanchor,ASC.Files.EventHandler.onValidationAnchor);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.error,ASC.Files.EventHandler.onError);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.folder,ASC.Files.EventHandler.onSelectAnchor);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.preview,ASC.Files.EventHandler.onPreviewAnchor);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.imprt,ASC.Files.EventHandler.onImportAnchor);serviceManager.bind(ASC.Files.TemplateManager.events.GetFolderItems,ASC.Files.EventHandler.onGetFolderItems);serviceManager.bind(ASC.Files.TemplateManager.events.CheckEditing,ASC.Files.EventHandler.onCheckEditing);serviceManager.bind(ASC.Files.TemplateManager.events.GetFolderInfo,ASC.Files.EventHandler.onGetFolderInfo);serviceManager.bind(ASC.Files.TemplateManager.events.CreateFolder,ASC.Files.EventHandler.onCreateFolder);serviceManager.bind(ASC.Files.TemplateManager.events.CreateNewFile,ASC.Files.EventHandler.onCreateNewFile);serviceManager.bind(ASC.Files.TemplateManager.events.FolderRename,ASC.Files.EventHandler.onRenameFolder);serviceManager.bind(ASC.Files.TemplateManager.events.FileRename,ASC.Files.EventHandler.onRenameFile);serviceManager.bind(ASC.Files.TemplateManager.events.GetFileHistory,ASC.Files.EventHandler.onGetFileHistory);serviceManager.bind(ASC.Files.TemplateManager.events.SetCurrentVersion,ASC.Files.EventHandler.onSetCurrentVersion);serviceManager.bind(ASC.Files.TemplateManager.events.ReplaceVersion,ASC.Files.EventHandler.onReplaceVersion);serviceManager.bind(ASC.Files.TemplateManager.events.MoveFilesCheck,ASC.Files.EventHandler.onMoveFilesCheck);serviceManager.bind(ASC.Files.TemplateManager.events.MoveItems,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.DeleteItem,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.EmptyTrash,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.Download,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.TerminateTasks,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.GetTasksStatuses,ASC.Files.EventHandler.onGetTasksStatuses)}};var onValidationAnchor=function(anchor){if(ASC.Files.Constants.anchorRegExp.error.test(anchor)||ASC.Files.Constants.anchorRegExp.folder.test(anchor)||ASC.Files.Constants.anchorRegExp.preview.test(anchor)||ASC.Files.Constants.anchorRegExp.imprt.test(anchor)){return}ASC.Files.Folders.defaultFolderSet()};var onError=function(errorString){ASC.Files.UI.displayInfoPanel(decodeURIComponent(errorString).replace(/\+/g," "),true);if(jq.browser.msie){setTimeout("ASC.Files.Folders.defaultFolderSet();",3000)}else{ASC.Files.Folders.defaultFolderSet()}};var onSelectAnchor=function(itemid){jq("#files_trewViewContainer li.jstree-open, #files_trewViewSelector li.jstree-open").addClass("jstree-closed").removeClass("jstree-open");if(ASC.Files.Common.isCorrectId(itemid)){ASC.Files.Folders.currentFolderId=itemid}else{ASC.Files.Folders.currentFolderId=""}ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.updateFolderView()};var onPreviewAnchor=function(fileId){if(typeof ASC.Files.ImageViewer!="undefined"){ASC.Files.ImageViewer.init(fileId)}else{ASC.Files.Folders.defaultFolderSet()}};var onImportAnchor=function(source){source=(source||"").toLowerCase();if(ASC.Files.Import){ASC.Files.Folders.eventAfter=ASC.Files.Import.selectEventBySource(source)}ASC.Files.Folders.defaultFolderSet()};var onGetFolderItems=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);ASC.Files.Folders.defaultFolderSet();return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItems);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);ASC.Files.UI.resetSelectAll(false);ASC.Files.EmptyScreen.hideEmptyScreen();if(params.append==true){jq("#files_mainContent").append(htmlXML)}else{jq("#files_mainContent").html(htmlXML)}jq("#files_mainContent li.fileRow[name='addRow']").each(function(){ASC.Files.UI.getObjectData(this).entryObject.filter("[name!='addRow']").remove()});var countTotal=0;if(htmlXML!=""){countTotal=xmlData.getElementsByTagName("total")[0];countTotal=parseInt(countTotal.text||countTotal.textContent)||0}ASC.Files.UI.countEntityInFolder=countTotal;var countShowOnPage=parseInt(ASC.Files.Constants.COUNT_ON_PAGE)||0;ASC.Files.UI.amountPage=parseInt((countTotal/countShowOnPage).toFixed(0));if(ASC.Files.UI.amountPage-(countTotal/countShowOnPage)<0){ASC.Files.UI.amountPage++}ASC.Files.UI.currentPage=parseInt((jq("#files_mainContent li.fileRow[name!='addRow']").length-1)/countShowOnPage)+1;var countLeft=countTotal-jq("#files_mainContent li.fileRow").length;if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage&&countLeft>0){jq("#files_pageNavigatorHolder").show();jq("#files_pageNavigatorHolder a").text(countShowOnPage<countLeft?ASC.Files.FilesJSResources.ButtonShowMoreOf.format(countShowOnPage,countLeft):ASC.Files.FilesJSResources.ButtonShowMore.format(countLeft))}else{jq("#files_pageNavigatorHolder").hide()}if(!ASC.Files.Common.isCorrectId(ASC.Files.Folders.currentFolderId)){ASC.Files.Folders.defaultFolderSet();return}if(typeof xmlData!="undefined"){if(onGetFolderInfo(xmlData.getElementsByTagName("folder_info")[0],{id:ASC.Files.Folders.currentFolderId})){return}if(onGetPathParts(xmlData.getElementsByTagName("path_parts")[0],{id:ASC.Files.Folders.currentFolderId})){return}if(ASC.Files.Share&&xmlData.getElementsByTagName("count_new").length!=0){var valueNew=xmlData.getElementsByTagName("count_new")[0];valueNew=valueNew.childNodes[0].textContent||valueNew.childNodes[0].text;ASC.Files.Share.displayCountNew(valueNew,ASC.Files.Constants.FOLDER_ID_SHARE)}}if(htmlXML==""){ASC.Files.EmptyScreen.displayEmptyScreen()}else{ASC.Files.UI.addRowHandlers()}ASC.Files.UI.checkEditing();if(ASC.Files.Folders.eventAfter!=null){ASC.Files.Folders.eventAfter();ASC.Files.Folders.eventAfter=null}if(jq.browser.mobile){setTimeout("ASC.Files.UI.toggleMainMenu();",300)}};var onGetFolderInfo=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return false}if(xmlData==null){ASC.Files.Folders.defaultFolderSet();return true}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderInfo);var htmlData=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#currentFolderInfo").html(htmlData);jq("#currentFolderInfo").attr("title",jq("#currentFolderInfo").text());if(ASC.Files.Share){var curAccess=parseInt(jq("#access_current_folder").val());if(curAccess==ASC.Files.Constants.AceStatusEnum.Restrict){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.AceStatusEnum_Restrict,true);ASC.Files.Folders.defaultFolderSet();return true}}if(!ASC.Files.Common.isCorrectId(ASC.Files.Folders.currentFolderId)){ASC.Files.Folders.defaultFolderSet()}if(ASC.Files.Folders.currentFolderId==ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT){jq("#currentFolderTitle").val(ASC.Files.FilesJSResources.ProjectFiles)}document.title=jq("#currentFolderTitle").val()+" - "+ASC.Files.Constants.TITLE_PAGE;return false};var onGetPathParts=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return false}if(typeof xmlData=="undefined"||xmlData==null){return false}var data=new Array();xmlData=xmlData.childNodes;var i;for(i=0;i<xmlData.length;i++){data.push({Key:xmlData[i].childNodes[0].textContent||xmlData[i].childNodes[0].text,Value:xmlData[i].childNodes[1].textContent||xmlData[i].childNodes[1].text})}var visibleItems=[];var maxLength=65;var maxLengthItem;var id=0;var content;var title;var html="";if(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT!=""){var outside=-1;jq(data).each(function(j){if(this.Key==ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT){outside=j}});if(outside==-1){ASC.Files.Folders.navigationSet(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT);return true}data.splice(0,outside);data[0].Value=ASC.Files.FilesJSResources.ProjectFiles}if(data.length>4){maxLengthItem=maxLength/3;visibleItems[0]={id:data[0].Key,title:data[0].Value,content:data[0].Value.substring(0,maxLengthItem)};visibleItems[1]={id:data[data.length-3].Key,content:"...",title:""};jq(data.slice(1,data.length-2)).each(function(index,obj){if(index==data.length-4){visibleItems[1].title+=obj.Value;visibleItems[1].id=obj.Key}else{visibleItems[1].title+=obj.Value+" > "}});visibleItems[2]={id:data[data.length-2].Key,title:data[data.length-2].Value,content:data[data.length-2].Value.substring(0,maxLengthItem)+(data[data.length-2].Value.length>maxLengthItem?"...":"")};visibleItems[3]={id:data[data.length-1].Key,title:data[data.length-1].Value,content:data[data.length-1].Value.substring(0,maxLengthItem)+(data[data.length-1].Value.length>maxLengthItem?"...":"")}}else{maxLengthItem=(maxLength/data.length).toFixed();for(i=0;i<data.length;i++){id=data[i].Key;content=data[i].Value;title=content;content=content.substring(0,maxLengthItem)+(content.length>maxLengthItem?"...":"");visibleItems[i]={id:id,content:content,title:title}}}ASC.Files.Tree.pathParts=data;jq("#files_breadCrumbsCaption").html(visibleItems[0].title).attr("title",visibleItems[0].title).attr("href","#"+encodeURIComponent(visibleItems[0].id));for(i=1;i<visibleItems.length;i++){id=visibleItems[i].id;content=visibleItems[i].content;title=visibleItems[i].title;if(i!=visibleItems.length-1){html+="<span>&gt;</span><a href='#{0}' data-id='{0}' onclick='ASC.Files.Folders.navigationSet(\"{0}\");return false;' title='{1}' >{2}</a>".format(id,title,content)}else{html+="<span>&gt;</span><span class='breadCrumbs_cur' title='{0}'>{1}</span>".format(title,content)}}jq("#files_breadCrumbs").html(html);if(data.length==0){return false}var container=data[0].Key;jq("#mainContentHeader .menuAction").removeClass("unlockAction").hide();jq("#files_breadCrumbsRoot, #files_mainContent").removeClass("myFiles").removeClass("corporateFiles").removeClass("shareformeFiles").removeClass("trashFiles").removeClass("projectFiles");switch(container){case ASC.Files.Constants.FOLDER_ID_MY_FILES:ASC.Files.Folders.folderContainer="my";jq("#files_breadCrumbsRoot, #files_mainContent").addClass("myFiles");jq("#files_mainDownload, #files_mainMove, #files_mainCopy, #files_mainDelete").show();break;case ASC.Files.Constants.FOLDER_ID_COMMON_FILES:ASC.Files.Folders.folderContainer="corporate";jq("#files_breadCrumbsRoot, #files_mainContent").addClass("corporateFiles");jq("#files_mainDownload, #files_mainMove, #files_mainCopy, #files_mainDelete").show();break;case ASC.Files.Constants.FOLDER_ID_SHARE:ASC.Files.Folders.folderContainer="forme";jq("#files_breadCrumbsRoot, #files_mainContent").addClass("shareformeFiles");jq("#files_mainDownload, #files_mainCopy, #files_mainMarkRead, #files_mainUnsubscribe").show();break;case ASC.Files.Constants.FOLDER_ID_TRASH:ASC.Files.Folders.folderContainer="trash";jq("#files_breadCrumbsRoot, #files_mainContent").addClass("trashFiles");jq("#files_mainDownload, #files_mainRestore, #files_mainDelete, #files_mainEmptyTrash").show();jq("#files_mainEmptyTrash").addClass("unlockAction");break;case ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT:ASC.Files.Folders.folderContainer="project";jq("#files_breadCrumbsRoot, #files_mainContent").addClass("projectFiles");jq("#files_mainDownload, #files_mainMove, #files_mainCopy, #files_mainDelete").show();break;default:if(!ASC.Files.Common.isCorrectId(ASC.Files.Folders.currentFolderId)){ASC.Files.Folders.defaultFolderSet();return true}}ASC.Files.Filter.disableFilter();if(ASC.Files.Share&&(container!=ASC.Files.Constants.FOLDER_ID_COMMON_FILES||ASC.Files.Constants.USER_ADMIN)&&container!=ASC.Files.Constants.FOLDER_ID_TRASH&&container!=ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT&&ASC.Files.UI.accessAdmin()&&jq("#folder_shareable").val()!="false"){jq("#files_mainContent").addClass("withShare")}else{jq("#files_mainContent").removeClass("withShare")}return false};var onCreateNewFile=function(xmlData,params,errorMessage,commentMessage){var fileNewObj=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");ASC.Files.UI.blockObject(fileNewObj);if(typeof errorMessage!="undefined"){fileNewObj.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItem);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);fileNewObj.replaceWith(htmlXML);ASC.Files.UI.resetSelectAll(false);var fileObj=jq("#files_mainContent li.newFile").show().yellowFade().removeClass("newFile");var fileData=ASC.Files.UI.getObjectData(fileObj);fileObj=fileData.entryObject;var fileTitle=fileData.title;var fileId=fileData.entryId;ASC.Files.UI.addRowHandlers(fileObj);ASC.Files.UI.updateFolderInfo(0,1);ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoCrateFile.format(fileTitle));fileObj.addClass("isNewForWebEditor");if(!jq.browser.mozilla){ASC.Files.Actions.checkEditFile(fileId,fileTitle,true)}};var onCreateFolder=function(xmlData,params,errorMessage,commentMessage){var folderNewObj=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");if(typeof errorMessage!="undefined"){folderNewObj.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItem);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);folderNewObj.replaceWith(htmlXML);ASC.Files.UI.resetSelectAll(false);var folderObj=jq("#files_mainContent li.newFolder").yellowFade().removeClass("newFolder");var folderData=ASC.Files.UI.getObjectData(folderObj);folderObj=folderData.entryObject;var folderTitle=folderData.title;ASC.Files.UI.addRowHandlers(folderObj);ASC.Files.UI.updateFolderInfo(1,0);ASC.Files.Tree.resetNode(ASC.Files.Folders.currentFolderId);ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoCrateFolder.format(folderTitle))};var onRenameFolder=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItem);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);var folderId=params.folderId;var folderObj=ASC.Files.UI.getEntryObject("folder",folderId);folderObj.replaceWith(htmlXML);folderObj=ASC.Files.UI.getEntryObject("folder",folderId);var itemNewData=ASC.Files.UI.getObjectData(folderObj);itemNewData=itemNewData||ASC.Files.UI.getObjectData("#files_mainContent li.newFolder");folderObj=itemNewData.entryObject;var folderNewTitle=itemNewData.title;folderObj.yellowFade().removeClass("newFolder");ASC.Files.UI.addRowHandlers(folderObj);ASC.Files.Tree.resetNode(ASC.Files.Folders.currentFolderId);ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRenameFolder.format(params.name,folderNewTitle))};var onRenameFile=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var fileData=ASC.Files.EventHandler.onReplaceVersion(xmlData,params,errorMessage,commentMessage);var newName=fileData.title;ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRenameFile.format(params.name,newName))};var onSetCurrentVersion=function(xmlData,params,errorMessage,commentMessage){var fileId=params.fileId;var fileObj=ASC.Files.UI.getEntryObject("file",fileId);if(typeof errorMessage!="undefined"){ASC.Files.UI.blockObject(fileObj);jq("div.version_operation").css("visibility","");ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}if(!ASC.Files.Common.isCorrectId(fileId)){return}var fileData=ASC.Files.UI.getObjectData(fileObj);var version=parseInt(fileData.version||0);var modifiedOn=fileData.modified_on;var contentLength=fileData.content_length;var modifiedByName=fileData.modified_by;var xmlRowString="<fileList withoutheader='true'>    <entry>        <id>"+fileId+"</id>        <modified_by>"+modifiedByName+"</modified_by>        <modified_on>"+modifiedOn+"</modified_on>        <content_length>"+contentLength+"</content_length>        <version>"+version+"</version>    </entry></fileList>";var xslDataRow=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFileHistory);var lastVersion=ASC.Controls.XSLTManager.translateFromString(xmlRowString,xslDataRow);jq(lastVersion).insertAfter("#content_versions span.versionsTitle");jq("div.version_num a:first").attr("href",ASC.Files.Utility.GetFileViewUrl(fileId,version));jq("#content_versions div.versionRow.even").removeClass("even");jq("#content_versions div.versionRow:even").addClass("even");try{var content_versions=jq("#content_versions").clone(true)}catch(ex){ASC.Files.Folders.showVersions(fileObj,fileId);return false}var curTemplate=ASC.Files.TemplateManager.templates.getFolderItem;var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);var newFileObj=ASC.Files.UI.getEntryObject("file",fileId);newFileObj.replaceWith(htmlXML);newFileObj=ASC.Files.UI.getEntryObject("file",fileId);var newFileData=ASC.Files.UI.getObjectData(newFileObj);var fileTitle=newFileData.title;jq("#files_mainContent li.newFile").removeClass("newFile").show();newFileObj.append(content_versions);ASC.Files.UI.addRowHandlers(newFileObj);ASC.Files.UI.blockObject(newFileObj);jq("div.version_operation").css("visibility","");ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.FileVersionRecovery.format(fileTitle),false)};var onGetFileHistory=function(xmlData,params,errorMessage,commentMessage){var fileId=params.fileId;var fileObj=ASC.Files.UI.getEntryObject("file",fileId);ASC.Files.UI.blockObject(fileObj);ASC.Files.UI.selectRow(fileObj,true);ASC.Files.UI.updateMainContentHeader();if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFileHistory);var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_versions").remove();fileObj.append('<div id="content_versions" class="notPreview"><span class="clearFix versionsTitle">{0}</span></div>'.format(ASC.Files.FilesJSResources.TitleVersions));jq("#content_versions").append(htmlXML);if(!ASC.Files.UI.accessibleItem(fileObj)||ASC.Files.UI.editingFile(fileObj)){jq("div.version_operation a.version_restore").remove()}var titleFile=ASC.Files.UI.getObjectTitle(fileObj);if(ASC.Files.Utility.CanWebView(titleFile)){jq("#content_versions.notPreview").removeClass("notPreview")}};var onReplaceVersion=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var fileId=params.fileId;if(!ASC.Files.Common.isCorrectId(fileId)){return}var curTemplate=ASC.Files.TemplateManager.templates.getFolderItem;var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);var htmlXML=(params.isStringXml===true?ASC.Controls.XSLTManager.translateFromString(xmlData,xslData):ASC.Controls.XSLTManager.translate(xmlData,xslData));var fileObj=ASC.Files.UI.getEntryObject("file",fileId);fileObj.replaceWith(htmlXML);fileObj=ASC.Files.UI.getEntryObject("file",fileId);var itemNewData=ASC.Files.UI.getObjectData(fileObj);itemNewData=itemNewData||ASC.Files.UI.getObjectData("#files_mainContent li.newFile");fileObj=itemNewData.entryObject;if(params.show){ASC.Files.EmptyScreen.hideEmptyScreen();itemNewData.entryObject.removeClass("newFile").show().yellowFade()}ASC.Files.UI.addRowHandlers(fileObj);ASC.Files.UI.resetSelectAll(false);ASC.Files.UI.checkEditing();ASC.Files.Actions.showActionsViewPanel();return itemNewData};var onGetFile=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var fileId=params.fileId;if(!ASC.Files.Common.isCorrectId(fileId)){return}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItem);var htmlXML=(params.isStringXml===true?ASC.Controls.XSLTManager.translateFromString(xmlData,xslData):ASC.Controls.XSLTManager.translate(xmlData,xslData));jq("#files_mainContent").prepend(htmlXML);ASC.Files.UI.updateFolderInfo(0,1);var fileObj=ASC.Files.UI.getEntryObject("file",fileId);var fileData=ASC.Files.UI.getObjectData(fileObj);fileData=fileData||ASC.Files.UI.getObjectData("#files_mainContent li.newFile");fileObj=fileData.entryObject;if(params.show){ASC.Files.EmptyScreen.hideEmptyScreen();fileData.entryObject.removeClass("newFile").show().yellowFade()}ASC.Files.UI.addRowHandlers(fileObj);ASC.Files.UI.resetSelectAll(false);ASC.Files.UI.checkEditing();ASC.Files.Actions.showActionsViewPanel();return fileData};var onMoveFilesCheck=function(data,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){jq(params.list.entry).each(function(){var curItem=ASC.Files.UI.parseItemId(this);ASC.Files.UI.blockObjectById(curItem.entryType,curItem.entryId)});ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}data=eval(data);if(data!=null&&data.length>0){ASC.Files.UI.showOverwriteMessage(params.list,params.folderToId,params.folderToTitle,params.isCopyOperation,data)}else{serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{folderToId:params.folderToId,overwrite:false,isCopyOperation:params.isCopyOperation,doNow:true},{stringList:params.list});ASC.Files.Folders.isCopyTo=false}};var onMoveItemsFinish=function(listData,isCopyOperation,countProcessed){var folderToId=ASC.Files.UI.parseItemId(listData[0]).entryId;listData=listData.slice(1);var listItemId=new Array();for(var i=0;i<listData.length;i++){var curItem=ASC.Files.UI.parseItemId(decodeURIComponent(listData[i]));if(curItem==null){continue}listItemId.push(curItem);ASC.Files.UI.blockObjectById(curItem.entryType,curItem.entryId)}var folderToObj=ASC.Files.UI.getEntryObject("folder",folderToId);folderToObj.removeClass("row-to");var foldersCount=0,filesCount=0;var entryTitle="";if(listItemId.length==1){entryTitle=ASC.Files.UI.getEntryTitle(listItemId[0].entryType,listItemId[0].entryId);if(typeof entryTitle==undefined||entryTitle==null){entryTitle=""}}for(var i=0;i<listItemId.length;i++){var entryRowObj=ASC.Files.UI.getEntryObject(listItemId[i].entryType,listItemId[i].entryId);if(listItemId[i].entryType=="file"){filesCount++}else{foldersCount+=1+(parseInt(entryRowObj.find(".countFolders").html())||0);filesCount+=parseInt(entryRowObj.find(".countFiles").html())||0}if(!isCopyOperation&&ASC.Files.Folders.currentFolderId!=folderToId){entryRowObj.remove()}}if(foldersCount>0){var folderCountObj=folderToObj.find(".countFolders");folderCountObj.html((parseInt(folderCountObj.html())||0)+foldersCount);ASC.Files.Tree.resetNode(folderToId);if(!isCopyOperation&&folderToId!=ASC.Files.Folders.currentFolderId){ASC.Files.Tree.resetNode(ASC.Files.Folders.currentFolderId)}}if(filesCount>0){var fileCountObj=folderToObj.find(".countFiles");fileCountObj.html((parseInt(fileCountObj.html())||0)+filesCount)}if(listItemId.length>0){ASC.Files.Folders.getFolderInfo()}if(listItemId.length>0&&ASC.Files.Folders.currentFolderId!=folderToId){ASC.Files.UI.paintRows();var countAppend=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent li.fileRow").length;if(countAppend>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,countAppend)}else{if(countAppend>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.EmptyScreen.displayEmptyScreen()}}}}if(isCopyOperation){if(listItemId.length==1&&entryTitle!=""){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoCopyItem.format(entryTitle))}else{ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoCopyGroup.format(countProcessed))}}else{if(listItemId.length==1&&entryTitle!=""){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoMoveItem.format(entryTitle))}else{ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoMoveGroup.format(countProcessed))}}};var onDeleteItemFinish=function(listData,totalCount){var fromRootId=ASC.Files.UI.parseItemId(listData[0]).entryId;listData=listData.slice(1);var listItemId=new Array();for(var i=0;i<listData.length;i++){var curItem=ASC.Files.UI.parseItemId(decodeURIComponent(listData[i]));if(curItem==null){continue}listItemId.push(curItem);ASC.Files.UI.blockObjectById(curItem.entryType,curItem.entryId)}var foldersCount=0;var countSubFolder=0,countSubFile=0;var entryTitle="";var redrawItems=(ASC.Files.Tree.pathParts.length>0&&(ASC.Files.Tree.pathParts[0].Key===fromRootId||(ASC.Files.ThirdParty&&ASC.Files.ThirdParty.isThirdParty())));if(listItemId.length==1){entryTitle=ASC.Files.UI.getEntryTitle(listItemId[0].entryType,listItemId[0].entryId);if(typeof entryTitle==undefined||entryTitle==null){entryTitle=""}}for(var i=0;i<listItemId.length;i++){var entryRowObj=ASC.Files.UI.getEntryObject(listItemId[i].entryType,listItemId[i].entryId);if(listItemId[i].entryType=="file"){countSubFile++}else{foldersCount++;countSubFolder+=1+(parseInt(entryRowObj.find(".countFolders").html())||0);countSubFile+=parseInt(entryRowObj.find(".countFiles").html())||0}if(redrawItems){entryRowObj.remove()}}if(foldersCount>0){ASC.Files.Tree.resetNode(ASC.Files.Folders.currentFolderId)}if(listItemId.length>0&&redrawItems){ASC.Files.UI.updateFolderInfo(-countSubFolder,-countSubFile);ASC.Files.UI.paintRows();var countAppend=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent li.fileRow").length;if(countAppend>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,countAppend)}else{if(countAppend>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.EmptyScreen.displayEmptyScreen()}}}}if(listItemId.length==1&&entryTitle!=""){if(foldersCount>0){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRemoveFolder.format(entryTitle))}else{ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRemoveFile.format(entryTitle))}}else{ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoRemoveGroup.format(listItemId.length,totalCount))}if(fromRootId==ASC.Files.Constants.FOLDER_ID_TRASH&&ASC.Files.Constants.MAX_UPLOAD_KB<1024*1024){window.location.reload()}};var onCheckEditing=function(jsonData,params,errorMessage,commentMessage){clearTimeout(ASC.Files.UI.timeCheckEditing);if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}if(!jsonData){jsonData=[]}var list=jq("#files_mainContent li.fileRow.onEdit");for(var i=0;i<list.length;i++){var fileData=ASC.Files.UI.getObjectData(list[i]);var fileObj=fileData.entryObject;var fileId=fileData.entryId;ASC.Files.UI.lockEditFile(fileObj,false);var repl=true;for(var j=0;j<jsonData.length&&repl;j++){if(fileId==jsonData[j].Key){repl=false}}if(repl){ASC.Files.Folders.replaceVersion(fileId,true)}}for(var k=0;k<jsonData.length;k++){ASC.Files.UI.lockEditFileById(jsonData[k].Key,true,jsonData[k].Value)}if(jsonData.length>0){ASC.Files.UI.timeCheckEditing=setTimeout(function(){ASC.Files.UI.checkEditing()},5000)}};var onGetTasksStatuses=function(data,params,errorMessage,commentMessage){if(typeof data!=="object"&&typeof errorMessage!="undefined"||data==null){ASC.Files.Folders.cancelTasksStatuses();if(ASC.Files.Import){ASC.Files.Import.cancelImportData("")}ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return}if(data.length==0){ASC.Files.Folders.cancelTasksStatuses();if(ASC.Files.Import){ASC.Files.Import.cancelImportData("")}return}var finishImport=true;var progress=0;var operationType;var operationTypes=[ASC.Files.FilesJSResources.TasksOperationMove,ASC.Files.FilesJSResources.TasksOperationCopy,ASC.Files.FilesJSResources.TasksOperationDelete,ASC.Files.FilesJSResources.TasksOperationBulkdownload];var blockTypes=[ASC.Files.FilesJSResources.DescriptMove,ASC.Files.FilesJSResources.DescriptCopy,ASC.Files.FilesJSResources.DescriptRemove,ASC.Files.FilesJSResources.DescriptBulkdownload];for(var i=0;i<data.length&&ASC.Files.Import;i++){if(data[i].operation==4){finishImport=ASC.Files.Import.onGetImportStatus(data.splice(i,1)[0],params.isTerminate);break}}if(data.length!=0){if(jq("#files_tasks:visible").length==0){clearTimeout(timoutTasksStatuses);if(jq("#files_tasks").length==0){jq("#files_progress_template").clone().attr("id","files_tasks").appendTo("#files_bottom_loader");jq("#files_tasks").prepend('<div title="{0}" class="terminateTasks"></div>'.format(ASC.Files.FilesJSResources.TitleCancel))}jq("#files_tasks .progress").css("width","0%");jq("#files_tasks .percent").text("0%");jq("#files_tasks .headerBaseMedium").html("");jq("#files_tasks").show();if(jq.browser.mobile){jq("#files_bottom_loader").css("bottom","auto");jq("#files_bottom_loader").css("top",jq(window).scrollTop()+jq(window).height()-jq("#files_bottom_loader").height()+"px")}}if(data.length>1){operationType=ASC.Files.FilesJSResources.TasksOperationMixed.format(data.length)}else{operationType=operationTypes[data[0].operation]}jq("#files_tasks .headerBaseMedium").html(operationType)}for(var i=0;i<data.length;i++){var splitCharacter=":";var listSource=data[i].source.trim().split(splitCharacter);jq(listSource).each(function(){var itemId=ASC.Files.UI.parseItemId(decodeURIComponent(this));if(itemId==null){return true}ASC.Files.UI.blockObjectById(itemId.entryType,itemId.entryId,true,blockTypes[data[i].operation])});var curProgress=data[i].progress;progress+=curProgress;if(curProgress==100){if(data[i].result!=null){var listResult=data[i].result.trim().split(splitCharacter);switch(data[i].operation){case 0:onMoveItemsFinish(listResult,false,data[i].processed);break;case 1:onMoveItemsFinish(listResult,true,data[i].processed);break;case 2:onDeleteItemFinish(listResult,listSource.length);break;case 3:if(listResult[0]){location.href=listResult[0]}ASC.Files.Folders.bulkStatuses=false;break}}jq(listSource).each(function(){var itemId=ASC.Files.UI.parseItemId(this);if(itemId==null){return true}ASC.Files.UI.blockObjectById(itemId.entryType,itemId.entryId)});if(data[i].error!=null){ASC.Files.UI.displayInfoPanel(data[i].error,true)}}}progress=(data.length==0?100:progress/data.length);jq("#files_tasks .progress").css("width",progress+"%");jq("#files_tasks .percent").text(progress+"%");if(progress==100){clearTimeout(timoutTasksStatuses);timoutTasksStatuses=setTimeout("ASC.Files.Folders.cancelTasksStatuses()",500);if(finishImport){return}}ASC.Files.Folders.getTasksStatuses(params.doNow)};return{init:init,onError:onError,onValidationAnchor:onValidationAnchor,onSelectAnchor:onSelectAnchor,onPreviewAnchor:onPreviewAnchor,onImportAnchor:onImportAnchor,onGetFolderItems:onGetFolderItems,onGetFolderInfo:onGetFolderInfo,onGetFile:onGetFile,onCreateNewFile:onCreateNewFile,onCreateFolder:onCreateFolder,onRenameFolder:onRenameFolder,onRenameFile:onRenameFile,onSetCurrentVersion:onSetCurrentVersion,onGetFileHistory:onGetFileHistory,onReplaceVersion:onReplaceVersion,onCheckEditing:onCheckEditing,onMoveFilesCheck:onMoveFilesCheck,onGetTasksStatuses:onGetTasksStatuses}})();(function(a){ASC.Files.EventHandler.init();a(function(){if(!startTasksStatuses){startTasksStatuses=[]}ASC.Files.EventHandler.onGetTasksStatuses(startTasksStatuses,{doNow:true});startTasksStatuses=null;jq("#files_bottom_loader").on("click","#files_tasks .terminateTasks",function(){ASC.Files.Folders.terminateTasks(false);return false})})})(jQuery);window.ASC.Files.Filter=(function(){var i=false;var a=null;var h=function(){if(i===false){i=true}};var c=function(){var m=ASC.Files.Folders.folderContainer=="my";var l=ASC.Files.Folders.folderContainer=="forme";ASC.Files.Filter.advansedFilter.advansedfilter("sort",!l);if(l){ASC.Files.Filter.advansedFilter.advansedFilter({sorters:[{id:"DateAndTime",def:true,dsc:true}]})}ASC.Files.Filter.advansedFilter.advansedFilter({filters:[{id:"selected-person",visible:!m},{id:"selected-group",visible:!m}],sorters:[{id:"Author",visible:!m}]})};var k=function(m,l,n,o,p){if(!i){ASC.Files.Filter.init();return}ASC.Files.Folders.navigationSet(ASC.Files.Folders.currentFolderId)};var j=function(m,l,n){if(!i){ASC.Files.Filter.init();return}ASC.Files.Folders.navigationSet(ASC.Files.Folders.currentFolderId)};var b=function(){ASC.Files.Filter.advansedFilter.advansedFilter(null);ASC.Files.Folders.navigationSet(ASC.Files.Folders.currentFolderId)};var d=function(){var m={sorter:ASC.Files.Filter.getOrderByDateAndTime(false),text:"",filter:0,subject:""};if(ASC.Files.Filter.advansedFilter==null){return m}var l=ASC.Files.Filter.advansedFilter.advansedFilter();jq(l).each(function(n,o){switch(o.id){case"sorter":m.sorter=e(o.params.id,!o.params.dsc);break;case"text":m.text=o.params.value;break;case"selected-person":m.filter=8;m.subject=o.params.id;break;case"selected-group":m.filter=9;m.subject=o.params.id;break;case"selected-type":m.filter=parseInt(o.params.value||0);break}});if(ASC.Files.Folders.folderContainer=="forme"){m.sorter=ASC.Files.Filter.getOrderByDateAndTime(false)}return m};var g=function(l){return e("DateAndTime",l)};var f=function(l){return e("AZ",l)};var e=function(m,l){m=(typeof m!="undefined"&&m!=""?m:"DateAndTime");l=l===true;return{is_asc:l,property:m}};return{init:h,advansedFilter:a,disableFilter:c,getFilterSettings:d,getOrderByDateAndTime:g,getOrderByAZ:f,setFilter:k,resetFilter:j,clearFilter:b}})();(function(a){a(function(){jq("#files_clearFilter").click(function(){ASC.Files.Filter.clearFilter();return false})})})(jQuery);window.ASC.Files.Folders=(function(){var B=null;var a=false;var i="";var o="";var n=null;var D="";var v="";var s=false;var t=function(E,F){if(!ASC.Files.Common.isCorrectId(E)){E=ASC.Files.Folders.currentFolderId}if(F===true){ASC.Controls.AnchorController.safemove(E)}else{ASC.Controls.AnchorController.move(E)}};var w=function(E,F){ASC.Files.UI.resetSelectAll(false);ASC.Files.UI.amountPage=0;if(ASC.Files.Common.isCorrectId(E)){if(!F||ASC.Files.Folders.currentFolderId!=E){ASC.Files.Folders.currentFolderId=E;ASC.Files.Folders.folderContainer=""}t(null,F)}else{ASC.Files.Folders.currentFolderId="";ASC.Files.Folders.folderContainer=E;t(E,F)}};var j=function(){if(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT==""){if(ASC.Files.Constants.FOLDER_ID_MY_FILES==""){ASC.Files.Folders.navigationSet(ASC.Files.Constants.FOLDER_ID_COMMON_FILES)}else{if(ASC.Files.Folders.currentFolderId!=ASC.Files.Constants.FOLDER_ID_MY_FILES){ASC.Files.Folders.navigationSet(ASC.Files.Constants.FOLDER_ID_MY_FILES)}}}else{if(ASC.Files.Folders.currentFolderId!=ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT){ASC.Files.Folders.navigationSet(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT)}}};var q=function(G,E){var F=ASC.Files.Filter.getFilterSettings();serviceManager.getFolderItems(ASC.Files.TemplateManager.events.GetFolderItems,{folderId:ASC.Files.Folders.currentFolderId,from:(G?jq("#files_mainContent li.fileRow[name!='addRow']").length:0),count:E||ASC.Files.Constants.COUNT_ON_PAGE,append:G===true,filter:F.filter,subject:F.subject,text:F.text,compactView:jq("#files_mainContent").hasClass("compact")},{orderBy:F.sorter})};var d=function(E){if(ASC.Files.Folders.folderContainer=="trash"){return}ASC.Files.Folders.navigationSet(E)};var c=function(E,I,F,G){if(ASC.Files.Folders.folderContainer=="trash"){return}if(ASC.Files.Share){ASC.Files.Share.removeNewIcon("file",E)}F=F||ASC.Files.UI.getEntryTitle("file",E);var H=ASC.Files.Utility.GetFileViewUrl(E,I);if(ASC.Files.Utility.CanWebView(F)){H=ASC.Files.Utility.GetFileWebViewerUrl(E,I)+(G?"&new=true":"");window.open(H,"_blank");return}if(typeof ASC.Files.ImageViewer!="undefined"&&ASC.Files.Utility.CanImageView(F)){H=ASC.Files.ImageViewer.getPreviewUrl(E);ASC.Controls.AnchorController.move(H);return}if(jq.browser.mobile){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_MobileDownload,true)}else{window.open(H,"_blank")}};var l=function(G,F,J){var I=new Array();if(!ASC.Files.Common.isCorrectId(F)){I=jq("#files_mainContent li.fileRow:has(div.checkbox input:checked)");if(I.length==0){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.EmptyListSelectedForDownload,true);return}if(I.length==1){var H=ASC.Files.UI.getObjectData(I[0]);F=H.entryId;G=H.entryType}}if(G==="file"){if(jq.browser.mobile){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_MobileDownload,true);return}if(ASC.Files.Share){ASC.Files.Share.removeNewIcon(G,F)}location.href=ASC.Files.Utility.GetFileDownloadUrl(F,J);return}if(ASC.Files.Folders.bulkStatuses==true){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SecondDownload,true);return}var E={};E.entry=new Array();if(ASC.Files.Common.isCorrectId(F)){E.entry.push(Encoder.htmlEncode(G+"_"+F));if(ASC.Files.Share){ASC.Files.Share.removeNewIcon(G,F)}}else{I.each(function(){var K=ASC.Files.UI.getObjectData(this);E.entry.push(Encoder.htmlEncode(K.entryType+"_"+K.entryId));if(ASC.Files.Share){ASC.Files.Share.removeNewIcon(K.entryType,K.entryId)}})}ASC.Files.Folders.bulkStatuses=true;serviceManager.download(ASC.Files.TemplateManager.events.Download,{doNow:true},{stringList:E})};var f=function(){if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=f;ASC.Files.Folders.defaultFolderSet();return}jq(document).scrollTop(0);var L=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");if(L.length!=0){return}var F={folder:{id:1,spare_data:"NEW_FOLDER",title:ASC.Files.FilesJSResources.TitleNewFolder,access:0,shared:false,isnew:false,shareable:false}};var O=serviceManager.jsonToXml(F);var E=ASC.Files.TemplateManager.templates.getFolderItem;var P=ASC.Files.TemplateManager.getTemplate(E);try{var I=ASC.Controls.XSLTManager.translateFromString(O,P)}catch(G){return undefined}ASC.Files.EmptyScreen.hideEmptyScreen();var J=jq("#files_mainContent");J.prepend(I);jq("#files_mainContent li.newFolder").yellowFade().removeClass("newFolder");ASC.Files.UI.paintRows();L=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");L.addClass("rowRename");var M=L.find("div.entryTitle a.name");var H=ASC.Files.Utility.getFolderCssClass();L.find(".thumb-folder").addClass(H);var K=document.createElement("input");K.id="files_prompt_create_folder";K.type="text";K.style.display="none";document.body.appendChild(K);K=jq("#files_prompt_create_folder");K.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH);K.addClass("textEdit renameInput");K.val(ASC.Files.FilesJSResources.TitleNewFolder);K.insertAfter(M);K.show();M.hide();K.focus();if(!jq.browser.mobile){K.select()}ASC.Files.UI.checkCharacter(K);var N=function(){var Q=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");var R=ASC.Files.Common.replaceSpecCharacter(jq("#files_prompt_create_folder").val().trim());if(R==""||R==null){R=ASC.Files.FilesJSResources.TitleNewFolder}Q.find("div.entryTitle a.name").show().text(R);Q.removeClass("rowRename");jq("#files_prompt_create_folder").remove();Q.find("div.renameAction").remove();var S={parentFolderID:ASC.Files.Folders.currentFolderId,title:R};ASC.Files.UI.blockObject(Q,true,ASC.Files.FilesJSResources.DescriptCreate);serviceManager.createFolder(ASC.Files.TemplateManager.events.CreateFolder,S)};L.append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.FilesJSResources.TitleCreate+"></div><div class='cancelName' title="+ASC.Files.FilesJSResources.TitleCancel+"></div></div>");L.find("div.apllyName").click(N);L.find("div.cancelName").click(function(){var Q=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");Q.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}else{ASC.Files.UI.paintRows()}});jq("#files_prompt_create_folder").keypress(function(S){if(jq("#files_prompt_create_folder").length==0){return}if(!R){var R=S}var Q=R.keyCode||R.which;switch(Q){case ASC.Files.Common.keyCode.esc:var T=ASC.Files.UI.getEntryObject("folder",1).filter("[spare_data='NEW_FOLDER']");T.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}else{ASC.Files.UI.paintRows()}break;case ASC.Files.Common.keyCode.enter:N();break}})};var g=function(){jq(document).scrollTop(0);if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=g;ASC.Files.Folders.defaultFolderSet();return}var M=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");M.remove();var Q;switch(ASC.Files.Folders.typeNewDoc){case"document":Q=ASC.Files.FilesJSResources.TitleNewFileText+ASC.Files.Constants.typeNewDoc.document;break;case"spreadsheet":Q=ASC.Files.FilesJSResources.TitleNewFileSpreadsheet+ASC.Files.Constants.typeNewDoc.spreadsheet;break;case"presentation":Q=ASC.Files.FilesJSResources.TitleNewFilePresentation+ASC.Files.Constants.typeNewDoc.presentation;break;case"image":Q=ASC.Files.FilesJSResources.TitleNewFileImage+ASC.Files.Constants.typeNewDoc.image;break;default:return}if(!ASC.Files.Utility.CanWebEdit(Q)){return}var F={file:{id:1,spare_data:"NEW_FILE",title:Q,access:0,shared:false,version:0}};var P=serviceManager.jsonToXml(F);var E=ASC.Files.TemplateManager.templates.getFolderItem;var R=ASC.Files.TemplateManager.getTemplate(E);try{var I=ASC.Controls.XSLTManager.translateFromString(P,R)}catch(G){return undefined}ASC.Files.EmptyScreen.hideEmptyScreen();var K=jq("#files_mainContent");K.prepend(I);jq("#files_mainContent li.newFile").show().yellowFade().removeClass("newFile");ASC.Files.UI.paintRows();M=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");M.addClass("rowRename");var N=M.find("div.entryTitle a.name");var H=ASC.Files.Utility.getCssClassByFileTitle(Q);M.find(".thumb-file").addClass(H);var J=ASC.Files.Utility.GetFileExtension(Q).length;Q=Q.substring(0,Q.length-J);var L=document.createElement("input");L.id="files_prompt_create_file";L.type="text";L.style.display="none";document.body.appendChild(L);L=jq("#files_prompt_create_file");L.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH-J);L.addClass("textEdit renameInput");L.val(Q);L.insertAfter(N);L.show().focus();if(!jq.browser.mobile){L.select()}ASC.Files.UI.checkCharacter(L);var O=function(){var T=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");var U=ASC.Files.Common.replaceSpecCharacter(jq("#files_prompt_create_file").val().trim());var V=ASC.Files.UI.getObjectTitle(T);if(U==""||U==null){U=V}else{var S=ASC.Files.Utility.GetFileExtension(V).length;U+=V.substring(V.length-S)}T.find("div.entryTitle a.name").show().text(U);T.removeClass("rowRename");jq("#files_prompt_create_file").remove();T.find("div.renameAction").remove();var W={folderID:ASC.Files.Folders.currentFolderId,fileTitle:U};ASC.Files.UI.blockObject(M,true,ASC.Files.FilesJSResources.DescriptCreate);serviceManager.createNewFile(ASC.Files.TemplateManager.events.CreateNewFile,W)};M.append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.FilesJSResources.TitleCreate+"></div><div class='cancelName' title="+ASC.Files.FilesJSResources.TitleCancel+"></div></div>");M.find("div.apllyName").click(O);M.find("div.cancelName").click(function(){var S=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");S.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}else{ASC.Files.UI.paintRows()}});jq("#files_prompt_create_file").keypress(function(U){if(jq("#files_prompt_create_file").length==0){return}if(!T){var T=U}var S=T.keyCode||T.which;switch(S){case ASC.Files.Common.keyCode.esc:var V=ASC.Files.UI.getEntryObject("file",1).filter("[spare_data='NEW_FILE']");V.remove();if(jq("#files_mainContent li.fileRow").length==0){ASC.Files.EmptyScreen.displayEmptyScreen()}else{ASC.Files.UI.paintRows()}break;case ASC.Files.Common.keyCode.enter:O();break}})};var x=function(H,E){var F=ASC.Files.UI.getEntryObject(H,E);var I=0;if(jq("#files_prompt_rename").length!=0){jq("#files_mainContent li.fileRow.rowRename div.cancelName").click()}F.addClass("rowRename");ASC.Files.UI.selectRow(F,false);ASC.Files.UI.updateMainContentHeader();var G=ASC.Files.UI.getObjectTitle(F);if(H=="file"){I=ASC.Files.Utility.GetFileExtension(G).length;G=G.substring(0,G.length-I)}var J=document.createElement("input");J.id="files_prompt_rename";J.type="text";J.style.display="none";document.body.appendChild(J);J=jq("#files_prompt_rename");J.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH-I);J.addClass("textEdit renameInput");J.val(G);J.insertAfter(F.find("div.entryTitle a.name"));J.show().focus();if(!jq.browser.mobile){J.select()}ASC.Files.UI.checkCharacter(J);var K=function(){var L=ASC.Files.UI.getObjectData(jq("#files_prompt_rename"));var N=L.entryObject;var O=L.entryType;var M=L.entryId;var R=ASC.Files.UI.getObjectTitle(N);var Q=ASC.Files.Common.replaceSpecCharacter(jq("#files_prompt_rename").val().trim());if(Q==""||Q==null){return}if(O=="file"){var P=ASC.Files.Utility.GetFileExtension(R).length;Q+=R.substring(R.length-P)}N.find("div.entryTitle a.name").show().text(Q);N.removeClass("rowRename");jq("#files_prompt_rename").remove();N.find(".renameAction").remove();if(Q!=R){ASC.Files.UI.blockObject(N,true,ASC.Files.FilesJSResources.DescriptRename);if(O=="file"){serviceManager.renameFile(ASC.Files.TemplateManager.events.FileRename,{fileId:M,name:R,newname:Q,show:true})}else{serviceManager.renameFolder(ASC.Files.TemplateManager.events.FolderRename,{folderId:M,name:R,newname:Q})}}};F.append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.FilesJSResources.TitleRename+"></div><div class='cancelName' title="+ASC.Files.FilesJSResources.TitleCancel+"></div></div>");F.find("div.apllyName").click(K);F.find("div.cancelName").click(function(){var L=jq("#files_prompt_rename").closest("li.fileRow");jq("#files_prompt_rename").remove();L.removeClass("rowRename");L.find(".renameAction").remove()});F.removeClass("row-selected user_select_none");jq("#files_prompt_rename").keypress(function(O){if(jq("#files_prompt_rename").length===0){return}if(!M){var M=O}var L=M.keyCode||M.which;if((L==ASC.Files.Common.keyCode.esc||L==ASC.Files.Common.keyCode.enter)&&jq("#files_prompt_rename").length!=0){switch(L){case ASC.Files.Common.keyCode.esc:var N=jq("#files_prompt_rename").closest("li.fileRow");jq("#files_prompt_rename").remove();N.removeClass("rowRename");N.find(".renameAction").remove();break;case ASC.Files.Common.keyCode.enter:K();break}}})};var A=function(G,F){if(ASC.Files.Folders.folderContainer=="trash"){return}G=jq(G);if(!G.is("li.fileRow")){G=G.closest("li.fileRow")}if(G.hasClass("folderRow")){return}if(G.find("div.version").length==0){return}if(jq("#content_versions:visible").length!=0){var E=G.find("#content_versions").length!=0;e();if(E){return}}ASC.Files.UI.blockObject(G,true,ASC.Files.FilesJSResources.DescriptLoadVersion);F=F||ASC.Files.UI.getObjectData(G).entryId;serviceManager.getFileHistory(ASC.Files.TemplateManager.events.GetFileHistory,{fileId:F},{})};var u=function(E,F){jq("div.version_operation").css("visibility","hidden");ASC.Files.UI.blockObjectById("file",E,true,ASC.Files.FilesJSResources.DescriptSetVersion);serviceManager.setCurrentVersion(ASC.Files.TemplateManager.events.SetCurrentVersion,{fileId:E,version:F})};var e=function(){jq("#content_versions").remove();jq("#files_mainContent .row-over").removeClass("row-over")};var y=function(E,F){serviceManager.getFile(ASC.Files.TemplateManager.events.ReplaceVersion,{fileId:E,show:F,isStringXml:false})};var p=function(){serviceManager.getFolderInfo(ASC.Files.TemplateManager.events.GetFolderInfo,{folderId:ASC.Files.Folders.currentFolderId})};var h=function(F,G,H){var J=typeof ASC.Files.ThirdParty!="undefined";var I=J&&(ASC.Files.Folders.isCopyTo==true||ASC.Files.ThirdParty.isThirdParty());if(F===ASC.Files.Folders.currentFolderId){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.isCopyTo=false;return}var E={};E.entry=new Array();jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):has(div.checkbox input:checked)").each(function(){var K=ASC.Files.UI.getObjectData(this);var N=K.entryType;var M=K.entryObject;var L=K.entryId;if(ASC.Files.Folders.isCopyTo==true||(ASC.Files.UI.accessAdmin(M)&&!ASC.Files.UI.editingFile(M))){if(jq.inArray(L,H)!=-1){ASC.Files.UI.displayInfoPanel(((ASC.Files.Folders.isCopyTo==true)?ASC.Files.FilesJSResources.InfoFolderCopyError:ASC.Files.FilesJSResources.InfoFolderMoveError),true)}else{if(I||!J||!ASC.Files.ThirdParty.isThirdParty(M)){ASC.Files.UI.blockObject(M,true,(ASC.Files.Folders.isCopyTo==true)?ASC.Files.FilesJSResources.DescriptCopy:ASC.Files.FilesJSResources.DescriptMove);E.entry.push(Encoder.htmlEncode(N+"_"+L))}}}});ASC.Files.Actions.hideAllActionPanels();if(E.entry&&E.entry.length!=0){serviceManager.moveFilesCheck(ASC.Files.TemplateManager.events.MoveFilesCheck,{folderToTitle:G,folderToId:F,list:E,isCopyOperation:(ASC.Files.Folders.isCopyTo==true)},{stringList:E})}ASC.Files.Folders.isCopyTo=false};var z=function(){if(jq("#files_pageNavigatorHolder:visible").length==0||jq("#files_pageNavigatorHolder a").text()==ASC.Files.FilesJSResources.ButtonShowMoreLoad){return}jq("#files_pageNavigatorHolder a").text(ASC.Files.FilesJSResources.ButtonShowMoreLoad);ASC.Files.Folders.getFolderItems(true)};var m=function(){if(ASC.Files.Folders.folderContainer!="trash"){return}ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.checkSelectAll(true);jq("#confirmRemoveText").html("<b>"+ASC.Files.FilesJSResources.ConfirmEmptyTrash+"</b>");jq("#confirmRemoveList").hide();jq("#confirmRemoveTextDescription").show();jq("#removeConfirmBtn").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog();serviceManager.emptyTrash(ASC.Files.TemplateManager.events.EmptyTrash,{doNow:true})});ASC.Files.Common.blockUI(jq("#files_confirm_remove"),420,0,-150);PopupKeyUpActionProvider.EnterAction='jq("#removeConfirmBtn").click();'};var k=function(I,F){if(ASC.Files.Folders.folderContainer=="forme"&&ASC.Files.Share){ASC.Files.Share.unSubscribeMe(I,F);return}if(!ASC.Files.UI.accessibleItem()){return}ASC.Files.Actions.hideAllActionPanels();var E=ASC.Files.FilesJSResources.ConfirmRemoveList;var K=new Array();if(I&&F){var G=ASC.Files.UI.getEntryObject(I,F);if(!ASC.Files.UI.accessAdmin(G)){return}if(ASC.Files.UI.editingFile(G)){return}K.push({entryType:I,entryId:F})}else{jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):has(div.checkbox input:checked)").each(function(){var O=ASC.Files.UI.getObjectData(this);var Q=O.entryObject;var R=O.entryType;var P=O.entryId;if(ASC.Files.ThirdParty&&!ASC.Files.ThirdParty.isThirdParty()&&ASC.Files.ThirdParty.isThirdParty(O.entryObject)){return true}if(!ASC.Files.UI.editingFile(Q)&&ASC.Files.UI.accessAdmin(Q)){K.push({entryType:R,entryId:P})}})}if(K.length==0){return}if(K.length==1){if(K[0].entryType=="file"){E=ASC.Files.FilesJSResources.ConfirmRemoveFile}else{E=ASC.Files.FilesJSResources.ConfirmRemoveFolder}}var N="";var M="";var L="<label title='{0}'><input type='checkbox' entryType='{1}' entryId='{2}' checked='checked'>{0}</label>";for(var J=0;J<K.length;J++){var H=ASC.Files.UI.getEntryTitle(K[J].entryType,K[J].entryId);if(K[J].entryType=="file"){M+=L.format(H,K[J].entryType,K[J].entryId)}else{N+=L.format(H,K[J].entryType,K[J].entryId)}}jq("#confirmRemoveText").html("<b>"+E+"</b>");jq("#confirmRemoveList dd.confirmRemoveFiles").html(M);jq("#confirmRemoveList dd.confirmRemoveFolders").html(N);jq("#confirmRemoveList .confirmRemoveFolders, #confirmRemoveList .confirmRemoveFiles").show();if(N==""){jq("#confirmRemoveList .confirmRemoveFolders").hide()}if(M==""){jq("#confirmRemoveList .confirmRemoveFiles").hide()}if(ASC.Files.Folders.folderContainer=="trash"||ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT!=""||(ASC.Files.ThirdParty&&ASC.Files.ThirdParty.isThirdParty())){jq("#confirmRemoveTextDescription").show()}else{jq("#confirmRemoveTextDescription").hide()}jq("#removeConfirmBtn").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog();var O={};var T=jq("#confirmRemoveList input:checked");if(T.length==0){return}O.entry=new Array();for(var S=0;S<T.length;S++){var R=jq(T[S]).attr("entryType");var P=jq(T[S]).attr("entryId");var Q=ASC.Files.UI.getEntryObject(R,P);ASC.Files.UI.blockObject(Q,true,ASC.Files.FilesJSResources.DescriptRemove);O.entry.push(Encoder.htmlEncode(R+"_"+P))}serviceManager.deleteItem(ASC.Files.TemplateManager.events.DeleteItem,{list:O.entry,doNow:true},{stringList:O})});ASC.Files.Common.blockUI(jq("#files_confirm_remove"),420,0,-150);PopupKeyUpActionProvider.EnterAction='jq("#removeConfirmBtn").click();'};var b=function(){ASC.Files.Folders.bulkStatuses=false;jq("#files_tasks .progress").css("width","0%");jq("#files_tasks .percent").text("0%");jq("#files_tasks .headerBaseMedium").html("");jq("#files_tasks").hide()};var C=function(E){clearTimeout(ASC.Files.Folders.tasksTimeout);serviceManager.terminateTasks(ASC.Files.TemplateManager.events.TerminateTasks,{isImport:E,isTerminate:true,doNow:true})};var r=function(E){clearTimeout(ASC.Files.Folders.tasksTimeout);ASC.Files.Folders.tasksTimeout=setTimeout(function(){serviceManager.getTasksStatuses(ASC.Files.TemplateManager.events.GetTasksStatuses,{doNow:false})},ASC.Files.Constants.REQUEST_STATUS_DELAY/(E===true?2:1))};return{eventAfter:n,currentFolderId:i,navigationSet:w,defaultFolderSet:j,moveToFolder:v,isCopyTo:s,createFolder:f,getFolderInfo:p,replaceVersion:y,showVersions:A,makeCurrentVersion:u,closeVersions:e,curItemFolderMoveTo:h,rename:x,deleteItem:k,emptyTrash:m,getFolderItems:q,folderContainer:o,clickOnFolder:d,clickOnFile:c,showMore:z,createNewDoc:g,typeNewDoc:D,download:l,getTasksStatuses:r,cancelTasksStatuses:b,terminateTasks:C,tasksTimeout:B,bulkStatuses:a}})();(function(a){a(function(){jq("#files_pageNavigatorHolder a").click(function(){ASC.Files.Folders.showMore();return false});jq("#topNewFolder a").click(function(){ASC.Files.Folders.createFolder()});jq("#files_cancelUpload").click(function(){PopupKeyUpActionProvider.CloseDialog()});jq("#files_deleteButton, #files_mainDelete").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem()});jq("#files_emptyTrashButton, #files_mainEmptyTrash").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.emptyTrash()});jq("#files_downloadButton, #files_mainDownload").click(function(){if(jq(this).is("#files_mainDownload")&&!jq(this).is(".unlockAction")){return}ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download()});jq("#files_selectAll_check").click(function(){ASC.Files.UI.checkSelectAll(jq("#files_selectAll_check").is(":checked")==true);jq(this).blur()});jq("#files_mainContent").on("click","div.version",function(){ASC.Files.Folders.showVersions(this);return false});jq("#files_mainContent").on("click","li.fileRow:not(.folderRow):not([spare_data]) div.entryTitle a.name, li.fileRow:not(.folderRow):not([spare_data]) div.thumb-file",function(){var b=ASC.Files.UI.getObjectData(this);var d=b.entryObject;var c=b.id;var e=b.title;var f=d.hasClass("isNewForWebEditor");ASC.Files.Folders.clickOnFile(c,null,e,f);d.removeClass("isNewForWebEditor");return false});jq("#files_mainContent").on("click","li.folderRow:not(.errorEntry):not([spare_data]) div.entryTitle a.name, li.folderRow:not(.errorEntry):not([spare_data]) div.thumb-folder",function(){var b=ASC.Files.UI.getObjectData(this).id;ASC.Files.Folders.clickOnFolder(b);return false});jq("#files_mainContent").on("mouseover","#content_versions .versionRow",function(){jq("#content_versions .actionRow").removeClass("actionRow");jq(this).addClass("actionRow")});jq("#files_mainContent").on("mouseout","#content_versions .versionRow.actionRow",function(){jq(this).removeClass("actionRow")});jq("#files_mainContent").on("click","#content_versions .previewVersion",function(){var b=ASC.Files.UI.getObjectData(this);var c=b.id;var d=b.title;var e=jq(this).closest(".versionRow").attr("data-version");ASC.Files.Folders.clickOnFile(c,e,d);return false});jq("#files_mainContent").on("click","#content_versions .downloadVersion",function(){var b=ASC.Files.UI.getObjectData(this).id;var c=jq(this).closest(".versionRow").attr("data-version");ASC.Files.Folders.download("file",b,c);return false});jq("#files_mainContent").on("click","#content_versions .version_restore",function(){var b=ASC.Files.UI.getObjectData(this).id;var c=jq(this).closest(".versionRow").attr("data-version");ASC.Files.Folders.makeCurrentVersion(b,c);return false});if(typeof ASC.Files.Share=="undefined"){jq("#files_shareaccess_folders, #files_shareaccess_files,                #files_unsubscribe_files, #files_unsubscribe_folders").remove()}jq(window).scroll(function(){ASC.Files.UI.toggleMainMenu();if(jq(document).height()-jq(window).height()<=jq(window).scrollTop()+350){ASC.Files.Folders.showMore()}return true});LoadingBanner.displayLoading(true)})})(jQuery);window.serviceManager=(function(){var isInit=false,servicePath="",cmdSeparator="/",requestTimeout=60*1000,customEvents={};var check_ready=true;var ajax_stek=new Array();var init=function(path){if(typeof path!=="string"||path.length===0){throw"incorrect service path"}if(isInit===false){isInit=true;servicePath=path[path.length-1]==="/"?path:path+"/"}};var getRandomId=function(prefix){return(typeof prefix!=="undefined"?prefix+"-":"")+Math.floor(Math.random()*1000000)};var getUniqueId=function(o,prefix){var iterCount=0,maxIterations=1000,uniqueId=getRandomId();while(o.hasOwnProperty(uniqueId)&&iterCount++<maxIterations){uniqueId=getRandomId(prefix)}return uniqueId};var jsonToXml=function(o,parent){var attr="",xml="";if(typeof o==="object"){if(o.constructor.toString().indexOf("Array")!==-1){var n;for(i=0,n=o.length;i<n;i++){xml+="<"+parent+">"+o[i]+"</"+parent+">"}}else{for(var i in o){if(i.charAt(0)==="_"){attr+=" "+i.substring(1)+'="'+o[i]+'"'}else{xml+=arguments.callee(o[i],i)}}if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}}else{if(typeof o==="string"){xml=o;if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}else{if(typeof o!=="undefined"&&typeof o.toString!=="undefined"){xml=o.toString();if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}}}return xml};var execCustomEvent=function(eventType,thisArg,argsArray){eventType=eventType.toLowerCase();thisArg=thisArg||window;argsArray=argsArray||[];if(!customEvents.hasOwnProperty(eventType)){return undefined}var customEvent=customEvents[eventType];for(var eventId in customEvent){if(customEvent.hasOwnProperty(eventId)){customEvent[eventId].handler.apply(thisArg,argsArray);if(customEvent[eventId].type&1){delete customEvent[eventId]}}}};var addCustomEvent=function(eventType,handler,params){if(typeof eventType!=="string"||typeof handler!=="function"){return undefined}eventType=eventType.toLowerCase();if(typeof params!=="object"){params={}}var isOnceExec=params.hasOwnProperty("once")?params.once:false;var handlerType=0;handlerType|=+isOnceExec*1;if(!customEvents.hasOwnProperty(eventType)){customEvents[eventType]={}}var eventId=getUniqueId(customEvents[eventType]);customEvents[eventType][eventId]={handler:handler,type:handlerType};return eventId};var removeCustomEvent=function(eventType,eventId){if(typeof eventType!=="string"||typeof eventId==="undefined"){return false}if(customEvents(eventType)&&customEvents[eventType].hasOwnProperty(eventId)){delete userEventHandlers[eventType][eventId]}return true};var getUrl=function(){var i,n,url=servicePath;if(arguments.length===0){return url}for(i=0,n=arguments.length-1;i<n;i++){url+=arguments[i]+cmdSeparator}var res=url+arguments[i];var now=new Date();if(res.search(/\?/)>0){res+="&_="+now.getTime()}else{res+="?_="+now.getTime()}return res};var getNodeContent=function(o){if(!o||typeof o!=="object"){return""}return o.text||o.textContent||(function(o){var result="",childrens=o.childNodes;if(!childrens){return result}for(var i=0,n=childrens.length;i<n;i++){var child=childrens.item(i);switch(child.nodeType){case 1:case 5:result+=arguments.callee(child);break;case 3:case 2:case 4:result+=child.nodeValue;break;default:break}}return result})(o)};var completeRequest=function(eventType,params,dataType,xmlHttpRequest,textStatus){check_ready=true;if(typeof LoadingBanner!="undefined"&&typeof LoadingBanner.hideLoading!="undefined"){LoadingBanner.hideLoading()}if(textStatus==="error"){var errorMessage="",commentMessage="",messageNode=null,innerNode=null;innerMessageNode=null;if(xmlHttpRequest.responseXML){messageNode=xmlHttpRequest.responseXML.getElementsByTagName("message")[0];innerNode=xmlHttpRequest.responseXML.getElementsByTagName("inner")[0];if(innerNode){innerMessageNode=innerNode.getElementsByTagName("message")[0]}if(errorMessage===""){try{errorMessage=eval("["+xmlHttpRequest.responseText+"]")[0].Detail}catch(e){var div=document.createElement("div");errorMessage=jq("#content",jq(div).html(xmlHttpRequest.responseText)).text()}}}else{if(xmlHttpRequest.responseText){var div=document.createElement("div");errorMessage=jq("#content",jq(div).html(xmlHttpRequest.responseText)).text();if(errorMessage===""){try{errorMessage=eval("["+xmlHttpRequest.responseText+"]")[0].Detail}catch(e){}}}}if(messageNode&&typeof messageNode==="object"){errorMessage=getNodeContent(messageNode)}if(innerMessageNode&&typeof innerMessageNode==="object"){commentMessage=getNodeContent(innerMessageNode)}execCustomEvent(eventType,window,[undefined,params,errorMessage,commentMessage]);return undefined}var data;try{switch(dataType){case"xml":data=ASC.Controls.XSLTManager.createXML(xmlHttpRequest.responseText);break;case"json":data=jq.parseJSON(xmlHttpRequest.responseText);break;default:data=ASC.Controls.XSLTManager.createXML(xmlHttpRequest.responseXML.xml)||jq.parseJSON(xmlHttpRequest.responseText)}}catch(e){data=xmlHttpRequest.responseText}execCustomEvent(eventType,window,[data,params]);if(ajax_stek.length!=0&&check_ready==true){var req=ajax_stek.shift();check_ready=false;execAjax(req)}};var getCompleteCallbackMethod=function(eventType,params,dataType){return function(){var argsArray=[eventType,params,dataType];for(var i=0,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}completeRequest.apply(this,argsArray)}};var request=function(type,dataType,eventType,params){if(typeof type==="undefined"||typeof dataType==="undefined"||typeof eventType!=="string"){return undefined}if(typeof LoadingBanner=="undefined"||typeof LoadingBanner.displayLoading=="undefined"){params.showLoading=false}var data={},argsArray=[];var contentType=(params.ajaxcontentType||"text/xml");if(typeof params!=="object"){params={}}switch(type.toLowerCase()){case"delete":case"get":for(var i=4,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}break;case"post":data=(contentType=="text/xml"?jsonToXml(arguments[4]):arguments[4]);for(var i=5,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}break;default:return undefined}var req={async:(params.ajaxsync!=true),data:data,type:type,dataType:dataType,contentType:contentType,mimeType:"text/xml",cache:true,url:getUrl.apply(this,argsArray),timeout:requestTimeout,beforeSend:params.showLoading?LoadingBanner.displayLoading():null,complete:getCompleteCallbackMethod(eventType,params,dataType)};if(ajax_stek.length==0&&check_ready==true){check_ready=false;execAjax(req)}else{ajax_stek.push(req)}};var execAjax=function(req){jq.ajax({async:req.async,data:req.data,type:req.type,dataType:req.dataType,contentType:req.contentType,cache:req.cache,url:req.url,timeout:req.timeout,beforeSend:req.beforeSend,complete:req.complete})};var createFolder=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders","create?parentId="+encodeURIComponent(params.parentFolderID)+"&title="+encodeURIComponent(params.title))};var getFolderInfo=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders","info?folderId="+encodeURIComponent(params.folderId))};var getFile=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders","files","lastversion?fileId="+encodeURIComponent(params.fileId))};var getFolderItems=function(eventType,params,data){params.showLoading=params.append!=true;request("post","xml",eventType,params,data,"folders?parentId="+encodeURIComponent(params.folderId)+"&from="+params.from+"&count="+params.count+"&filter="+params.filter+"&subjectID="+params.subject+"&compactView="+params.compactView+"&search="+encodeURIComponent(params.text))};var renameFolder=function(eventType,params){request("get","xml",eventType,params,"folders","rename?folderId="+encodeURIComponent(params.folderId)+"&title="+encodeURIComponent(params.newname))};var renameFile=function(eventType,params){request("get","xml",eventType,params,"folders","files","rename?fileId="+encodeURIComponent(params.fileId)+"&title="+encodeURIComponent(params.newname))};var deleteItem=function(eventType,params,data){request("post","json",eventType,params,data,"folders","files?action=delete")};var emptyTrash=function(eventType,params){request("get","json",eventType,params,"emptytrash")};var getFileHistory=function(eventType,params,data){request("post","xml",eventType,params,data,"folders","files","history?fileId="+encodeURIComponent(params.fileId))};var moveItems=function(eventType,params,data){request("post","json",eventType,params,data,"moveorcopy?destFolderId="+encodeURIComponent(params.folderToId)+"&ow="+(params.overwrite==true)+"&ic="+(params.isCopyOperation==true))};var moveFilesCheck=function(eventType,params,data){request("post","json",eventType,params,data,"folders","files","moveOrCopyFilesCheck?destFolderId="+encodeURIComponent(params.folderToId))};var download=function(eventType,params,data){params.showLoading=true;request("post","json",eventType,params,data,"bulkdownload")};var terminateTasks=function(eventType,params){request("get","json",eventType,params,"tasks?terminate="+params.isImport)};var getTasksStatuses=function(eventType,params){request("get","json",eventType,params,"tasks","statuses")};var setCurrentVersion=function(eventType,params){request("get","xml",eventType,params,"folders","files","updateToVersion?fileId="+encodeURIComponent(params.fileId)+"&version="+params.version)};var createNewFile=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders","files","createfile?parentId="+encodeURIComponent(params.folderID)+"&title="+encodeURIComponent(params.fileTitle))};var trackEditFile=function(eventType,params){request("get","json",eventType,params,"trackeditfile?fileID="+params.fileID+"&docKeyForTrack="+params.docKeyForTrack+"&isFinish="+(params.finish==true)+params.shareLink)};var checkEditing=function(eventType,params,data){request("post","json",eventType,params,data,"checkediting")};var canEditFile=function(eventType,params){request("get","json",eventType,params,"canedit?fileId="+encodeURIComponent(params.fileID)+params.shareLink)};return{init:init,bind:addCustomEvent,unbind:removeCustomEvent,jsonToXml:jsonToXml,request:request,createFolder:createFolder,createNewFile:createNewFile,getFile:getFile,getFolderInfo:getFolderInfo,getFolderItems:getFolderItems,renameFolder:renameFolder,renameFile:renameFile,deleteItem:deleteItem,emptyTrash:emptyTrash,download:download,terminateTasks:terminateTasks,getFileHistory:getFileHistory,setCurrentVersion:setCurrentVersion,moveFilesCheck:moveFilesCheck,moveItems:moveItems,getTasksStatuses:getTasksStatuses,trackEditFile:trackEditFile,checkEditing:checkEditing,canEditFile:canEditFile}})();var swfobject=function(){var ae="undefined",aG="object",aJ="Shockwave Flash",aR="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",aH="SWFObjectExprInst",aS="onreadystatechange",aB=window,ap=document,aK=navigator,aL=false,aN=[al],aA=[],az=[],ao=[],au,aF,ag,aa,aq=false,X=false,ay,ak,aw=true,ax=function(){var a=typeof ap.getElementById!=ae&&typeof ap.getElementsByTagName!=ae&&typeof ap.createElement!=ae,h=aK.userAgent.toLowerCase(),j=aK.platform.toLowerCase(),e=j?/win/.test(j):/win/.test(h),c=j?/mac/.test(j):/mac/.test(h),f=/webkit/.test(h)?parseFloat(h.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,i=!+"\v1",g=[0,0,0],b=null;if(typeof aK.plugins!=ae&&typeof aK.plugins[aJ]==aG){b=aK.plugins[aJ].description;if(b&&!(typeof aK.mimeTypes!=ae&&aK.mimeTypes[aE]&&!aK.mimeTypes[aE].enabledPlugin)){aL=true;i=false;b=b.replace(/^.*\s+(\S+\s+\S+$)/,"$1");g[0]=parseInt(b.replace(/^(.*)\..*$/,"$1"),10);g[1]=parseInt(b.replace(/^.*\.(.*)\s.*$/,"$1"),10);g[2]=/[a-zA-Z]/.test(b)?parseInt(b.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof aB.ActiveXObject!=ae){try{var d=new ActiveXObject(aR);if(d){b=d.GetVariable("$version");if(b){i=true;b=b.split(" ")[1].split(",");g=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)]}}}catch(k){}}}return{w3:a,pv:g,wk:f,ie:i,win:e,mac:c}}(),ar=function(){if(!ax.w3){return}if((typeof ap.readyState!=ae&&ap.readyState=="complete")||(typeof ap.readyState==ae&&(ap.getElementsByTagName("body")[0]||ap.body))){ah()}if(!aq){if(typeof ap.addEventListener!=ae){ap.addEventListener("DOMContentLoaded",ah,false)}if(ax.ie&&ax.win){ap.attachEvent(aS,function(){if(ap.readyState=="complete"){ap.detachEvent(aS,arguments.callee);ah()}});if(aB==top){(function(){if(aq){return}try{ap.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}ah()})()}}if(ax.wk){(function(){if(aq){return}if(!/loaded|complete/.test(ap.readyState)){setTimeout(arguments.callee,0);return}ah()})()}aI(ah)}}();function ah(){if(aq){return}try{var d=ap.getElementsByTagName("body")[0].appendChild(ac("span"));d.parentNode.removeChild(d)}catch(a){return}aq=true;var b=aN.length;for(var c=0;c<b;c++){aN[c]()}}function at(a){if(aq){a()}else{aN[aN.length]=a}}function aI(b){if(typeof aB.addEventListener!=ae){aB.addEventListener("load",b,false)}else{if(typeof ap.addEventListener!=ae){ap.addEventListener("load",b,false)}else{if(typeof aB.attachEvent!=ae){an(aB,"onload",b)}else{if(typeof aB.onload=="function"){var a=aB.onload;aB.onload=function(){a();b()}}else{aB.onload=b}}}}}function al(){if(aL){aP()}else{am()}}function aP(){var b=ap.getElementsByTagName("body")[0];var a=ac(aG);a.setAttribute("type",aE);var d=b.appendChild(a);if(d){var c=0;(function(){if(typeof d.GetVariable!=ae){var e=d.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ax.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}b.removeChild(a);d=null;am()})()}else{am()}}function am(){var g=aA.length;if(g>0){for(var f=0;f<g;f++){var k=aA[f].id;var b=aA[f].callbackFn;var a={success:false,id:k};if(ax.pv[0]>0){var e=ab(k);if(e){if(ai(aA[f].swfVersion)&&!(ax.wk&&ax.wk<312)){aQ(k,true);if(b){a.success=true;a.ref=aU(k);b(a)}}else{if(aA[f].expressInstall&&Y()){var i={};i.data=aA[f].expressInstall;i.width=e.getAttribute("width")||"0";i.height=e.getAttribute("height")||"0";if(e.getAttribute("class")){i.styleclass=e.getAttribute("class")}if(e.getAttribute("align")){i.align=e.getAttribute("align")}var h={};var j=e.getElementsByTagName("param");var c=j.length;for(var d=0;d<c;d++){if(j[d].getAttribute("name").toLowerCase()!="movie"){h[j[d].getAttribute("name")]=j[d].getAttribute("value")}}aD(i,h,k,b)}else{aC(e);if(b){b(a)}}}}}else{aQ(k,true);if(b){var l=aU(k);if(l&&typeof l.SetVariable!=ae){a.success=true;a.ref=l}b(a)}}}}}function aU(a){var b=null;var c=ab(a);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=ae){b=c}else{var d=c.getElementsByTagName(aG)[0];if(d){b=d}}}return b}function Y(){return !X&&ai("6.0.65")&&(ax.win||ax.mac)&&!(ax.wk&&ax.wk<312)}function aD(a,b,f,h){X=true;ag=h||null;aa={success:false,id:f};var e=ab(f);if(e){if(e.nodeName=="OBJECT"){au=aj(e);aF=null}else{au=e;aF=f}a.id=aH;if(typeof a.width==ae||(!/%$/.test(a.width)&&parseInt(a.width,10)<310)){a.width="310"}if(typeof a.height==ae||(!/%$/.test(a.height)&&parseInt(a.height,10)<137)){a.height="137"}ap.title=ap.title.slice(0,47)+" - Flash Player Installation";var d=ax.ie&&ax.win?"ActiveX":"PlugIn",c="MMredirectURL="+aB.location.toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+ap.title;if(typeof b.flashvars!=ae){b.flashvars+="&"+c}else{b.flashvars=c}if(ax.ie&&ax.win&&e.readyState!=4){var g=ac("div");f+="SWFObjectNew";g.setAttribute("id",f);e.parentNode.insertBefore(g,e);e.style.display="none";(function(){if(e.readyState==4){e.parentNode.removeChild(e)}else{setTimeout(arguments.callee,10)}})()}aM(a,b,f)}}function aC(b){if(ax.ie&&ax.win&&b.readyState!=4){var a=ac("div");b.parentNode.insertBefore(a,b);a.parentNode.replaceChild(aj(b),a);b.style.display="none";(function(){if(b.readyState==4){b.parentNode.removeChild(b)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.replaceChild(aj(b),b)}}function aj(b){var a=ac("div");if(ax.win&&ax.ie){a.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aG)[0];if(e){var c=e.childNodes;if(c){var d=c.length;for(var f=0;f<d;f++){if(!(c[f].nodeType==1&&c[f].nodeName=="PARAM")&&!(c[f].nodeType==8)){a.appendChild(c[f].cloneNode(true))}}}}}return a}function aM(i,g,k){var j,a=ab(k);if(ax.wk&&ax.wk<312){return j}if(a){if(typeof i.id==ae){i.id=k}if(ax.ie&&ax.win){var h="";for(var e in i){if(i[e]!=Object.prototype[e]){if(e.toLowerCase()=="data"){g.movie=i[e]}else{if(e.toLowerCase()=="styleclass"){h+=' class="'+i[e]+'"'}else{if(e.toLowerCase()!="classid"){h+=" "+e+'="'+i[e]+'"'}}}}}var f="";for(var d in g){if(g[d]!=Object.prototype[d]){f+='<param name="'+d+'" value="'+g[d]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+h+">"+f+"</object>";az[az.length]=i.id;j=ab(i.id)}else{var l=ac(aG);l.setAttribute("type",aE);for(var c in i){if(i[c]!=Object.prototype[c]){if(c.toLowerCase()=="styleclass"){l.setAttribute("class",i[c])}else{if(c.toLowerCase()!="classid"){l.setAttribute(c,i[c])}}}}for(var b in g){if(g[b]!=Object.prototype[b]&&b.toLowerCase()!="movie"){af(l,b,g[b])}}a.parentNode.replaceChild(l,a);j=l}}return j}function af(d,b,c){var a=ac("param");a.setAttribute("name",b);a.setAttribute("value",c);d.appendChild(a)}function aT(b){var a=ab(b);if(a&&a.nodeName=="OBJECT"){if(ax.ie&&ax.win){a.style.display="none";(function(){if(a.readyState==4){Z(b)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.removeChild(a)}}}function Z(c){var b=ab(c);if(b){for(var a in b){if(typeof b[a]=="function"){b[a]=null}}b.parentNode.removeChild(b)}}function ab(c){var a=null;try{a=ap.getElementById(c)}catch(b){}return a}function ac(a){return ap.createElement(a)}function an(c,a,b){c.attachEvent(a,b);ao[ao.length]=[c,a,b]}function ai(c){var b=ax.pv,a=c.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return(b[0]>a[0]||(b[0]==a[0]&&b[1]>a[1])||(b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]))?true:false}function aO(c,f,d,b){if(ax.ie&&ax.mac){return}var a=ap.getElementsByTagName("head")[0];if(!a){return}var e=(d&&typeof d=="string")?d:"screen";if(b){ay=null;ak=null}if(!ay||ak!=e){var g=ac("style");g.setAttribute("type","text/css");g.setAttribute("media",e);ay=a.appendChild(g);if(ax.ie&&ax.win&&typeof ap.styleSheets!=ae&&ap.styleSheets.length>0){ay=ap.styleSheets[ap.styleSheets.length-1]}ak=e}if(ax.ie&&ax.win){if(ay&&typeof ay.addRule==aG){ay.addRule(c,f)}}else{if(ay&&typeof ap.createTextNode!=ae){ay.appendChild(ap.createTextNode(c+" {"+f+"}"))}}}function aQ(c,a){if(!aw){return}var b=a?"visible":"hidden";if(aq&&ab(c)){ab(c).style.visibility=b}else{aO("#"+c,"visibility:"+b)}}function av(b){var c=/[\\\"<>\.;]/;var a=c.exec(b)!=null;return a&&typeof encodeURIComponent!=ae?encodeURIComponent(b):b}var ad=function(){if(ax.ie&&ax.win){window.attachEvent("onunload",function(){var c=ao.length;for(var b=0;b<c;b++){ao[b][0].detachEvent(ao[b][1],ao[b][2])}var f=az.length;for(var a=0;a<f;a++){aT(az[a])}for(var e in ax){ax[e]=null}ax=null;for(var d in swfobject){swfobject[d]=null}swfobject=null})}}();return{registerObject:function(b,c,a,e){if(ax.w3&&b&&c){var d={};d.id=b;d.swfVersion=c;d.expressInstall=a;d.callbackFn=e;aA[aA.length]=d;aQ(b,false)}else{if(e){e({success:false,id:b})}}},getObjectById:function(a){if(ax.w3){return aU(a)}},embedSWF:function(b,h,e,g,j,a,k,d,f,c){var i={success:false,id:h};if(ax.w3&&!(ax.wk&&ax.wk<312)&&b&&h&&e&&g&&j){aQ(h,false);at(function(){e+="";g+="";var m={};if(f&&typeof f===aG){for(var o in f){m[o]=f[o]}}m.data=b;m.width=e;m.height=g;var p={};if(d&&typeof d===aG){for(var n in d){p[n]=d[n]}}if(k&&typeof k===aG){for(var l in k){if(typeof p.flashvars!=ae){p.flashvars+="&"+l+"="+k[l]}else{p.flashvars=l+"="+k[l]}}}if(ai(j)){var q=aM(m,p,h);if(m.id==h){aQ(h,true)}i.success=true;i.ref=q}else{if(a&&Y()){m.data=a;aD(m,p,h,c);return}else{aQ(h,true)}}if(c){c(i)}})}else{if(c){c(i)}}},switchOffAutoHideShow:function(){aw=false},ua:ax,getFlashPlayerVersion:function(){return{major:ax.pv[0],minor:ax.pv[1],release:ax.pv[2]}},hasFlashPlayerVersion:ai,createSWF:function(c,b,a){if(ax.w3){return aM(c,b,a)}else{return undefined}},showExpressInstall:function(d,a,b,c){if(ax.w3&&Y()){aD(d,a,b,c)}},removeSWF:function(a){if(ax.w3){aT(a)}},createCSS:function(a,d,c,b){if(ax.w3){aO(a,d,c,b)}},addDomLoadEvent:at,addLoadEvent:aI,getQueryParamValue:function(a){var d=ap.location.search||ap.location.hash;if(d){if(/\?/.test(d)){d=d.split("?")[1]}if(a==null){return av(d)}var c=d.split("&");for(var b=0;b<c.length;b++){if(c[b].substring(0,c[b].indexOf("="))==a){return av(c[b].substring((c[b].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(X){var a=ab(aH);if(a&&au){a.parentNode.replaceChild(au,a);if(aF){aQ(aF,true);if(ax.ie&&ax.win){au.style.display="block"}}if(ag){ag(aa)}}X=false}}}}();window.ASC.Files.TemplateManager=(function(){var c=false,f="",e="",g={},d={CreateNewFile:"createnewfile",CreateFolder:"createfolder",CheckEditing:"checkediting",GetTreeSubFolders:"gettreesubfolders",GetFolderInfo:"getfolderinfo",GetFolderItems:"getfolderitems",GetSharedInfo:"getsharedinfo",SetAceObject:"setaceobject",UnSubscribeMe:"unsubscribeme",GetShortenLink:"getshortenlink",MarkAsRead:"markasread",FolderRename:"folderrename",FileRename:"filerename",DeleteItem:"deleteitem",EmptyTrash:"emptytrash",GetFileHistory:"getfilehistory",ReplaceVersion:"replaceversion",SetCurrentVersion:"setcurrentversion",IsZohoAuthentificated:"iszohoauthentificated",GetImportData:"getImportData",ExecImportData:"execImportData",Download:"download",GetTasksStatuses:"getTasksStatuses",TerminateTasks:"terminatetasks",MoveFilesCheck:"movefilescheck",MoveItems:"moveitems",GetSiblingsFile:"getsiblingsfile",SaveThirdParty:"savethirdparty",DeleteThirdParty:"deletethirdparty"},h={getFileHistory:"getfilehistory",getFoldersTree:"getfolderstree",getFolderInfo:"getfolderinfo",getFolderItems:"getfolderitems",getFolderItem:"getfolderitem",getImportData:"getimportdata",getTooltip:"gettooltip"};var b=function(j,i){if(c===false){c=true;f=i;e=j}};var a=function(i){if(typeof i!=="string"||i.length===0){return undefined}if(g.hasOwnProperty(i)){return g[i]}var j=ASC.Controls.XSLTManager.loadXML(e+"?id="+f+"&name="+i);if(j&&typeof j==="object"){g[i]=j;return g[i]}return undefined};return{events:d,templates:h,getTemplate:a,init:b}})();window.ASC.Files.Tree=(function(){var h=false;var n="files_trewViewContainer";var o="files_trewViewSelector";var j=new Array();var g=function(){if(h===false){h=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetTreeSubFolders,i);jq.dropdownToggle({switcherSelector:"#files_breadCrumbsRoot",dropdownID:"files_treeViewPanel",showFunction:ASC.Files.Tree.showTreePath})}};var e=function(v){return jq("#files_trewViewContainer li.tree_node[data-id='"+v+"']")};var d=function(v){return jq("#files_trewViewSelector li.stree_node[data-id='"+v+"']")};var b=function(v){return v.attr("data-id")};var c=function(v){return ASC.Files.Tree.getStreeNode(v).children("a").text().trim()};var k=function(v){if(!jq((v.target)?v.target:v.srcElement).parents().andSelf().is("#files_treeViewPanelSelector, #files_moveto_folders, #files_moveto_files, #files_copyto_folders, #files_copyto_files,                 #files_restore_folders, #files_restore_files, #files_movetoButton, #files_copytoButton, #files_restoreButton,                 #files_mainMove, #files_mainCopy, #files_mainRestore, #files_importToFolderBtn")){ASC.Files.Actions.hideAllActionPanels();jq("body").unbind("click",ASC.Files.Tree.registerHideTree)}};var u=function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Tree.showTreePath();jq.dropdownToggle().toggle("#files_breadCrumbsRoot","files_treeViewPanel")};var r=function(v){if(ASC.Files.Import){ASC.Files.Import.isImport=false}ASC.Files.Folders.isCopyTo=(v===true);if(!ASC.Files.UI.accessibleItem()&&!ASC.Files.Folders.isCopyTo){return}ASC.Files.Tree.showTreePath();ASC.Files.Tree.showSelect(ASC.Files.Folders.currentFolderId);ASC.Files.Actions.hideAllActionPanels();if(!v&&jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):not(.onEdit):has(div.checkbox input:checked)").length==0){return undefined}if(ASC.Files.ThirdParty&&!ASC.Files.ThirdParty.isThirdParty()&&!ASC.Files.Folders.isCopyTo&&jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):not(.thirdPartyEntry):has(div.checkbox input:checked)").length==0){return undefined}if(jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry):has(div.checkbox input:checked)").length==0){return undefined}jq("#files_treeViewPanelSelector").removeClass("without-third-party");jq.dropdownToggle().toggle("li.menuActionSelectAll","files_treeViewPanelSelector");jq("body").bind("click",ASC.Files.Tree.registerHideTree)};var t=function(){var y=ASC.Files.Tree.getTreeNode(ASC.Files.Tree.pathParts[0].Key);if(y.length!=0){for(var w=0;w<ASC.Files.Tree.pathParts.length-1;w++){var v=ASC.Files.Tree.pathParts[w].Key;y=ASC.Files.Tree.getTreeNode(v);var z=y.children("ul");if(z.html()==null||z.html()==""){ASC.Files.Tree.getTreeSubFolders(v)}else{y.addClass("jstree-open").removeClass("jstree-closed");var x=ASC.Files.Tree.getStreeNode(v);x.children(".jstree-icon").parent().addClass("jstree-open").removeClass("jstree-closed")}}}ASC.Files.Tree.select(ASC.Files.Tree.getTreeNode(ASC.Files.Folders.currentFolderId));ASC.Files.Tree.showSelect(ASC.Files.Folders.currentFolderId)};var l=function(w,A){var B=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFoldersTree);var v=ASC.Controls.XSLTManager.translate(A,B);var z=ASC.Files.Tree.getTreeNode(w);var y=ASC.Files.Tree.getStreeNode(w);z.addClass("jstree-open").removeClass("jstree-closed");y.addClass("jstree-open").removeClass("jstree-closed");if(v!=""){z.removeClass("jstree-empty").append("<ul>"+v+"</ul>");var x=v.replace(/tree_node/g,"stree_node");y.removeClass("jstree-empty").append("<ul>"+x+"</ul>")}else{z.addClass("jstree-empty");y.addClass("jstree-empty")}};var p=function(v){jq("#"+n+" a").removeClass("selected");jq("#"+o+" a").removeClass("selected");v.children("a").addClass("selected");v.parents("#files_trewViewContainer li.jstree-closed").addClass("jstree-open").removeClass("jstree-closed")};var s=function(v){ASC.Files.Tree.getStreeNode(v).children("a").addClass("selected");ASC.Files.Tree.getTreeNode(v+"']").parents("#files_trewViewSelector li.jstree-closed").addClass("jstree-open").removeClass("jstree-closed")};var q=function(B){var v=ASC.Files.Tree.getFolderId(B);if(ASC.Files.Import&&ASC.Files.Import.isImport==true){var w="";var y=B.parents("li.stree_node").andSelf();for(var x=0;x<y.length;x++){if(x>0){w+=" > "}w+=jq(y[x]).children("a").text().trim()}ASC.Files.Import.setFolderImportTo(v,w)}else{var A=ASC.Files.Tree.getStreeNode(v).children("a").text().trim();var z=ASC.Files.Tree.getStreeNode(v).parents("li").map(function(){return ASC.Files.Tree.getFolderId(jq(this))});z=jq.makeArray(z);z.unshift(v);ASC.Files.Folders.curItemFolderMoveTo(v,A,z)}};var a=function(w){var v=ASC.Files.Tree.getFolderId(w);if(w.children().is("ul")){w.toggleClass("jstree-closed").toggleClass("jstree-open")}else{ASC.Files.Tree.getTreeSubFolders(v)}};var m=function(v){if(!ASC.Files.Common.isCorrectId(v)){return}ASC.Files.Tree.getTreeNode(v).addClass("jstree-closed").removeClass("jstree-open jstree-empty").children("ul").remove();ASC.Files.Tree.getStreeNode(v).addClass("jstree-closed").removeClass("jstree-open jstree-empty").children("ul").remove()};var f=function(v){ASC.Files.Tree.getTreeNode(v).find(".jstree-icon.expander").addClass("jstreeLoadNode");ASC.Files.Tree.getStreeNode(v).find(".jstree-icon.expander").addClass("jstreeLoadNode");serviceManager.request("post","xml",ASC.Files.TemplateManager.events.GetTreeSubFolders,{folderId:v},{orderBy:ASC.Files.Filter.getOrderByAZ(true)},"folders","subfolders?parentId="+encodeURIComponent(v))};var i=function(A,y,w,v){var x=y.folderId;ASC.Files.Tree.getTreeNode(x).find(".jstree-icon.expander").removeClass("jstreeLoadNode");ASC.Files.Tree.getStreeNode(x).find(".jstree-icon.expander").removeClass("jstreeLoadNode");if(typeof w!="undefined"){ASC.Files.UI.displayInfoPanel(v||w,true);return undefined}var z=ASC.Files.Tree.getTreeNode(x).find("ul");if(z.html()==null||z.html()==""){l(x,A);ASC.Files.Tree.getTreeNode(x).children().show();ASC.Files.Tree.getStreeNode(x).children().show()}ASC.Files.Tree.select(ASC.Files.Tree.getTreeNode(ASC.Files.Folders.currentFolderId));ASC.Files.Tree.showSelect(ASC.Files.Folders.currentFolderId)};return{init:g,expand:a,resetNode:m,select:p,selectS:q,getTreeNode:e,getStreeNode:d,getFolderId:b,getFolderTitle:c,pathParts:j,showSelect:s,showTreeViewPanel:u,showMoveToSelector:r,registerHideTree:k,showTreePath:t,getTreeSubFolders:f}})();(function(a){ASC.Files.Tree.init();a(function(){jq("#files_movetoButton, #files_copytoButton, #files_restoreButton,            #files_mainMove, #files_mainCopy, #files_mainRestore").click(function(){ASC.Files.Tree.showMoveToSelector(this.id=="files_copytoButton"||this.id=="files_mainCopy")});jq("#files_moveto_files, #files_restore_files, #files_copyto_files,            #files_moveto_folders, #files_restore_folders, #files_copyto_folders").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Tree.showMoveToSelector(this.id=="files_copyto_files"||this.id=="files_copyto_folders")});jq("#files_breadCrumbsCaption").click(function(){if(ASC.Files.Tree.pathParts.length>1){ASC.Files.Folders.navigationSet(ASC.Files.Tree.pathParts[0].Key)}else{ASC.Files.Tree.showTreeViewPanel()}return false});jq("#files_trewViewContainer").on("click",".jstree-icon.expander",function(){ASC.Files.Tree.expand(jq(this).parent());return false});jq("#files_trewViewContainer").on("click","a",function(){var b=jq(this).parent();ASC.Files.Tree.select(b);ASC.Files.Folders.navigationSet(ASC.Files.Tree.getFolderId(b));return false});jq("#files_trewViewSelector").on("click",".jstree-icon.expander",function(){ASC.Files.Tree.expand(jq(this).parent());return false});jq("#files_trewViewSelector").on("click","a",function(){var d=jq(this).parent();var b=ASC.Files.Tree.getFolderId(d);var c=ASC.Files.UI.getEntryObject("folder",b);if(ASC.Files.UI.accessibleItem(c)){ASC.Files.Tree.selectS(d);return false}else{ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SecurityException,true);ASC.Files.Tree.expand(d);return false}})})})(jQuery);window.ASC.Files.UI=(function(){var isInit=false;var timeIntervalInfo=null;var timeCheckEditing=null;var timeTooltip=null;var currentPage=0;var amountPage=0;var countEntityInFolder=0;var currentRowOver=null;var startX=0;var startY=0;var prevX=0;var prevY=0;var mouseBtn=false;var init=function(){if(isInit===false){isInit=true}ASC.Files.UI.mouseBtn=false};var getEntryObject=function(entryType,entryId){if(entryType&&entryId){if(!ASC.Files.Common.isCorrectId(entryId)){return null}return jq("#files_mainContent li.fileRow[data-id='"+entryType+"_"+entryId+"']")}};var getObjectData=function(entryObject){entryObject=jq(entryObject);if(!entryObject.is("li.fileRow")){entryObject=entryObject.closest("li.fileRow")}if(entryObject.length==0){return null}var entryDataStr=entryObject.find("input:hidden[name='entry_data']").val();var resulat=eval(entryDataStr);if(!ASC.Files.Common.isCorrectId(resulat.id)){return null}resulat.entryId=resulat.id;resulat.entryType=(resulat.entryType==="file"?"file":"folder");resulat.create_by=entryObject.find("input:hidden[name='create_by']").val();resulat.modified_by=entryObject.find("input:hidden[name='modified_by']").val();resulat.entryObject=entryObject;resulat.error=(resulat.error!=""?resulat.error:false);resulat.title=resulat.title.trim();return resulat};var parseItemId=function(itemId){if(typeof itemId=="undefined"){return null}var entryType=itemId.indexOf("file_")=="0"?"file":"folder";var entryId=itemId.substring((entryType+"_").length);if(!ASC.Files.Common.isCorrectId(entryId)){return null}return{entryType:entryType,entryId:entryId}};var getEntryTitle=function(entryType,entryId){if(!ASC.Files.Common.isCorrectId(entryId)){return null}return ASC.Files.UI.getObjectTitle(ASC.Files.UI.getEntryObject(entryType,entryId))};var getObjectTitle=function(entryObject){entryObject=jq(entryObject);if(!entryObject.is("li.fileRow")){entryObject=entryObject.closest("li.fileRow")}if(entryObject.length==0){return null}return ASC.Files.UI.getObjectData(entryObject).title.trim()};var updateFolderView=function(){if(!ASC.Files.Common.isCorrectId(ASC.Files.Folders.currentFolderId)){ASC.Controls.AnchorController.move("");return}ASC.Files.Folders.getFolderItems(false)};var switchFolderView=function(){if(jq("#files_mainContent").hasClass("compact")){jq("#switchViewFolder").addClass("compact");jq("#files_mainContent li.fileRow").each(function(){var linkRow=jq(this).find(".entryTitle a.name");linkRow.removeAttr("title")})}else{jq("#switchViewFolder").removeClass("compact");jq("#files_mainContent li.fileRow").each(function(){var linkRow=jq(this).find(".entryTitle a.name");linkRow.attr("title",linkRow.text())});if(jq(document).height()-jq(window).height()<=jq(window).scrollTop()+350){ASC.Files.Folders.showMore()}}};var updateFolderInfo=function(diffCountFolder,diffCountFile){var currentCountFolder=(parseInt(jq("#content_info_count_folders").html())||0)+diffCountFolder;var currentCountFile=(parseInt(jq("#content_info_count_files").html())||0)+diffCountFile;var regetCount=false;if(currentCountFolder<0||currentCountFile<0){regetCount=true}else{if(currentCountFolder<jq("#files_mainContent li.folderRow").length){regetCount=true}if(regetCount||currentCountFile<jq("#files_mainContent li.fileRow:not(.folderRow)").length){regetCount=true}}if(regetCount){ASC.Files.Folders.getFolderInfo();return}jq("#content_info_count_folders").html(currentCountFolder);jq("#content_info_count_files").html(currentCountFile);jq("#currentFolderInfo").attr("title",jq("#currentFolderInfo").text())};var toggleMainMenu=function(){if(jq("#mainContentHeader:visible").length==0){return}var mainContentHeaderSpacer=jq("#mainContentHeaderSpacer");var mainContentHeader=jq("#mainContentHeader");var boxTop=jq("#menuActionSelectOpen");var newTop=boxTop.offset().top+boxTop.outerHeight();var winScrollTop=jq(window).scrollTop();var tempTop=0;if(mainContentHeaderSpacer.css("display")=="none"){tempTop+=mainContentHeader.offset().top}else{tempTop+=mainContentHeaderSpacer.offset().top}if(winScrollTop>=tempTop){mainContentHeaderSpacer.show();mainContentHeader.addClass("fixed");jq("#files_selectorPanel").css({position:"fixed",top:newTop-winScrollTop});if(jq.browser.mobile){mainContentHeader.css({top:jq(document).scrollTop()+"px",position:"absolute"})}}else{mainContentHeaderSpacer.hide();mainContentHeader.removeClass("fixed");jq("#files_selectorPanel").css({position:"absolute",top:newTop});if(jq.browser.mobile){mainContentHeader.css({position:"static"})}}};var showOverwriteMessage=function(listData,folderId,folderToTitle,isCopyOperation,data){var folderTitle=ASC.Files.UI.getEntryTitle("folder",folderId)||ASC.Files.Tree.getFolderTitle(folderId);var message;if(data.length>1){var files="";for(var i=0;i<data.length;i++){files+="<li title='{0}'>{0}</li>".format(data[i].Value)}message="<b>"+ASC.Files.FilesJSResources.FilesAlreadyExist.format(data.length,folderTitle)+"</b>";jq("#files_overwrite_list").html(files).show()}else{jq("#files_overwrite_list").hide();message=ASC.Files.FilesJSResources.FileAlreadyExist.format("<span title='"+data[0].Value+"'>"+data[0].Value+"</span>","<b>"+folderTitle+"</b>")}jq("#files_overwrite_msg").html(message);jq("#files_overwrite_overwrite").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog();serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{folderToId:folderId,overwrite:true,isCopyOperation:(isCopyOperation==true),doNow:true},{stringList:listData})});jq("#files_overwrite_skip").unbind("click").click(function(){for(var i=0;i<data.length;i++){ASC.Files.UI.blockObjectById("file",data[i].Key);var pos=jq.inArray("file_"+data[i].Key,listData.entry);if(pos!=-1){listData.entry.splice(pos,1)}}PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog();serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{folderToId:folderId,overwrite:false,isCopyOperation:(isCopyOperation==true),doNow:true},{stringList:listData})});jq("#files_overwrite_cancel").unbind("click").click(function(){for(var i=0;i<listData.entry.length;i++){var itemId=ASC.Files.UI.parseItemId(listData.entry[i]);ASC.Files.UI.blockObjectById(itemId.entryType,itemId.entryId)}PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog()});ASC.Files.Common.blockUI(jq("#files_overwriteFiles"),400,300);PopupKeyUpActionProvider.EnterAction='jq("#files_overwrite_overwrite").click();';PopupKeyUpActionProvider.CloseDialogAction='jq("#files_overwrite_cancel").click();'};var blockObjectById=function(entryType,entryId,value,message){return ASC.Files.UI.blockObject(ASC.Files.UI.getEntryObject(entryType,entryId),value,message)};var blockObject=function(entryObj,value,message){entryObj=jq(entryObj);if(entryObj.hasClass("checkloading")&&value){return}ASC.Files.UI.selectRow(entryObj,false);ASC.Files.UI.updateMainContentHeader();ASC.Files.UI.hideLinks(entryObj);if(value===true){entryObj.addClass("loading checkloading");entryObj.block({message:"",baseZ:99});if(typeof message!="undefined"){entryObj.children("div.blockUI.blockOverlay").attr("title",message)}}else{entryObj.removeClass("loading checkloading");entryObj.unblock();entryObj.css("position","static")}};var hideLinks=function(entryObj){jq(entryObj).removeClass("row-over")};var showLinks=function(entryObj){if(jq("#files_selector").css("display")=="block"||jq(entryObj).hasClass("loading")){return}jq(entryObj).addClass("row-over")};var editingFile=function(entryObj){return !entryObj.hasClass("folderRow")&&entryObj.hasClass("onEdit")};var editableFile=function(fileData){var fileObj=fileData.entryObject;var fileType=fileData.entryType;var title=fileData.title;return fileType=="file"&&ASC.Files.Folders.folderContainer!="trash"&&fileObj.is("li:not(.rowRename)")&&ASC.Files.UI.accessibleItem(fileObj)&&ASC.Files.Utility.CanWebEdit(title)};var paintRows=function(){jq("#files_mainContent li.fileRow:odd").removeClass("even");jq("#files_mainContent li.fileRow:even").addClass("even")};var addRowHandlers=function(entryObject){var listEntry=(entryObject||jq("#files_mainContent li.fileRow"));if(listEntry.is(":visible")){ASC.Files.UI.paintRows()}listEntry.each(function(){var entryData=ASC.Files.UI.getObjectData(this);var entryId=entryData.entryId;var entryType=entryData.entryType;var entryObj=entryData.entryObject;var entryTitle=entryData.title;if(ASC.Files.Folders.folderContainer=="trash"){entryObj.find("div.entryInfo span.titleCreated").remove();entryObj.find("div.entryInfo span.titleRemoved").css("display","");if(entryType=="folder"){entryObj.find("span.create_date").remove();entryObj.find("span.modified_date").css("display","")}else{var fortrashCreateBy=entryObj.find("div.entryInfo span.fortrash_create_by");if(fortrashCreateBy.length){entryObj.find("div.entryInfo span.create_by").remove();fortrashCreateBy.show().removeClass("fortrash_create_by").addClass("create_by")}}}else{entryObj.find("div.entryInfo span.titleRemoved").remove();entryObj.find("div.entryInfo span.fortrash_create_by").remove();if(entryType=="folder"){entryObj.find("span.modified_date").remove()}}var rowLink=entryObj.find(".entryTitle a.name");var ftClass=(entryType=="file"?ASC.Files.Utility.getCssClassByFileTitle(entryTitle):ASC.Files.Utility.getFolderCssClass());entryObj.find(".thumb-"+entryType).addClass(ftClass);if(!entryObj.hasClass("checkloading")){if(ASC.Files.Folders.folderContainer=="trash"||entryData.error){rowLink.attr("href","#"+encodeURIComponent(ASC.Files.Folders.currentFolderId))}if(entryType=="file"){if(rowLink.children().length==0){var fileExt=ASC.Files.Utility.GetFileExtension(entryTitle);var entrySplitTitle=entryTitle.substring(0,entryTitle.length-fileExt.length);rowLink.html("{0}<span>{1}</span>".format(entrySplitTitle,fileExt))}if(ASC.Files.Folders.folderContainer!="trash"){var entryUrl=ASC.Files.Utility.GetFileDownloadUrl(entryId);if(ASC.Files.Utility.CanWebView(entryTitle)){entryUrl=ASC.Files.Utility.GetFileWebViewerUrl(entryId);rowLink.attr("href",entryUrl).attr("target","_blank")}else{if(typeof ASC.Files.ImageViewer!="undefined"&&ASC.Files.Utility.CanImageView(entryTitle)){entryUrl=ASC.Files.ImageViewer.getPreviewUrl(entryId);rowLink.attr("href",entryUrl)}else{rowLink.attr("href",jq.browser.mobile?"":entryUrl)}}}if(ASC.Files.UI.editableFile(entryData)){ASC.Files.UI.lockEditFile(entryObj,ASC.Files.UI.editingFile(entryObj))}else{entryObj.addClass("cannotEdit");entryObj.find("div.pencil").remove()}}else{rowLink.attr("href","#"+encodeURIComponent(entryId))}}});ASC.Files.UI.switchFolderView()};var checkTarget=function(target){if(target.nodeName=="HTML"){return true}if(jq("div.popupModal:visible").length!=0){return true}if(jq.inArray(jq("div.mainContainerClass")[0],jq(target).parents())==-1){return true}if(jq("#imageViewerToolbox:visible, #imageViewerContainer:visible").length!=0){return true}if(jq(target).is("li.fileRow, li.fileRow *")||jq(target).is("div.files_action_panel, div.files_action_panel *")||jq(target).is("#menuActionSelectOpen, #files_actions_open *")||jq(target).is("div.treeViewPanel, div.treeViewPanel *")||jq(target).is("ul#mainMenuHolder, ul#mainMenuHolder *")||jq(target).is(".files_progress_box, #files_pageNavigatorHolder a")||jq(target).is("#files_advansedFilter *")){return true}return false};var beginSelecting=function(e){e=ASC.Files.Common.fixEvent(e);if(!(e.button==0||(jq.browser.msie&&e.button==1))){return true}if(jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile)").length==0){return true}var target=e.target||e.srcElement;try{if(checkTarget(target)){return true}}catch(e){return true}var posX=e.pageX;var posY=e.pageY;ASC.Files.UI.startX=posX;ASC.Files.UI.startY=posY;jq("#studioPageContent").append("<div id='files_selector'></div>");jq("#files_selector").css({left:posX+"px",top:posY+"px",width:"0px",height:"0px","z-index":"254","background-color":"#6CA3BF",position:"absolute"});jq("#files_selector").fadeTo(0,0.3);jq("body").addClass("select_action");var windowFix=(jq.browser.msie&&jq.browser.version<9?jq("body"):jq(window));windowFix.unbind("mouseout").unbind("mousemove").unbind("mouseup").mousemove(function(event){event=ASC.Files.Common.fixEvent(event);var targetMove=event.target||event.srcElement;if(typeof targetMove=="undefined"){return true}var posXnew=event.pageX;var posYnew=event.pageY;var width,height,top,left;width=Math.abs(posXnew-ASC.Files.UI.startX);height=Math.abs(posYnew-ASC.Files.UI.startY);if(width<5&&height<5){return true}left=Math.min(ASC.Files.UI.startX,posXnew);top=Math.min(ASC.Files.UI.startY,posYnew);jq("#files_selector").css({width:width+"px",height:height+"px",left:left+"px",top:top+"px",display:"block",border:"1px solid #034",cursor:"default"});ASC.Files.Actions.hideAllActionPanels();jq("#files_mainContent li.fileRow:not(.checkloading):not(.newFolder):not(.newFile)").each(function(){var startXnew=Math.min(ASC.Files.UI.startX,posXnew);var startYnew=Math.min(ASC.Files.UI.startY,posYnew);var endX=Math.max(ASC.Files.UI.startX,posXnew);var endY=Math.max(ASC.Files.UI.startY,posYnew);var offset=jq(this).offset();var difX=this.offsetWidth;var difY=this.offsetHeight;if((offset.top>startYnew&&offset.top<endY&&offset.left>startXnew&&offset.left<endX)||(offset.top+difY>startYnew&&offset.top+difY<endY&&offset.left>startXnew&&offset.left<endX)||(offset.top+difY>startYnew&&offset.top+difY<endY&&offset.left+difX>startXnew&&offset.left+difX<endX)||(offset.top>startYnew&&offset.top<endY&&offset.left+difX>startXnew&&offset.left+difX<endX)||(offset.top>startYnew&&offset.top<endY&&offset.left<startXnew&&offset.left+difX>endX)||(offset.top+difY>startYnew&&offset.top+difY<endY&&offset.left<startXnew&&offset.left+difX>endX)||(offset.top<startYnew&&offset.top+difY>endY&&offset.left>startXnew&&offset.left<endX)||(offset.top<startYnew&&offset.top+difY>endY&&offset.left+difX>startXnew&&offset.left+difX<endX)){ASC.Files.UI.selectRow(this,true)}else{if(!event.ctrlKey){ASC.Files.UI.selectRow(this,false)}}});ASC.Files.UI.updateMainContentHeader();ASC.Files.UI.resetSelectAll(jq("#files_mainContent div.checkbox input:not(:checked)").length==0);return false});windowFix.bind("mouseup",function(){jq("#files_selector").remove();ASC.Files.UI.startX=0;ASC.Files.UI.startY=0;ASC.Files.UI.mouseBtn=false;windowFix.unbind("mousemove").unbind("mouseup");jq("body").removeClass("select_action")});return false};var handleMove=function(e){if(jq("div.files_popup_win:visible").length!=0){return}e=ASC.Files.Common.fixEvent(e);var posX=e.pageX;var posY=e.pageY;var noOver=true;jq("#files_mainContent li.fileRow").each(function(){var offset=jq(this).offset();var difX=this.offsetWidth;var difY=this.offsetHeight;if((offset.top<posY&&offset.top+difY>posY&&offset.left<posX&&offset.left+difX>posX)){if(ASC.Files.UI.currentRowOver==this){noOver=false;return}var prev=ASC.Files.UI.currentRowOver;ASC.Files.UI.currentRowOver=this;ASC.Files.UI.showLinks(this);noOver=false;if(prev!=null){ASC.Files.UI.hideLinks(prev)}}});if(noOver){if(ASC.Files.UI.currentRowOver!=null){ASC.Files.UI.hideLinks(ASC.Files.UI.currentRowOver)}ASC.Files.UI.currentRowOver=null}};var preparingMoveTo=function(entryObj,e){e=ASC.Files.Common.fixEvent(e);if(!(e.button==0||(jq.browser.msie&&e.button==1))){return undefined}if(ASC.Files.Folders.folderContainer=="trash"){return false}if(jq("#files_treeViewPanelSelector").length==0){return false}if(jq("#files_prompt_rename").length!=0){return true}if(!jq(entryObj).is(":not(.checkloading):not(.newFolder):not(.newFile):not(.errorEntry)")){return true}if(jq(entryObj).find("div.checkbox input:checked").length==0){return true}ASC.Files.UI.prevX=e.pageX;ASC.Files.UI.prevY=e.pageY;jq("body").unbind("mouseout").mouseout(function(event){ASC.Files.UI.beginMoveTo(event);return true}).unbind("mousemove").mousemove(function(event){ASC.Files.UI.beginMoveTo(event);return true})};var beginMoveTo=function(e){e=ASC.Files.Common.fixEvent(e);if(!(e.button==0||(jq.browser.msie&&e.button==1))||ASC.Files.UI.mouseBtn==false){jq("body").unbind("mouseout").unbind("mousemove");return undefined}if(Math.abs(e.pageX-ASC.Files.UI.prevX)<5&&Math.abs(e.pageY-ASC.Files.UI.prevY)<5){return false}ASC.Files.Actions.hideAllActionPanels();var posX=jq("#files_mainContent").offset().left;var posY=jq("#files_mainContent").offset().top;var listEtryObj=jq("#files_mainContent li.fileRow");jq("#files_moving").remove();jq("#files_mainContent").parent().append("<ul id='files_moving'></ul>");if(jq("#files_mainContent").hasClass("compact")){jq("#files_moving").addClass("compact")}if(jq("#files_mainContent").hasClass("withShare")){jq("#files_moving").addClass("withShare")}var movingEntry=jq("#files_moving").css({left:posX+"px",top:posY+"px",width:jq("#files_mainContent").width()+"px",cursor:(jq.browser.msie?"move":"alias")});listEtryObj.each(function(){if(jq("div.checkbox input",jq(this)).is(":checked")&&!jq(this).hasClass("errorEntry")){jq(this).clone(false).fadeTo(0,0.5).appendTo(movingEntry).css({display:"block","background-color":"#FFF8D4"})}else{jq(this).clone(false).appendTo(movingEntry).css({display:"block",visibility:"hidden"})}});jq("*",movingEntry).css("cursor",(jq.browser.msie?"move":"alias"));jq("* [title!='']",movingEntry).removeAttr("title");jq("div.checkbox",movingEntry).css("visibility","hidden");jq("body").addClass("user_select_none");jq("#files_mainContent li.folderRow:not(.checkloading):not(.newFolder):not(.errorEntry):not(.row-selected),            #files_breadCrumbs a,            #files_breadCrumbsRoot").each(function(){var folderToId;if(jq(this).is("#files_breadCrumbs a")){folderToId=jq(this).attr("data-id")}else{if(this.id=="files_breadCrumbsRoot"){folderToId=ASC.Files.Tree.pathParts[0].Key}else{folderToId=ASC.Files.UI.getObjectData(this).entryId}}var folderToObj=ASC.Files.UI.getEntryObject("folder",folderToId);if(ASC.Files.Common.isCorrectId(folderToId)&&folderToId!=ASC.Files.Folders.currentFolderId&&ASC.Files.UI.accessibleItem(folderToObj)&&(folderToId!=ASC.Files.Constants.FOLDER_ID_TRASH||ASC.Files.UI.accessibleItem())){jq(this).addClass("may-row-to")}});jq("body").unbind("mouseout").mouseout(function(event){ASC.Files.UI.continueMoveTo(movingEntry,event);return true}).unbind("mousemove").mousemove(function(event){ASC.Files.UI.continueMoveTo(movingEntry,event);return true}).unbind("mouseup").mouseup(function(event){ASC.Files.UI.finishMoveTo(movingEntry,event)})};var continueMoveTo=function(movingEntry,e){e=ASC.Files.Common.fixEvent(e);ASC.Files.Folders.moveToFolder="";if(ASC.Files.UI.mouseBtn==false||typeof movingEntry=="undefined"){ASC.Files.UI.finishMoveTo(movingEntry,e);return true}var posX=e.pageX+jq("#files_mainContent").offset().left-ASC.Files.UI.prevX;var posY=e.pageY+jq("#files_mainContent").offset().top-ASC.Files.UI.prevY;jq(movingEntry).css({left:posX+"px",display:"block",top:posY+"px",cursor:(jq.browser.msie?"move":"alias")});if(jq("#files_moving_tooltip").length==0){var list=jq("#files_mainContent li.fileRow:has(div.checkbox input:checked)");var textInfo;if(list.length==1){textInfo=ASC.Files.UI.getObjectTitle(list[0])}else{textInfo=ASC.Files.FilesJSResources.InfoSelectCount.format(list.length)}textInfo=ASC.Files.FilesJSResources.InfoSelectingDescribe.format("<b>"+textInfo+"</b><br/>");jq("#files_mainContent").parent().append("<div id='files_moving_tooltip'></div>");jq("#files_moving_tooltip").html(textInfo)}jq("#files_moving_tooltip").css({left:e.pageX+"px",top:e.pageY+"px"});if(!ASC.Files.UI.accessibleItem()||e.ctrlKey){if(!jq(movingEntry).hasClass("copy")){jq(movingEntry).css("cursor",(jq.browser.msie?"crosshair":"copy")).addClass("copy");jq("*",movingEntry).css("cursor",(jq.browser.msie?"crosshair":"copy"))}}else{if(jq(movingEntry).hasClass("copy")){jq(movingEntry).css("cursor",(jq.browser.msie?"move":"alias")).removeClass("copy");jq("*",movingEntry).css("cursor",(jq.browser.msie?"move":"alias"))}}jq(".row-to").removeClass("row-to");jq(".may-row-to").each(function(){var folderToId;if(jq(this).is("#files_breadCrumbs a")){folderToId=jq(this).attr("href").replace("#","")}else{if(this.id=="files_breadCrumbsRoot"){folderToId=ASC.Files.Tree.pathParts[0].Key}else{folderToId=ASC.Files.UI.getObjectData(this).entryId}}if(ASC.Files.Common.isCorrectId(folderToId)){var difX=this.offsetWidth;var difY=this.offsetHeight;var pos=jq(this).offset();if(pos.top<e.pageY&&pos.top+difY>e.pageY&&pos.left<e.pageX&&pos.left+difX>e.pageX){ASC.Files.Folders.moveToFolder=folderToId;jq(this).addClass("row-to");return true}}});if(jq.browser.opera){var target=e.target||e.srcElement;target=jq(target);if(!target.hasClass("fileRow")){target=jq(target).closest("li.fileRow")}var nameFix="fix_select_text";var el=target.children("#"+nameFix);if(el.length==0){jq("#"+nameFix).remove();el=document.createElement("INPUT");el.style.width=0;el.style.height=0;el.style.border=0;el.style.margin=0;el.style.padding=0;el.id=nameFix;el.disabled=true;target.prepend(el);el=jq("#"+nameFix)}try{el.focus()}catch(e){el.disabled=false;el.focus();el.disabled=true}}};var finishMoveTo=function(movingEntry,e){var data={};data.entry=new Array();var folderToId=ASC.Files.Folders.moveToFolder;ASC.Files.Folders.moveToFolder="";jq(".row-to").removeClass("row-to");jq(".may-row-to").removeClass("may-row-to");jq("body").removeClass("user_select_none");if(ASC.Files.Common.isCorrectId(folderToId)){if(folderToId==ASC.Files.Constants.FOLDER_ID_TRASH){ASC.Files.Folders.deleteItem()}else{ASC.Files.Folders.isCopyTo=(!ASC.Files.UI.accessibleItem()||e.ctrlKey===true);var thirdParty=typeof ASC.Files.ThirdParty!="undefined";var takeThirdParty=thirdParty&&(ASC.Files.Folders.isCopyTo==true||ASC.Files.ThirdParty.isThirdParty());jq("li.fileRow",movingEntry).each(function(){if(jq(this).css("visibility")!="hidden"){var entryRowData=ASC.Files.UI.getObjectData(this);var entryRowObject=entryRowData.entryObject;var entryRowType=entryRowData.entryType;var entryRowId=entryRowData.entryId;var itemRowId=entryRowType+"_"+entryRowId;if(takeThirdParty||!thirdParty||!ASC.Files.ThirdParty.isThirdParty(entryRowObject)){if(ASC.Files.Folders.isCopyTo==true||ASC.Files.UI.accessAdmin(entryRowObject)){if(ASC.Files.Folders.isCopyTo==true||!ASC.Files.UI.editingFile(entryRowObject)){ASC.Files.UI.blockObject(this,true,(ASC.Files.Folders.isCopyTo==true)?ASC.Files.FilesJSResources.DescriptCopy:ASC.Files.FilesJSResources.DescriptMove);data.entry.push(encodeURIComponent(itemRowId))}}}}});var folderToTitle=ASC.Files.UI.getEntryTitle("folder",folderToId);if(data.entry&&data.entry.length!=0){serviceManager.moveFilesCheck(ASC.Files.TemplateManager.events.MoveFilesCheck,{folderToTitle:folderToTitle,folderToId:folderToId,list:data,isCopyOperation:(ASC.Files.Folders.isCopyTo==true)},{stringList:data})}}}ASC.Files.Folders.isCopyTo=false;jq("body").unbind("mouseout").unbind("mousemove").unbind("mouseup");jq(movingEntry).remove();jq("#files_moving").remove();jq("#files_moving_tooltip").remove()};var clickRow=function(event){var e=ASC.Files.Common.fixEvent(event);if(!(e.button==0||(jq.browser.msie&&e.button==1))){return true}var target=jq(e.srcElement||e.target);try{if(target.is("a, div.rowActions")){return true}}catch(e){return true}var entryObj=target.is("li.fileRow")?target:target.closest("li.fileRow");ASC.Files.UI.selectRow(entryObj,!entryObj.hasClass("row-selected"));ASC.Files.UI.updateMainContentHeader()};var updateMainContentHeader=function(){if(jq("#files_mainContent li.fileRow:has(div.checkbox input:checked)").length==0){jq("#mainContentHeader .menuAction.unlockAction").removeClass("unlockAction");if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_mainEmptyTrash").addClass("unlockAction")}}else{ASC.Files.Actions.showActionsViewPanel()}};var selectRow=function(entryObj,value){entryObj=jq(entryObj);if(!entryObj.hasClass("fileRow")){entryObj=entryObj.closest("li.fileRow")}if(entryObj.hasClass("row-selected")==value){return}if(entryObj.hasClass("checkloading")&&value){return}if(entryObj.hasClass("newFolder")||jq(entryObj).hasClass("rowRename")){value=false}var input=entryObj.find("div.checkbox input");input.attr("checked",value===true);if(value){entryObj.addClass("row-selected user_select_none");if(jq.browser.msie){entryObj.find("*").attr("unselectable","on")}}else{entryObj.removeClass("row-selected user_select_none");if(jq.browser.msie){entryObj.find("*").removeAttr("unselectable")}}resetSelectAll(jq("#files_mainContent li.fileRow:has(div.checkbox input:not(:checked))").length==0)};var resetSelectAll=function(param){jq("#files_selectAll_check").attr("checked",param===true)};var checkSelectAll=function(value){jq("#files_mainContent li.fileRow:not(.checkloading)").each(function(){ASC.Files.UI.selectRow(this,value)});ASC.Files.UI.updateMainContentHeader()};var checkSelect=function(filter){ASC.Files.Actions.hideAllActionPanels();jq("#files_mainContent li.fileRow:not(.checkloading)").each(function(){var sel;var fileTitle=ASC.Files.UI.getObjectTitle(this);switch(filter){case"Folder":sel=jq(this).hasClass("folderRow");break;case"File":sel=!jq(this).hasClass("folderRow");break;case"Document":sel=ASC.Files.Utility.FileIsDocument(fileTitle)&&!jq(this).hasClass("folderRow");break;case"Presentation":sel=ASC.Files.Utility.FileIsPresentation(fileTitle)&&!jq(this).hasClass("folderRow");break;case"Spreadsheet":sel=ASC.Files.Utility.FileIsSpreadsheet(fileTitle)&&!jq(this).hasClass("folderRow");break;case"Image":sel=ASC.Files.Utility.FileIsImage(fileTitle)&&!jq(this).hasClass("folderRow");break;default:return false}ASC.Files.UI.selectRow(this,sel)});ASC.Files.UI.updateMainContentHeader()};var displayInfoPanel=function(str,warn){if(str===""||typeof str==="undefined"){return}clearTimeout(timeIntervalInfo);jq("#infoPanelContainer").removeClass("warn").children("div").text(str);jq("#infoPanelContainer").css("margin-left",-jq("#infoPanelContainer").width()/2);if(jq.browser.mobile){jq("#infoPanelContainer").css("top",jq(window).scrollTop()+"px")}if(warn===true){jq("#infoPanelContainer").addClass("warn")}jq("#infoPanelContainer").show();timeIntervalInfo=setTimeout("ASC.Files.UI.hideInfoPanel();",3000)};var hideInfoPanel=function(){clearTimeout(timeIntervalInfo);jq("#infoPanelContainer").hide().children("div").html("&nbsp;")};var accessibleItem=function(entryObj){if(entryObj){var entryData=ASC.Files.UI.getObjectData(entryObj);var entryId=entryData?entryData.entryId:null;var entryType=entryData?entryData.entryType:null}else{entryType="folder";entryId=ASC.Files.Folders.currentFolderId}var access=ASC.Files.Constants.USER_ADMIN||!entryData||entryData.create_by_id==ASC.Files.Constants.USER_ID;if(ASC.Files.Share){if(entryType=="folder"){if(entryId==ASC.Files.Constants.FOLDER_ID_COMMON_FILES&&!ASC.Files.Constants.USER_ADMIN){return false}if(entryId==ASC.Files.Constants.FOLDER_ID_SHARE){return false}}var curAccess=parseInt(entryData?entryData.access:ASC.Files.Constants.AceStatusEnum.None);if(entryType=="folder"&&entryId==ASC.Files.Folders.currentFolderId){curAccess=parseInt(jq("#access_current_folder").val())}switch(curAccess){case ASC.Files.Constants.AceStatusEnum.ReadWrite:return true;case ASC.Files.Constants.AceStatusEnum.Read:case ASC.Files.Constants.AceStatusEnum.Restrict:return false}access=true}return access};var accessAdmin=function(entryObj){if(entryObj){var entryData=ASC.Files.UI.getObjectData(entryObj);var entryId=entryData?entryData.entryId:null;var entryType=entryData?entryData.entryType:null}else{entryType="folder";entryId=ASC.Files.Folders.currentFolderId}var access=ASC.Files.Constants.USER_ADMIN||!entryData||entryData.create_by_id==ASC.Files.Constants.USER_ID;if(ASC.Files.Share){var curAccess=parseInt(entryData?entryData.access:ASC.Files.Constants.AceStatusEnum.None);if(entryType=="folder"&&entryId==ASC.Files.Folders.currentFolderId){curAccess=parseInt(jq("#access_current_folder").val()||ASC.Files.Constants.AceStatusEnum.None)}if(curAccess==ASC.Files.Constants.AceStatusEnum.Restrict){entryObj.remove();ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.AceStatusEnum_Restrict,true);return false}access=(curAccess==ASC.Files.Constants.AceStatusEnum.None||ASC.Files.Folders.folderContainer=="corporate"&&ASC.Files.Constants.USER_ADMIN)}return access};var lockEditFileById=function(fileId,edit,by){var fileObj=ASC.Files.UI.getEntryObject("file",fileId);return ASC.Files.UI.lockEditFile(fileObj,edit,by)};var lockEditFile=function(fileObj,edit,by){if(fileObj.hasClass("folderRow")){return}if(edit){fileObj.addClass("onEdit");var strBy=ASC.Files.FilesJSResources.TitleEditingFile;if(by){strBy=ASC.Files.FilesJSResources.TitleEditingFileBy.format(by)}fileObj.find("div.fileEditing.pencil").attr("title",strBy)}else{fileObj.removeClass("onEdit")}};var checkEditing=function(){clearTimeout(ASC.Files.UI.timeCheckEditing);var list=jq("#files_mainContent li.fileRow.onEdit");if(list.length==0){return}var data={};data.entry=new Array();for(var i=0;i<list.length;i++){var fileId=ASC.Files.UI.getObjectData(list[i]).entryId;data.entry.push(fileId)}serviceManager.checkEditing(ASC.Files.TemplateManager.events.CheckEditing,{list:data.entry},{stringList:data})};var displayEntryTooltip=function(entryType,entryId){var entryObj=ASC.Files.UI.getEntryObject(entryType,entryId);var entryData=ASC.Files.UI.getObjectData(entryObj);var jsonData={entryTooltip:{type:entryType,title:Encoder.htmlEncode(entryData.title),modified_by:Encoder.htmlEncode((ASC.Files.Folders.folderContainer=="trash"||entryType=="file"?entryData.modified_by:entryData.create_by)),date_type:(ASC.Files.Folders.folderContainer=="trash"?"remove":(entryType=="folder"?"create":(entryData.version>1?"update":"upload"))),modified_on:(entryType=="file"?entryData.modified_on:(ASC.Files.Folders.folderContainer=="trash"?entryData.modified_on:entryData.create_on)),version:entryData.version,length:entryData.content_length,error:entryData.error,provider_name:entryData.provider_name,total_files:parseInt(entryObj.find(".countFiles").html())||0,total_sub_folder:parseInt(entryObj.find(".countFolders").html())||0}};var stringData=serviceManager.jsonToXml(jsonData);var curTemplate=ASC.Files.TemplateManager.templates.getTooltip;var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);var htmlTootlip=ASC.Controls.XSLTManager.translateFromString(stringData,xslData);jq("#entryTooltip").html(htmlTootlip);jq.dropdownToggle().toggle(entryObj.find("div.thumb-"+entryType),"entryTooltip")};var hideEntryTooltip=function(){jq("#entryTooltip").hide();clearTimeout(ASC.Files.UI.timeTooltip)};var checkCharacter=function(input){jq(input).unbind("keyup").bind("keyup",function(){var str=jq(this).val();if(str.search(ASC.Files.Common.characterRegExp)!=-1){jq(this).val(ASC.Files.Common.replaceSpecCharacter(str));ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.ErrorMassage_SpecCharacter.format(ASC.Files.Common.characterString),true)}})};var documentTitleFix=function(){if(jq.browser.msie){setInterval("document.title = jq('#currentFolderTitle').val() + ' - ' + ASC.Files.Constants.TITLE_PAGE;",200)}};return{init:init,parseItemId:parseItemId,getEntryObject:getEntryObject,getObjectData:getObjectData,getEntryTitle:getEntryTitle,getObjectTitle:getObjectTitle,currentPage:currentPage,amountPage:amountPage,countEntityInFolder:countEntityInFolder,currentRowOver:currentRowOver,showOverwriteMessage:showOverwriteMessage,updateFolderInfo:updateFolderInfo,updateFolderView:updateFolderView,switchFolderView:switchFolderView,blockObjectById:blockObjectById,blockObject:blockObject,hideLinks:hideLinks,showLinks:showLinks,preparingMoveTo:preparingMoveTo,beginMoveTo:beginMoveTo,finishMoveTo:finishMoveTo,continueMoveTo:continueMoveTo,updateMainContentHeader:updateMainContentHeader,checkSelectAll:checkSelectAll,checkSelect:checkSelect,selectRow:selectRow,clickRow:clickRow,paintRows:paintRows,addRowHandlers:addRowHandlers,resetSelectAll:resetSelectAll,beginSelecting:beginSelecting,handleMove:handleMove,mouseBtn:mouseBtn,startX:startX,startY:startY,prevX:prevX,prevY:prevY,displayInfoPanel:displayInfoPanel,hideInfoPanel:hideInfoPanel,editingFile:editingFile,editableFile:editableFile,accessibleItem:accessibleItem,accessAdmin:accessAdmin,checkEditing:checkEditing,timeCheckEditing:timeCheckEditing,lockEditFileById:lockEditFileById,lockEditFile:lockEditFile,checkCharacter:checkCharacter,documentTitleFix:documentTitleFix,toggleMainMenu:toggleMainMenu,displayEntryTooltip:displayEntryTooltip,hideEntryTooltip:hideEntryTooltip,timeTooltip:timeTooltip}})();(function(a){ASC.Files.UI.init();a(function(){jq("#infoPanelContainer").click(function(){ASC.Files.UI.hideInfoPanel()});jq("#switchToNormal").click(function(){jq("#files_mainContent").removeClass("compact");ASC.Files.UI.switchFolderView()});jq("#switchToCompact").click(function(){jq("#files_mainContent").addClass("compact");ASC.Files.UI.switchFolderView()});jq("#files_mainContent").on("click","li.fileRow",ASC.Files.UI.clickRow);jq("#files_mainContent").on("mousedown","li.fileRow",function(b){ASC.Files.UI.preparingMoveTo(this,b)});jq("#mainContent").on("mouseover","#files_mainContent.compact li.fileRow:not(.checkloading):not(.newFolder):not(.newFile) .entryTitle a.name",function(){ASC.Files.UI.hideEntryTooltip();jq(this).one("mouseleave",function(){ASC.Files.UI.hideEntryTooltip()});var b=ASC.Files.UI.getObjectData(this);var c=b.entryId;var d=b.entryType;ASC.Files.UI.timeTooltip=setTimeout("ASC.Files.UI.displayEntryTooltip('"+d+"', '"+c+"')",750)});jq("#files_mainContent").on("click","div.checkbox input",function(b){ASC.Files.UI.selectRow(this,this.checked==true);ASC.Files.UI.updateMainContentHeader();jq(this).blur();ASC.Files.Common.cancelBubble(b)});jq("#files_listUp").click(function(){jq(document).scrollTop(0);return false});jq(document).keydown(function(d){if(jq("div.blockDialog:visible").length!=0||jq("div.blockMsg:visible").length!=0||jq("div.files_popup_win:visible").length!=0||jq("#files_prompt_rename").length!=0||jq("#files_prompt_create_folder").length!=0||jq("#files_prompt_create_file").length!=0){return}var b;if(!c){var c=d}c=ASC.Files.Common.fixEvent(c);var f=c.target||c.srcElement;try{if(jq(f).is("input")){return true}}catch(c){return true}var b=c.keyCode||c.which;if(b==ASC.Files.Common.keyCode.a&&c.ctrlKey){if(jq.browser.opera){setTimeout('jq("#files_selectAll_check").focus()',1)}ASC.Files.UI.checkSelectAll(true);return false}});jq(document).keyup(function(d){if(jq("div.blockDialog:visible").length!=0||jq("div.blockMsg:visible").length!=0||jq("div.files_popup_win:visible").length!=0||jq("#files_prompt_rename").length!=0||jq("#files_prompt_create_folder").length!=0||jq("#files_prompt_create_file").length!=0){return}if(!c){var c=d}c=ASC.Files.Common.fixEvent(c);var f=c.target||c.srcElement;try{if(jq(f).is("input")){return true}}catch(c){return true}var b=c.keyCode||c.which;if(b==ASC.Files.Common.keyCode.deleteKey){ASC.Files.Folders.deleteItem();return false}if(b==ASC.Files.Common.keyCode.f&&c.shiftKey){ASC.Files.Folders.createFolder();return false}if(b==ASC.Files.Common.keyCode.n&&c.shiftKey){ASC.Files.Folders.typeNewDoc="document";ASC.Files.Folders.createNewDoc();return false}});jq(".comming_soon").unbind("click").click(function(){ASC.Files.UI.displayInfoPanel(ASC.Files.FilesJSResources.InfoCommingSoon,true);return false})})})(jQuery);var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}if(!a.addClass){a.hide=function(){this.style.display="none"};a.show=function(){this.style.display=""};a.addClass=function(b){this.removeClass(b);this.className+=" "+b};a.removeClass=function(e){var b=this.className.split(/\s+/);var c=-1;for(var d=0;d<b.length;d++){if(b[d]==e){c=d;d=b.length}}if(c>-1){b.splice(c,1);this.className=b.join(" ")}return this};a.hasClass=function(b){return !!this.className.match(new RegExp("\\s*"+b+"\\s*"))}}return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(d,c,a){var b=this.clients[d];if(b){b.receiveEvent(c,a)}},register:function(b,a){this.clients[b]=a},getDOMObjectPosition:function(b,c){var a={left:0,top:0,width:b.width?b.width:b.offsetWidth,height:b.height?b.height:b.offsetHeight};while(b&&(b!=c)){a.left+=b.offsetLeft;a.top+=b.offsetTop;b=b.offsetParent}return a},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId="ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);if(a){this.glue(a)}}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(c,a,e){this.domElement=ZeroClipboard.$(c);var f=99;if(this.domElement.style.zIndex){f=parseInt(this.domElement.style.zIndex,10)+1}if(typeof(a)=="string"){a=ZeroClipboard.$(a)}else{if(typeof(a)=="undefined"){a=document.getElementsByTagName("body")[0]}}var b=ZeroClipboard.getDOMObjectPosition(this.domElement,a);this.div=document.createElement("div");var d=this.div.style;d.position="absolute";d.left=""+b.left+"px";d.top=""+b.top+"px";d.width=""+b.width+"px";d.height=""+b.height+"px";d.zIndex=f;if(typeof(e)=="object"){for(addedStyle in e){d[addedStyle]=e[addedStyle]}}a.appendChild(this.div);this.div.innerHTML=this.getHTML(b.width,b.height)},getHTML:function(e,b){var c="";var a="id="+this.id+"&width="+e+"&height="+b;if(navigator.userAgent.match(/MSIE/)){var d=location.href.match(/^https/i)?"https://":"http://";c+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+d+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+e+'" height="'+b+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+a+'"/><param name="wmode" value="transparent"/></object>'}else{c+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+b+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+a+'" wmode="transparent" />'}return c},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(b){}this.domElement=null;this.div=null}},reposition:function(b){if(b){this.domElement=ZeroClipboard.$(b);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var a=ZeroClipboard.getDOMObjectPosition(this.domElement);var c=this.div.style;c.left=""+a.left+"px";c.top=""+a.top+"px"}},setText:function(a){this.clipText=a;if(this.ready){this.movie.setText(a)}},addEventListener:function(a,b){a=a.toString().toLowerCase().replace(/^on/,"");if(!this.handlers[a]){this.handlers[a]=[]}this.handlers[a].push(b)},setHandCursor:function(a){this.handCursorEnabled=a;if(this.ready){this.movie.setHandCursor(a)}},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(b,a){b=b.toString().toLowerCase().replace(/^on/,"");switch(b){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var f=this;setTimeout(function(){f.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var f=this;setTimeout(function(){f.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.setText(this.clipText);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":if(this.domElement&&this.cssEffects){this.domElement.addClass("hover");if(this.recoverActive){this.domElement.addClass("active")}}break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}this.domElement.removeClass("hover")}break;case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")}break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[b]){for(var d=0,e=this.handlers[b].length;d<e;d++){var c=this.handlers[b][d];if(typeof(c)=="function"){c(this,a)}else{if((typeof(c)=="object")&&(c.length==2)){c[0][c[1]](this,a)}else{if(typeof(c)=="string"){window[c](this,a)}}}}}}};